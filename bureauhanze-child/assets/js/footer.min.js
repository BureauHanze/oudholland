function openPopup(e){document.getElementById(e).classList.toggle("active")}const openFaqContainer=document.querySelectorAll(".info__faq > .faq-item");for(let e=0;e<openFaqContainer.length;e++)openFaqContainer[e].onclick=function(){if(openFaqContainer[e].classList.contains("active"))openFaqContainer[e].classList.remove("active");else{for(let e of openFaqContainer)e.classList.remove("active");openFaqContainer[e].classList.add("active")}};function closePopup(e){document.getElementById(e).classList.remove("active")}function openSpecs(e){document.getElementById(e).classList.toggle("active");var t=document.querySelector("#specsWrap > div.more__specs");"Minder specificaties"===t.innerHTML?t.innerHTML="Meer specificaties":t.innerHTML="Minder specificaties"}function setCookie(e,t,o){var n="";if(o){var c=new Date;c.setTime(c.getTime()+1*o*60*60*1e3),n="; expires="+c.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var c=o[n];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(t))return c.substring(t.length,c.length)}return null}var popupCookie=getCookie("popupCookie");document.getElementById("can-i-help-popup").style.display=popupCookie?"none":"block",document.getElementById("can-i-help--close").onclick=function(){document.getElementById("can-i-help-popup").style.display="none",setCookie("popupCookie","popupCookievalue",7)};const addToCartButton=document.querySelector(".composite_data > div > div.composite_button"),productID=document.querySelector(".composite_data > div > div.composite_button > input[type=hidden]");if(addToCartButton&&addToCartButton.addEventListener("click",(function(){sessionStorage.setItem("productID",productID.value)})),window.sessionStorage.getItem("productID")){const e=document.getElementById("popup-accessoires"),t=document.getElementById("productAddedModalStandard"),o=document.getElementById("productAddedModalAdvanced");e?(o.style.display="block",o.classList.add("fade-in-bottom")):(t.style.display="block",t.classList.add("fade-in-bottom")),sessionStorage.clear()}function closePAM(){const e=document.getElementById("productAddedModalStandard"),t=document.getElementById("productAddedModalAdvanced");e.classList.remove("fade-in-bottom"),e.style.display="none",t.classList.remove("fade-in-bottom"),t.style.display="none",sessionStorage.clear()}const formProjectinrichting=document.querySelector(".wpcf7-form"),formStepBtnNext=document.getElementById("step__button-next"),formStepOne=document.querySelector(".step__one"),formStepTwo=document.querySelector(".step__two"),formSubmit=document.querySelector(".wpcf7-submit");function waitForElm(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const o=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),o.disconnect())}));o.observe(document.body,{childList:!0,subtree:!0})}))}function validateOptons(){performance.getEntriesByType("resource");performance.getEntriesByType("resource").filter((e=>"Rectangle-Copy-14.png"==e.name));var e=document.getElementsByClassName("component_option_thumbnails");const t=document.querySelector("div > div.composite_button > .single_add_to_cart_button");var o=0,n=0;for(let t of e){let e=t.children;o+=1;for(let t of e){let e=t.children;var c=0;for(let t of e)1,t.children[0].classList.contains("selected")&&(c+=1);c&&(n+=1)}}t&&(n===o?(t.style.opacity=1,t.style.pointerEvents="all"):(t.style.opacity=.6,t.style.pointerEvents="none"))}formProjectinrichting&&(formStepBtnNext.addEventListener("click",(function(e){formStepOne.style.display="none",formStepTwo.style.display="block"})),formSubmit.addEventListener("click",(function(e){waitForElm(".invalid").then((e=>{formStepOne.style.display="block",formStepTwo.style.display="block",formStepBtnNext.style.display="none"}))}))),window.addEventListener("load",(function(){document.querySelector("div.component_inner > div.component_selections > div.component_content > .component_summary > .product"),validateOptons();var e=document.getElementsByClassName("component_options_load_more");e[0]&&e[0].addEventListener("click",(()=>{setTimeout((()=>{validateOptons()}),2e3)}));var t=document.getElementsByClassName("product_summary");t[0]&&t[0].addEventListener("click",(()=>{validateOptons()}))})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".sub-menu");for(let o=0;o<e.length;o++){var t=document.createElement("div");t.className="sub-menu__overlay",e[o].appendChild(t)}}),!1);
var timeout,top1=!1,bottom=!1;function descPress(){var e=document.getElementById("description"),t=document.querySelector(".tab_info");(top1=!top1)?(e.classList.add("showDesc"),t.classList.add("rotateArrow")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}function extraPress(){var e=document.getElementById("additional"),t=document.querySelector(".tab_info:nth-child(2)");(bottom=!bottom)?(t.classList.add("rotateArrow"),e.classList.add("showDesc")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}jQuery(document).ready((function(e){e("form.cart").on("click","button.plus, button.minus",(function(){var t=e(this).closest("form.cart").find(".qty"),o=parseFloat(t.val()),a=parseFloat(t.attr("max")),n=parseFloat(t.attr("min")),r=parseFloat(t.attr("step"));e(this).is(".plus")?a&&a<=o?t.val(a):t.val(o+r):n&&n>=o?t.val(n):o>1&&t.val(o-r)}))})),jQuery((function(e){e(".woocommerce").on("change","input.qty",(function(){void 0!==timeout&&clearTimeout(timeout),timeout=setTimeout((function(){e("[name='update_cart']").trigger("click")}),500)}))}));const voornaam=document.getElementById("billing_first_name"),shipVoornaam=document.getElementById("shipping_first_name"),achternaam=document.getElementById("billing_last_name"),shipAchternaam=document.getElementById("shipping_last_name"),straat=document.getElementById("billing_address_1"),shipStraat=document.getElementById("shipping_address_1"),postcode=document.getElementById("billing_postcode"),shipPostcode=document.getElementById("shipping_postcode"),plaats=document.getElementById("billing_city"),shipPlaats=document.getElementById("shipping_city"),email=document.getElementById("billing_email"),phone=document.getElementById("billing_phone"),line=document.getElementById("tussen1-2"),errorMessage=document.getElementById("formValidation"),diffrentAdress=document.getElementById("ship-to-different-address-checkbox");var progress=12.5;line&&(line.style.width=progress+"%"),allInputs=[voornaam,achternaam,straat,postcode,plaats,email,phone],allInputs.forEach(checkInput);var proceed=!1;function checkInput(e){e&&(e.value&&(progress+=12.5,line.style.width=progress+"%",e.proceed=!0),e.addEventListener("change",(t=>{e.value&&!e.proceed?(progress+=12.5,line.style.width=progress+"%",e.proceed=!0):e.value&&e.proceed||(progress-=12.5,line.style.width=progress+"%",e.proceed=!1)})))}var shipVerder=!1;function nextStepCheckout(){var e=!0;if(shipVerder?shipVoornaam.value&&shipAchternaam.value&&shipStraat.value&&shipPostcode.value&&shipPlaats.value||(e=!1):voornaam.value&&achternaam.value&&straat.value&&postcode.value&&plaats.value&&email.value&&phone.value||(e=!1),e){var t=document.getElementById("checkout_step1"),o=document.getElementById("checkout_step2"),a=document.getElementById("stap1"),n=document.getElementById("stap2");document.getElementById("tussen1-2").style.width="100%",(n||a)&&(n.classList.add("active-class"),a.classList.add("done-class")),window.scrollTo(0,50),t.style.display="none",o.style.display="block",errorMessage.style.display="none"}else errorMessage.style.height="fit-content",errorMessage.style.opacity=1,errorMessage.style.marginBottom="40px",errorMessage.style.padding="5px 25px"}function productModal(e,t,o){var a=document.getElementById("productModal");document.getElementById("productModalInner");document.getElementById("imgWrapper").innerHTML='<a href="'+t+'"><img class="modalProductImage" src="'+o+'"/></a>',document.getElementById("productTitle").innerHTML=e,a.classList.add("modal__cart--active"),pageOverlay.classList.remove("page-overlay"),pageOverlay.classList.add("page-overlay--active")}function closeProductModal(){document.getElementById("productModal").classList.remove("modal__cart--active"),pageOverlay.classList.remove("page-overlay--active"),pageOverlay.classList.add("page-overlay")}function incVAT(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span");if(e){var t=(1.21*e.innerText.replace(/,/g,".")).toFixed(2).replace(".",",");document.getElementById("incVATprice").innerHTML=t}}function watchSelections(){var e=document.querySelectorAll(".variations select, .quantity input");e&&e.forEach((e=>{e.addEventListener("change",(function(){incVAT(),setTimeout(productTotal,600)}))}))}function productTotal(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span"),t=document.querySelector("#productTotals");if(e)var o=e.innerText;t&&(document.querySelector("#productTotals").innerHTML=o)}function incVATtime(){setTimeout(incVAT,500)}diffrentAdress&&diffrentAdress.addEventListener("change",(function(){shipVerder=!shipVerder})),setTimeout((function(){if(document.getElementById("priceWatch")){var e=document.querySelectorAll("select");e&&e.forEach((e=>{e.addEventListener("change",(function(){setTimeout(incVAT,500)}))})),window.addEventListener("click",(function(){setTimeout(incVAT,500)}))}}),600),window.addEventListener("load",(e=>{setTimeout(productTotal,100),setTimeout(incVAT,600);var t=document.querySelectorAll(".radio_button");t&&t.forEach((e=>{e.addEventListener("click",(function(){incVAT(),setTimeout((function(){productTotal(),watchSelections()}),1300)}),{once:!1})}))}));var productPrice=document.getElementById("priceWatch");productPrice&&setInterval(productTotal,1e3);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvb3Rlci5qcyIsIndvb2NvbW1lcmNlLmpzIl0sIm5hbWVzIjpbIm9wZW5Qb3B1cCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIm9wZW5GYXFDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsIm9uY2xpY2siLCJjb250YWlucyIsInJlbW92ZSIsImZhcUNvbnRhaW5lciIsImFkZCIsImNsb3NlUG9wdXAiLCJvcGVuU3BlY3MiLCJidG50ZXh0IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsInNldENvb2tpZSIsIm5hbWUiLCJ2YWx1ZSIsImRheXMiLCJleHBpcmVzIiwiZGF0ZSIsIkRhdGUiLCJzZXRUaW1lIiwiZ2V0VGltZSIsInRvVVRDU3RyaW5nIiwiY29va2llIiwiZ2V0Q29va2llIiwibmFtZUVRIiwiY2EiLCJzcGxpdCIsImMiLCJjaGFyQXQiLCJzdWJzdHJpbmciLCJpbmRleE9mIiwicG9wdXBDb29raWUiLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRUb0NhcnRCdXR0b24iLCJwcm9kdWN0SUQiLCJhZGRFdmVudExpc3RlbmVyIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwid2luZG93IiwiZ2V0SXRlbSIsIm1vZGFsSWRlbnRpZmllciIsInByb2R1Y3RNb2RhbFN0YW5kYXJkIiwicHJvZHVjdE1vZGFsQWR2YW5jZWQiLCJjbGVhciIsImNsb3NlUEFNIiwiZm9ybVByb2plY3RpbnJpY2h0aW5nIiwiZm9ybVN0ZXBCdG5OZXh0IiwiZm9ybVN0ZXBPbmUiLCJmb3JtU3RlcFR3byIsImZvcm1TdWJtaXQiLCJ3YWl0Rm9yRWxtIiwic2VsZWN0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm9ic2VydmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9ucyIsImRpc2Nvbm5lY3QiLCJvYnNlcnZlIiwiYm9keSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJ2YWxpZGF0ZU9wdG9ucyIsInBlcmZvcm1hbmNlIiwiZ2V0RW50cmllc0J5VHlwZSIsImZpbHRlciIsInJlc291cmNlIiwiYWFudGFsU3ViT3B0aWVzIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIm9wdGlvbnNDb3VudCIsImFhbnRhbFNlbGVjdGVkIiwic2luZ2xlIiwic3ViT3B0aWVzQ2hpbGRzIiwiY2hpbGRyZW4iLCJvcHRpb25PdXRlciIsInNpbmdsZU9wdGlvbiIsImFjdGl2ZUNsYXNzIiwib3B0aW9uTGkiLCJvcGFjaXR5IiwicG9pbnRlckV2ZW50cyIsImV2ZW50IiwidGhlbiIsImVsbSIsImxvYWRNb3JlQnV0dG9uQyIsInNldFRpbWVvdXQiLCJwcm9kdWN0U3VtbWFyeSIsInN1Yk1lbnUiLCJzdWJNZW51RGl2IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwidGltZW91dCIsInRvcDEiLCJib3R0b20iLCJkZXNjUHJlc3MiLCJkZXNjcmlwdGlvbiIsImFycm93IiwiZXh0cmFQcmVzcyIsImpRdWVyeSIsInJlYWR5IiwiJCIsIm9uIiwicXR5IiwidGhpcyIsImNsb3Nlc3QiLCJmaW5kIiwidmFsIiwicGFyc2VGbG9hdCIsIm1heCIsImF0dHIiLCJtaW4iLCJzdGVwIiwiaXMiLCJ1bmRlZmluZWQiLCJjbGVhclRpbWVvdXQiLCJ0cmlnZ2VyIiwidm9vcm5hYW0iLCJzaGlwVm9vcm5hYW0iLCJhY2h0ZXJuYWFtIiwic2hpcEFjaHRlcm5hYW0iLCJzdHJhYXQiLCJzaGlwU3RyYWF0IiwicG9zdGNvZGUiLCJzaGlwUG9zdGNvZGUiLCJwbGFhdHMiLCJzaGlwUGxhYXRzIiwiZW1haWwiLCJwaG9uZSIsImxpbmUiLCJlcnJvck1lc3NhZ2UiLCJkaWZmcmVudEFkcmVzcyIsInByb2dyZXNzIiwid2lkdGgiLCJhbGxJbnB1dHMiLCJmb3JFYWNoIiwiY2hlY2tJbnB1dCIsInByb2NlZWQiLCJzaGlwVmVyZGVyIiwibmV4dFN0ZXBDaGVja291dCIsInZlcmRlciIsInN0ZXAxX2NvbnRlbnQiLCJzdGVwMl9jb250ZW50IiwiYWZnZXJvbmQiLCJtZWVCZXppZyIsInNjcm9sbFRvIiwiaGVpZ2h0IiwibWFyZ2luQm90dG9tIiwicGFkZGluZyIsInByb2R1Y3RNb2RhbCIsInByb2R1Y3RUaXRsZSIsInByb2R1Y3RMaW5rIiwicHJvZHVjdEltZ1VybCIsInRoZU1vZGFsIiwicGFnZU92ZXJsYXkiLCJjbG9zZVByb2R1Y3RNb2RhbCIsImluY1ZBVCIsImlucHV0MSIsImZpbmFsUmVzdWx0IiwiaW5uZXJUZXh0IiwicmVwbGFjZSIsInRvRml4ZWQiLCJ3YXRjaFNlbGVjdGlvbnMiLCJkcm9wZG93blNlbGVjdGlvbnMiLCJlbGVtZW50IiwicHJvZHVjdFRvdGFsIiwiaW5wdXQiLCJwcm9kdWN0VG90YWxzIiwicmVzdWx0IiwiaW5jVkFUdGltZSIsInByb2R1Y3RTZWxlY3Rpb25zIiwic2VsZWN0aW9uIiwicmFkaW9CdXR0b25zIiwiYnV0dG9uIiwib25jZSIsInByb2R1Y3RQcmljZSIsInNldEludGVydmFsIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxVQUFVQyxHQUNQQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVUMsT0FBTyxVQU92QixNQUFNQyxpQkFBbUJKLFNBQVNLLGlCQUFpQiwwQkFDbkQsSUFBSSxJQUFJQyxFQUFJLEVBQUdBLEVBQUlGLGlCQUFpQkcsT0FBUUQsSUFDeENGLGlCQUFpQkUsR0FBR0UsUUFBVSxXQUUxQixHQUQ2QkosaUJBQWlCRSxHQUFHSixVQUFVTyxTQUFTLFVBR2hFTCxpQkFBaUJFLEdBQUdKLFVBQVVRLE9BQU8sY0FDbEMsQ0FDSCxJQUFLLElBQUlDLEtBQWdCUCxpQkFDckJPLEVBQWFULFVBQVVRLE9BQU8sVUFFbENOLGlCQUFpQkUsR0FBR0osVUFBVVUsSUFBSSxZQVM5QyxTQUFTQyxXQUFXZCxHQUNSQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVVEsT0FBTyxVQUd2QixTQUFTSSxVQUFVZixHQUNQQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVUMsT0FB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QWlCLFVBQVUsV0FDdENzRyxZQUFjQSxjQThFdEJyRCxZQUFXLFdBRVAsR0FEbUIzRixTQUFTQyxlQUFlLGNBQ3pCLENBQ2QsSUFBSStLLEVBQW9CaEwsU0FBU0ssaUJBQWlCLFVBQzlDMkssR0FDQUEsRUFBa0JuQyxTQUFRb0MsSUFDdEJBLEVBQVV2SSxpQkFBaUIsVUFBVSxXQUNqQ2lELFdBQVd1RSxPQUFRLFdBSS9CckgsT0FBT0gsaUJBQWlCLFNBQVMsV0FDN0JpRCxXQUFXdUUsT0FBUSxXQUc1QixLQXdDSHJILE9BQU9ILGlCQUFpQixRQUFTNkMsSUFDN0JJLFdBQVdnRixhQUFjLEtBQ3pCaEYsV0FBV3VFLE9BQVEsS0FFbkIsSUFBSWdCLEVBQWVsTCxTQUFTSyxpQkFBaUIsaUJBRXpDNkssR0FDQUEsRUFBYXJDLFNBQVFzQyxJQUNqQkEsRUFBT3pJLGlCQUFpQixTQUFTLFdBQzdCd0gsU0FDQXZFLFlBQVcsV0FDUGdGLGVBQ0FILG9CQUNELFFBQ0osQ0FDQ1ksTUFBTSxVQWF0QixJQUFJQyxhQUFlckwsU0FBU0MsZUFBZSxjQUV2Q29MLGNBQ0FDLFlBQVlYLGFBQWMiLCJmaWxlIjoiZm9vdGVyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIG9wZW5Qb3B1cChpZCkge1xuICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIGUuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiKTtcbn1cblxuXG5cblxuLy8gb3BlbiAvIGNsb3NlIGZhcSBpdGVtc1xuY29uc3Qgb3BlbkZhcUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaW5mb19fZmFxID4gLmZhcS1pdGVtXCIpO1xuZm9yKGxldCBpID0gMDsgaSA8IG9wZW5GYXFDb250YWluZXIubGVuZ3RoOyBpKyspe1xuICAgIG9wZW5GYXFDb250YWluZXJbaV0ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgZmFxQ29udGFpbmVySGFzQ2xhc3MgPSBvcGVuRmFxQ29udGFpbmVyW2ldLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKTtcbiAgICAgICAgaWYoZmFxQ29udGFpbmVySGFzQ2xhc3MpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdoYXMgY2xhc3MnKTtcbiAgICAgICAgICAgIG9wZW5GYXFDb250YWluZXJbaV0uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAobGV0IGZhcUNvbnRhaW5lciBvZiBvcGVuRmFxQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgZmFxQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcGVuRmFxQ29udGFpbmVyW2ldLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgIH07XG4gICAgfTtcbn1cblxuXG5cblxuXG5mdW5jdGlvbiBjbG9zZVBvcHVwKGlkKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xufVxuXG5mdW5jdGlvbiBvcGVuU3BlY3MoaWQpIHtcbiAgICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBlLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIik7XG4gICAgXG4gICAgdmFyIGJ0bnRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NwZWNzV3JhcCA+IGRpdi5tb3JlX19zcGVjc1wiKTtcbiAgICBpZiAoYnRudGV4dC5pbm5lckhUTUwgPT09IFwiTWluZGVyIHNwZWNpZmljYXRpZXNcIikge1xuICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdNZWVyIHNwZWNpZmljYXRpZXMnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ0bnRleHQuaW5uZXJIVE1MID0gJ01pbmRlciBzcGVjaWZpY2F0aWVzJztcbiAgICB9XG59XG5cbi8vIGZ1bmN0aW9uIG9wZW5GaWx0ZXJzKGlkKSB7XG4vLyAgICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4vLyAgICAgZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xuXG4vLyAgICAgdmFyIGZpbHRlckRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZHVjdC1jYXRlZ29yeV9fZmlsdGVyc1wiKTtcbi8vICAgICB2YXIgZmlsdGVyU1ZHID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb3JlLWJ0biBzdmdcIik7XG4vLyAgICAgZmlsdGVyRGl2LmNsYXNzTGlzdC50b2dnbGUoXCItLWFjdGl2ZVwiKTtcbi8vICAgICBmaWx0ZXJTVkcuY2xhc3NMaXN0LnRvZ2dsZShcInN2Zy0tYWN0aXZlXCIpO1xuLy8gICAgIHZhciBidG50ZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb3JlX19zcGVjc1wiKTtcbi8vICAgICBpZiAoYnRudGV4dC5pbm5lckhUTUwgPT09IFwiRmlsdGVycyB2ZXJiZXJnZW5cIikge1xuLy8gICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdGaWx0ZXJzIHdlZXJnZXZlbic7XG5cbi8vICAgICB9IGVsc2Uge1xuLy8gICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdGaWx0ZXJzIHZlcmJlcmdlbic7XG4vLyAgICAgfVxuLy8gfVxuXG4vLyBTZXQgQ29va2llIGZvciBwb3B1cFxuZnVuY3Rpb24gc2V0Q29va2llKG5hbWUsdmFsdWUsZGF5cykge1xuICAgIHZhciBleHBpcmVzID0gXCJcIjtcbiAgICBpZiAoZGF5cykge1xuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIChkYXlzKjEqNjAqNjAqMTAwMCkpO1xuICAgICAgICBleHBpcmVzID0gXCI7IGV4cGlyZXM9XCIgKyBkYXRlLnRvVVRDU3RyaW5nKCk7XG4gICAgfVxuICAgIGRvY3VtZW50LmNvb2tpZSA9IG5hbWUgKyBcIj1cIiArICh2YWx1ZSB8fCBcIlwiKSAgKyBleHBpcmVzICsgXCI7IHBhdGg9L1wiO1xufVxuXG4vLyBTZXQgQ29va2llIGZvciBwb3B1cFxuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcbiAgICB2YXIgbmFtZUVRID0gbmFtZSArIFwiPVwiO1xuICAgIHZhciBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuICAgIGZvcih2YXIgaT0wO2kgPCBjYS5sZW5ndGg7aSsrKSB7XG4gICAgICAgIHZhciBjID0gY2FbaV07XG4gICAgICAgIHdoaWxlIChjLmNoYXJBdCgwKT09JyAnKSBjID0gYy5zdWJzdHJpbmcoMSxjLmxlbmd0aCk7XG4gICAgICAgIGlmIChjLmluZGV4T2YobmFtZUVRKSA9PSAwKSByZXR1cm4gYy5zdWJzdHJpbmcobmFtZUVRLmxlbmd0aCxjLmxlbmd0aCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuXG4vLyBIaWRlIHBvcHVwIGlmIGNvb2tpZSBpcyBzZXRcbnZhciBwb3B1cENvb2tpZSA9IGdldENvb2tpZSgncG9wdXBDb29raWUnKTtcbmlmIChwb3B1cENvb2tpZSkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW4taS1oZWxwLXBvcHVwJykuc3R5bGUuZGlzcGxheT1cIm5vbmVcIlxufVxuZWxzZSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbi1pLWhlbHAtcG9wdXAnKS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIlxufVxuXG4vLyBTZXQgQ29va2llIG9uIHBvcHVwIGNsb3NlXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuLWktaGVscC0tY2xvc2UnKS5vbmNsaWNrPWZ1bmN0aW9uKCl7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbi1pLWhlbHAtcG9wdXAnKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO1xuICAgIHNldENvb2tpZSgncG9wdXBDb29raWUnLCdwb3B1cENvb2tpZXZhbHVlJyw3KTtcbn07XG5cblxuXG4vLyBQcm9kdWN0IE1vZGFsIEpTXG5jb25zdCBhZGRUb0NhcnRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZV9idXR0b25cIilcbmNvbnN0IHByb2R1Y3RJRCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlX2J1dHRvbiA+IGlucHV0W3R5cGU9aGlkZGVuXVwiKVxuXG5pZiAoYWRkVG9DYXJ0QnV0dG9uKSB7XG4gICAgYWRkVG9DYXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJwcm9kdWN0SURcIiwgcHJvZHVjdElELnZhbHVlKTtcbiAgICB9KVxufVxuXG5pZiAod2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3Byb2R1Y3RJRCcpKSB7XG4gICAgY29uc3QgbW9kYWxJZGVudGlmaWVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWFjY2Vzc29pcmVzJyk7XG4gICAgY29uc3QgcHJvZHVjdE1vZGFsU3RhbmRhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdEFkZGVkTW9kYWxTdGFuZGFyZCcpXG4gICAgY29uc3QgcHJvZHVjdE1vZGFsQWR2YW5jZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdEFkZGVkTW9kYWxBZHZhbmNlZCcpXG5cbiAgICBpZiAoIW1vZGFsSWRlbnRpZmllcikge1xuICAgICAgICBwcm9kdWN0TW9kYWxTdGFuZGFyZC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiXG4gICAgICAgIHByb2R1Y3RNb2RhbFN0YW5kYXJkLmNsYXNzTGlzdC5hZGQoXCJmYWRlLWluLWJvdHRvbVwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2R1Y3RNb2RhbEFkdmFuY2VkLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICAgICAgcHJvZHVjdE1vZGFsQWR2YW5jZWQuY2xhc3NMaXN0LmFkZChcImZhZGUtaW4tYm90dG9tXCIpXG4gICAgfVxuXG4gICAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKVxufVxuXG5mdW5jdGlvbiBjbG9zZVBBTSgpIHtcbiAgICBjb25zdCBwcm9kdWN0TW9kYWxTdGFuZGFyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0QWRkZWRNb2RhbFN0YW5kYXJkJylcbiAgICBjb25zdCBwcm9kdWN0TW9kYWxBZHZhbmNlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0QWRkZWRNb2RhbEFkdmFuY2VkJylcblxuICAgIHByb2R1Y3RNb2RhbFN0YW5kYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJmYWRlLWluLWJvdHRvbVwiKVxuICAgIHByb2R1Y3RNb2RhbFN0YW5kYXJkLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuXG4gICAgcHJvZHVjdE1vZGFsQWR2YW5jZWQuY2xhc3NMaXN0LnJlbW92ZShcImZhZGUtaW4tYm90dG9tXCIpXG4gICAgcHJvZHVjdE1vZGFsQWR2YW5jZWQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cbiAgICBzZXNzaW9uU3RvcmFnZS5jbGVhcigpXG59XG5cblxuXG5cbi8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcbi8vICAgICAvLyB2YXIgcHJpY2VTdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmFjZXR3cC1zdWJtaXQnKS5pbm5lckhUTUw7XG4vLyAgICAgLy8gcHJpY2VTdWJtaXRCdG4gPSBcIk15IG5ldyB0ZXh0IVwiO1xuLy8gICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmFjZXR3cC1zdWJtaXRcIikuaW5uZXJIVE1MID0gXCJJIGhhdmUgY2hhbmdlZCFcIjtcbi8vIH0pO1xuXG5cblxuLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoZXZlbnQpID0+IHtcbi8vICAgICB2YXIgcHJvZHVjdE9wdGlvbkJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiY29tcG9uZW50X29wdGlvbl90aHVtYm5haWxfdGFwXCIpO1xuLy8gICAgIC8vIHZhciBwcm9kdWN0T3B0aW9uQnRuc0FycmF5ID0gWy4uLnByb2R1Y3RPcHRpb25CdG5zXTtcbi8vICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZXByaWNlX3dyYXBwZXIgPiBkaXYuY29tcG9zaXRlX3ByaWNlID4gcCBzcGFuXCIpO1xuXG5cdFxuLy8gXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcHJvZHVjdE9wdGlvbkJ0bnMubGVuZ3RoOyArK2kpIHtcbi8vIFx0XHRcdC8vIHByb2R1Y3RPcHRpb25CdG5baV0ub25jbGljayA9IGZ1bmN0aW9uICgpIHsgXG4vLyAgICAgICAgICAgICBwcm9kdWN0T3B0aW9uQnRuc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4vLyAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbi8vICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaW5wdXQuaW5uZXJUZXh0O1xuLy8gICAgICAgICAgICAgICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuLy8gICAgICAgICAgICAgICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgICAgICAgICAgdmFyIGZpbmFsUmVzdWx0ID0gcmVzdWx0Y2FsYy5yZXBsYWNlKCcuJywgJywnKTtcbi8vICAgICAgICAgICAgICAgICBpZihyZXN1bHQpIHtcbi8vICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNWQVRwcmljZVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdDtcbi8vICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocHJvZHVjdE9wdGlvbkJ0bnNbaV0pO1xuLy8gICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcm9kdWN0T3B0aW9uQnRuc1tpXSk7XG4vLyAgICAgICAgICAgICB9KTtcbi8vICAgICAgICAgfVxuXG4vLyAgICAgfSk7XG4gICAgLy8gZm9yIChsZXQgcHJvZHVjdE9wdGlvbkJ0biBvZiBwcm9kdWN0T3B0aW9uQnRuc0FycmF5KSB7XG4gICAgLy8gICAgIHByb2R1Y3RPcHRpb25CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgIC8vICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAvLyAgICAgICAgIHZhciByZXN1bHQgPSBpbnB1dC5pbm5lclRleHQ7XG4gICAgLy8gICAgICAgICB2YXIgcmVzdWx0Zml4ID0gcmVzdWx0LnJlcGxhY2UoLywvZywgJy4nKTtcbiAgICAvLyAgICAgICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4gICAgLy8gICAgICAgICB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuICAgIC8vICAgICAgICAgaWYocmVzdWx0KSB7XG4gICAgLy8gICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNWQVRwcmljZVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdDtcbiAgICAvLyAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9kdWN0T3B0aW9uQnRuKTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG4pO1xuICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJ3Byb2R1Y3RPcHRpb25CdG4nKTtcbiAgICAvLyAgICAgfSk7XG4gIFxuICAgIC8vIH1cbiAgICAvLyBjb25zb2xlLmxvZyhwcm9kdWN0T3B0aW9uQnRuc0FycmF5KTsgIFxuXG5cbi8vIEZvcm0gcHJvamVjdGlucmljaHRpbmcgbXVsdGlzdGVwXG5jb25zdCBmb3JtUHJvamVjdGlucmljaHRpbmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3BjZjctZm9ybScpO1xuY29uc3QgZm9ybVN0ZXBCdG5OZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0ZXBfX2J1dHRvbi1uZXh0Jyk7XG5jb25zdCBmb3JtU3RlcE9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdGVwX19vbmUnKTtcbmNvbnN0IGZvcm1TdGVwVHdvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0ZXBfX3R3bycpO1xuY29uc3QgZm9ybVN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53cGNmNy1zdWJtaXQnKTtcbi8vIGZvcm1TdGVwVHdvLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuLy8gb2JzZXJ2ZXIgZm9yIHdhaXRpbmcgY2xhc3MgdG8gZXhpc3RcbmZ1bmN0aW9uIHdhaXRGb3JFbG0oc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGlvbnMgPT4ge1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSk7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbi8vIHNob3cgLyBoaWRlIG11bHRpc3RlcCBmb3JtXG5pZihmb3JtUHJvamVjdGlucmljaHRpbmcpe1xuICAgIGZvcm1TdGVwQnRuTmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBmb3JtU3RlcE9uZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIGZvcm1TdGVwVHdvLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgfSk7XG4gICAgXG4gICAgZm9ybVN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuXG5cbiAgICAgICAgd2FpdEZvckVsbSgnLmludmFsaWQnKS50aGVuKChlbG0pID0+IHtcbiAgICAgICAgICAgIGZvcm1TdGVwT25lLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgICAgICBmb3JtU3RlcFR3by5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAgICAgZm9ybVN0ZXBCdG5OZXh0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgLy8gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgY29uc3QgZm9ybUhhc0NsYXNzSW52YWxpZCA9IGZvcm1Qcm9qZWN0aW5yaWNodGluZy5jbGFzc0xpc3QuY29udGFpbnMoJ2ludmFsaWQnKTtcbiAgICAgICAgLy8gICAgIGlmKGZvcm1IYXNDbGFzc0ludmFsaWQpIHtcbiAgICAgICAgLy8gICAgICAgICBmb3JtU3RlcE9uZS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAvLyAgICAgICAgIGZvcm1TdGVwVHdvLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIC8vICAgICAgICAgZm9ybVN0ZXBCdG5OZXh0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgICAgICAvLyAgICAgfTtcbiAgICAgICAgLy8gfSwgMjUwMCk7XG4gICAgfSk7XG59O1xuXG5cblxuXG4vLyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4vLyAgICAgLy8gdmFyIGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZhY2V0d3Atc3VibWl0Jyk7XG4vLyAgICAgdmFyIGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZpbHRlcnNfX3ByaWNlJyk7XG4vLyAgICAgdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgXG4vLyAgICAgZWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUod3JhcHBlciwgZWwpO1xuLy8gICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoZWwpO1xuLy8gfSwgZmFsc2UpO1xuXG5cbi8vIGNvbnN0IGNvbXBvbmVudFNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXBvbmVudF9vcHRpb25fdGh1bWJuYWlsJyk7XG4vLyBjb25zdCBjb21wb25lbnRTZWxlY3RlZENsYXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbGVjdGVkJyk7XG4vLyBjb25zdCBjb21wb3NpdGVBZGRUb0NhcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tcG9zaXRlX2FkZF90b19jYXJ0X2J1dHRvbicpO1xuLy8gLy8gY29tcG9zaXRlQWRkVG9DYXJ0LnNldEF0dHJpYnV0ZShcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKTtcbi8vIGlmKGNvbXBvbmVudFNlbGVjdGVkLmNsYXNzTGlzdC5jb250YWlucyhjb21wb25lbnRTZWxlY3RlZENsYXNzKSApIHtcbi8vICAgICBjb25zb2xlLmxvZygndGVzdCcpO1xuXG4vLyB9XG5cblxuXG4vLyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpe1xuICAgIC8vIGxldCBuZXh0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHRCdG4nKTtcbiAgICAvLyBsZXQgcHJldkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2QnRuJyk7XG4gICAgLy8gbGV0IGVsZW1lbnRJbmRleCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbGVtZW50X2luZGV4Jyk7XG4gICAgLy8gaWYobmV4dEJ0bikge1xuICAgIC8vICAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIC8vICAgICAgICAgdmFyIGNvbXBvc2l0ZVBhZ2luYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWxlbWVudF9pbmRleCcpO1xuICAgIC8vICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGNvbXBvc2l0ZVBhZ2luYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAvLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb21wb3NpdGVQYWdpbmF0aW9uKTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgfSk7XG4gICAgLy8gfVxuXG5cblxuLy8gfSk7XG5cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uICgpIHtcblxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImRpdi5jb21wb25lbnRfaW5uZXIgPiBkaXYuY29tcG9uZW50X3NlbGVjdGlvbnMgPiBkaXYuY29tcG9uZW50X2NvbnRlbnQgPiAuY29tcG9uZW50X3N1bW1hcnkgPiAucHJvZHVjdFwiKVxuXG4gICAgdmFsaWRhdGVPcHRvbnMoKTtcbiAgICAvLyBsaXN0ZW5lciBmb3Igb25jbGljayBvZlxuXG4gICAgdmFyIGxvYWRNb3JlQnV0dG9uQyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NvbXBvbmVudF9vcHRpb25zX2xvYWRfbW9yZScpXG5cbiAgICBpZiAobG9hZE1vcmVCdXR0b25DWzBdKSB7XG4gICAgICAgIGxvYWRNb3JlQnV0dG9uQ1swXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVPcHRvbnMoKTtcbiAgICAgICAgICAgIH0sIDIwMDApXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgdmFyIHByb2R1Y3RTdW1tYXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncHJvZHVjdF9zdW1tYXJ5JylcbiAgICBpZiAocHJvZHVjdFN1bW1hcnlbMF0pIHtcbiAgICAgICAgcHJvZHVjdFN1bW1hcnlbMF0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0b25zKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG5cblxuXG4gICAgLy8gYmx1cnJ5IGJhY2tncm91bmQgb24gbWVudSBob3ZlclxuICAgIC8vIHZhciBtZW51SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWVudS13ZWJzaG9wLTEgPiBsaScpO1xuICAgIC8vIGZvcihsZXQgaSA9IDA7IGkgPSBtZW51SXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAvLyAgICAgbWVudUl0ZW1zW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIChldmVudCkgPT4ge1xuXG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZygndGVzdCcpO1xuICAgICAgICBcblxuICAgIC8vICAgICB9LCBmYWxzZSk7XG4gICAgLy8gfVxuXG5cblxuXG59KVxuXG5cblxuXG5cbi8vIC8vIG92ZXJsYXkgYWN0aXZlIG9uIG1vdXNlIGhvdmVyIG1lbnUgaXRlbXNcbi8vIGNvbnN0IG1lbnVJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51IC5tZW51LWl0ZW0nKTtcbi8vIG1lbnVJdGVtcy5mb3JFYWNoKGYgPT4gZi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24oKSB7XG4vLyAgICAgbWVudUl0ZW1zLmZvckVhY2goZSA9PiB7XG4vLyAgICAgICAgIGNvbnN0IG92ZXJsYXlBY3RpdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZS1vdmVybGF5Jylcbi8vICAgICAgICAgb3ZlcmxheUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdwYWdlLW92ZXJsYXktLWFjdGl2ZScpO1xuLy8gICAgIC8vIGNvbnN0IGJvZHlFbGVtZW50ID0gZG9jdW1lbnQuYm9keTtcbi8vICAgICAvLyBib2R5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiLS1tZW51LWhvdmVyXCIpO1xuLy8gICB9KVxuLy8gfSkpO1xuLy8gbWVudUl0ZW1zLmZvckVhY2goZiA9PiBmLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgZnVuY3Rpb24oKSB7XG4vLyAgICAgbWVudUl0ZW1zLmZvckVhY2goZSA9PiB7XG4vLyAgICAgLy8gY29uc3QgYm9keUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuLy8gICAgIC8vIGJvZHlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCItLW1lbnUtaG92ZXJcIik7XG4vLyAgICAgY29uc3Qgb3ZlcmxheUFjdGl2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlLW92ZXJsYXknKVxuLy8gICAgIG92ZXJsYXlBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgncGFnZS1vdmVybGF5LS1hY3RpdmUnKTtcbi8vICAgfSlcbi8vIH0pKTtcblxuXG5cbi8vIGFwcGVuZCBjbGFzcyB0byBzdWItbWVudVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdWJNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN1Yi1tZW51JylcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgc3ViTWVudS5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHZhciBzdWJNZW51RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgICAgICBzdWJNZW51RGl2LmNsYXNzTmFtZSA9IFwic3ViLW1lbnVfX292ZXJsYXlcIjtcbiAgICAgICAgc3ViTWVudVtpXS5hcHBlbmRDaGlsZChzdWJNZW51RGl2KVxuICAgIH1cbn0sIGZhbHNlKTtcblxuXG5mdW5jdGlvbiB2YWxpZGF0ZU9wdG9ucygpIHtcblxuICAgIHBlcmZvcm1hbmNlLmdldEVudHJpZXNCeVR5cGUoXCJyZXNvdXJjZVwiKVxuXG4gICAgY29uc3QgcmVzb3VyY2VzID0gcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcInJlc291cmNlXCIpO1xuXG4gICAgcmVzb3VyY2VzLmZpbHRlcihyZXNvdXJjZSA9PiByZXNvdXJjZS5uYW1lID09IFwiUmVjdGFuZ2xlLUNvcHktMTQucG5nXCIpXG5cbiAgICB2YXIgYWFudGFsU3ViT3B0aWVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29tcG9uZW50X29wdGlvbl90aHVtYm5haWxzJyk7XG5cblxuICAgIGNvbnN0IGFkZFRvQ2FydEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJkaXYgPiBkaXYuY29tcG9zaXRlX2J1dHRvbiA+IC5zaW5nbGVfYWRkX3RvX2NhcnRfYnV0dG9uXCIpXG5cbiAgICB2YXIgb3B0aW9uc0NvdW50ID0gMDtcbiAgICB2YXIgYWFudGFsU2VsZWN0ZWQgPSAwO1xuXG4gICAgZm9yIChsZXQgc2luZ2xlIG9mIGFhbnRhbFN1Yk9wdGllcykge1xuICAgICAgICBsZXQgc3ViT3B0aWVzQ2hpbGRzID0gc2luZ2xlLmNoaWxkcmVuO1xuXG4gICAgICAgIG9wdGlvbnNDb3VudCA9IG9wdGlvbnNDb3VudCArIDE7XG5cbiAgICAgICAgZm9yIChsZXQgb3B0aW9uT3V0ZXIgb2Ygc3ViT3B0aWVzQ2hpbGRzKSB7XG4gICAgICAgICAgICBsZXQgc2luZ2xlT3B0aW9uID0gb3B0aW9uT3V0ZXIuY2hpbGRyZW47XG4gICAgICAgICAgICB2YXIgZ2xvYmFsQ291bnQgPSAwO1xuICAgICAgICAgICAgdmFyIGFjdGl2ZUNsYXNzID0gMDtcblxuICAgICAgICAgICAgZm9yIChsZXQgb3B0aW9uTGkgb2Ygc2luZ2xlT3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgZ2xvYmFsQ291bnQgPSBnbG9iYWxDb3VudCArIDE7XG5cbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uTGkuY2hpbGRyZW5bMF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNsYXNzID0gYWN0aXZlQ2xhc3MgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhY3RpdmVDbGFzcykge1xuICAgICAgICAgICAgICAgIGFhbnRhbFNlbGVjdGVkID0gYWFudGFsU2VsZWN0ZWQgKyAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gb25seSBjaGFuZ2Ugc3R5bGluZyBvZiB0aGUgYWRkIHRvIGNhcnQgYnV0dG9uIHdoZW4gdGhlcmUgYXJlIG11Y2ggc2VsZWN0ZWQgYm94ZXMgYXMgcm93cyBvZiBvcHRpb25zXG4gICAgaWYgKGFkZFRvQ2FydEJ1dHRvbikge1xuICAgICAgICBpZiAoYWFudGFsU2VsZWN0ZWQgPT09IG9wdGlvbnNDb3VudCkge1xuICAgICAgICAgICAgYWRkVG9DYXJ0QnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgYWRkVG9DYXJ0QnV0dG9uLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImFsbFwiXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRUb0NhcnRCdXR0b24uc3R5bGUub3BhY2l0eSA9IC42O1xuICAgICAgICAgICAgYWRkVG9DYXJ0QnV0dG9uLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIlxuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuXG5cbi8vIGNvbnN0IHdlYnNob3BNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtd2Vic2hvcC1jb250YWluZXIgPiAubWVudS1pdGVtJylcbi8vIGNvbnN0IFxuXG4vLyBmb3IobGV0IGkgPSAwOyBpIDwgd2Vic2hvcE1lbnUubGVuZ3RoOyBpKyspIHtcbi8vICAgICB3ZWJzaG9wTWVudVtpXS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBmdW5jdGlvbiggZXZlbnQgKSB7ICAgXG4vLyAgICAgICAgIGV2ZW50LnRhcmdldC5zdHlsZS5jb2xvciA9IFwicHVycGxlXCI7XG5cbi8vICAgICAgIH0sIGZhbHNlKTtcbi8vIH1cblxuXG5cbiIsInZhciB0b3AxID0gZmFsc2VcbnZhciBib3R0b20gPSBmYWxzZVxuXG5mdW5jdGlvbiBkZXNjUHJlc3MoKSB7XG4gICAgdmFyIGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJyk7XG4gICAgdmFyIGFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YWJfaW5mb1wiKTtcbiAgICB0b3AxID0gIXRvcDFcblxuICAgIGlmICh0b3AxKSB7XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJzaG93RGVzY1wiKTtcbiAgICAgICAgYXJyb3cuY2xhc3NMaXN0LmFkZChcInJvdGF0ZUFycm93XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LnJlbW92ZShcInNob3dEZXNjXCIpXG4gICAgfVxufVxuXG5mdW5jdGlvbiBleHRyYVByZXNzKCkge1xuICAgIHZhciBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRpdGlvbmFsJyk7XG4gICAgdmFyIGFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YWJfaW5mbzpudGgtY2hpbGQoMilcIik7XG4gICAgYm90dG9tID0gIWJvdHRvbTtcblxuICAgIGlmIChib3R0b20pIHtcbiAgICAgICAgYXJyb3cuY2xhc3NMaXN0LmFkZChcInJvdGF0ZUFycm93XCIpO1xuICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKFwic2hvd0Rlc2NcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXJyb3cuY2xhc3NMaXN0LnJlbW92ZShcInJvdGF0ZUFycm93XCIpO1xuICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd0Rlc2NcIik7XG4gICAgfVxufVxuXG4vLyBNaW51cyBhbmQgUGx1cyBidXR0b25zIHF1YW50aXR5XG5cbmpRdWVyeShkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oJCl7XG5cbiAgICAkKCdmb3JtLmNhcnQnKS5vbiggJ2NsaWNrJywgJ2J1dHRvbi5wbHVzLCBidXR0b24ubWludXMnLCBmdW5jdGlvbigpIHtcblxuICAgIC8vIEdldCBjdXJyZW50IHF1YW50aXR5IHZhbHVlc1xuICAgIHZhciBxdHkgPSAkKCB0aGlzICkuY2xvc2VzdCggJ2Zvcm0uY2FydCcgKS5maW5kKCAnLnF0eScgKTtcbiAgICB2YXIgdmFsICAgPSBwYXJzZUZsb2F0KHF0eS52YWwoKSk7XG4gICAgdmFyIG1heCA9IHBhcnNlRmxvYXQocXR5LmF0dHIoICdtYXgnICkpO1xuICAgIHZhciBtaW4gPSBwYXJzZUZsb2F0KHF0eS5hdHRyKCAnbWluJyApKTtcbiAgICB2YXIgc3RlcCA9IHBhcnNlRmxvYXQocXR5LmF0dHIoICdzdGVwJyApKTtcblxuICAgIC8vIENoYW5nZSB0aGUgdmFsdWUgaWYgcGx1cyBvciBtaW51c1xuICAgIGlmICggJCggdGhpcyApLmlzKCAnLnBsdXMnICkgKSB7XG4gICAgICAgaWYgKCBtYXggJiYgKCBtYXggPD0gdmFsICkgKSB7XG4gICAgICAgICAgcXR5LnZhbCggbWF4ICk7XG4gICAgICAgfVxuICAgIGVsc2Uge1xuICAgICAgIHF0eS52YWwoIHZhbCArIHN0ZXAgKTtcbiAgICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgaWYgKCBtaW4gJiYgKCBtaW4gPj0gdmFsICkgKSB7XG4gICAgICAgICAgcXR5LnZhbCggbWluICk7XG4gICAgICAgfVxuICAgICAgIGVsc2UgaWYgKCB2YWwgPiAxICkge1xuICAgICAgICAgIHF0eS52YWwoIHZhbCAtIHN0ZXAgKTtcbiAgICAgICB9XG4gICAgfVxuXG4gfSk7XG5cbn0pO1xuXG5cbi8vIEFqYXggcXVhbnRpdHkgYWRkXG5cbnZhciB0aW1lb3V0O1xuXG5qUXVlcnkoIGZ1bmN0aW9uKCAkICkge1xuXHQkKCcud29vY29tbWVyY2UnKS5vbignY2hhbmdlJywgJ2lucHV0LnF0eScsIGZ1bmN0aW9uKCl7XG5cblx0XHRpZiAoIHRpbWVvdXQgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdGNsZWFyVGltZW91dCggdGltZW91dCApO1xuXHRcdH1cblxuXHRcdHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0JChcIltuYW1lPSd1cGRhdGVfY2FydCddXCIpLnRyaWdnZXIoXCJjbGlja1wiKTtcblx0XHR9LCA1MDAgKTsgLy8gMC41IHNlY29uZCBkZWxheVxuXG5cdH0gKTtcbn0gKTtcblxuXG4vLyBnZXR0aW5nIGFsbCBpbnB1dCBmaWVsZHMgJiBwcm9ncmVzcyBsaW5lXG5jb25zdCB2b29ybmFhbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2ZpcnN0X25hbWUnKVxuY29uc3Qgc2hpcFZvb3JuYWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXBwaW5nX2ZpcnN0X25hbWUnKVxuY29uc3QgYWNodGVybmFhbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2xhc3RfbmFtZScpXG5jb25zdCBzaGlwQWNodGVybmFhbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19sYXN0X25hbWUnKVxuY29uc3Qgc3RyYWF0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfYWRkcmVzc18xJylcbmNvbnN0IHNoaXBTdHJhYXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfYWRkcmVzc18xJylcbmNvbnN0IHBvc3Rjb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfcG9zdGNvZGUnKVxuY29uc3Qgc2hpcFBvc3Rjb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXBwaW5nX3Bvc3Rjb2RlJylcbmNvbnN0IHBsYWF0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2NpdHknKVxuY29uc3Qgc2hpcFBsYWF0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19jaXR5JylcbmNvbnN0IGVtYWlsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfZW1haWwnKVxuY29uc3QgcGhvbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19waG9uZScpXG5jb25zdCBsaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1c3NlbjEtMicpO1xuY29uc3QgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm1WYWxpZGF0aW9uJyk7XG5jb25zdCBkaWZmcmVudEFkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwLXRvLWRpZmZlcmVudC1hZGRyZXNzLWNoZWNrYm94Jyk7XG5cblxuXG52YXIgcHJvZ3Jlc3MgPSAxMi41O1xuaWYgKGxpbmUpIHtcbiAgICBsaW5lLnN0eWxlLndpZHRoID0gcHJvZ3Jlc3MgKyBcIiVcIjtcbn1cblxuLy8gcHV0dGluZyB0aGUgaW5wdXRzIGluIGFuIGFycmF5XG5hbGxJbnB1dHMgPSBbdm9vcm5hYW0sIGFjaHRlcm5hYW0sIHN0cmFhdCwgcG9zdGNvZGUsIHBsYWF0cywgZW1haWwsIHBob25lXVxuXG5hbGxJbnB1dHMuZm9yRWFjaChjaGVja0lucHV0KTtcbnZhciBwcm9jZWVkID0gZmFsc2U7XG5cblxuZnVuY3Rpb24gY2hlY2tJbnB1dCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUudmFsdWUpIHtcbiAgICAgICAgICAgIHByb2dyZXNzID0gcHJvZ3Jlc3MgKyAxMi41O1xuICAgICAgICAgICAgbGluZS5zdHlsZS53aWR0aCA9IHByb2dyZXNzICsgXCIlXCI7XG4gICAgICAgICAgICB2YWx1ZS5wcm9jZWVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgdmFsdWUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGV2ZW50KSA9PiB7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZS52YWx1ZSAmJiAhdmFsdWUucHJvY2VlZCkge1xuICAgICAgICAgICAgICAgIHByb2dyZXNzID0gcHJvZ3Jlc3MgKyAxMi41O1xuICAgICAgICAgICAgICAgIGxpbmUuc3R5bGUud2lkdGggPSBwcm9ncmVzcyArIFwiJVwiO1xuICAgICAgICAgICAgICAgIHZhbHVlLnByb2NlZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlLnZhbHVlICYmIHZhbHVlLnByb2NlZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb2dyZXNzID0gcHJvZ3Jlc3MgLTEyLjU7XG4gICAgICAgICAgICAgICAgbGluZS5zdHlsZS53aWR0aCA9IHByb2dyZXNzICsgXCIlXCI7XG4gICAgICAgICAgICAgICAgdmFsdWUucHJvY2VlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG52YXIgc2hpcFZlcmRlciA9IGZhbHNlO1xuaWYgKGRpZmZyZW50QWRyZXNzKSB7XG4gICAgZGlmZnJlbnRBZHJlc3MuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNoaXBWZXJkZXIgPSAhc2hpcFZlcmRlcjtcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBuZXh0U3RlcENoZWNrb3V0KCkge1xuICAgIHZhciB2ZXJkZXIgPSB0cnVlO1xuICAgIGlmIChzaGlwVmVyZGVyKSB7XG4gICAgICAgIGlmICghc2hpcFZvb3JuYWFtLnZhbHVlIHx8ICFzaGlwQWNodGVybmFhbS52YWx1ZSB8fCAhc2hpcFN0cmFhdC52YWx1ZSB8fCAhc2hpcFBvc3Rjb2RlLnZhbHVlIHx8ICFzaGlwUGxhYXRzLnZhbHVlKSB7XG4gICAgICAgICAgICB2ZXJkZXIgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIXZvb3JuYWFtLnZhbHVlIHx8ICFhY2h0ZXJuYWFtLnZhbHVlIHx8ICFzdHJhYXQudmFsdWUgfHwgIXBvc3Rjb2RlLnZhbHVlIHx8ICFwbGFhdHMudmFsdWUgfHwgIWVtYWlsLnZhbHVlIHx8ICFwaG9uZS52YWx1ZSkge1xuICAgICAgICB2ZXJkZXIgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAodmVyZGVyKSB7XG4gICAgICAgIHZhciBzdGVwMV9jb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGVja291dF9zdGVwMVwiKTtcbiAgICAgICAgdmFyIHN0ZXAyX2NvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNoZWNrb3V0X3N0ZXAyXCIpO1xuXG4gICAgICAgIHZhciBhZmdlcm9uZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcDFcIik7XG4gICAgICAgIHZhciBtZWVCZXppZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcDJcIik7XG5cbiAgICAgICAgdmFyIGxpam4xXzIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInR1c3NlbjEtMlwiKTtcblxuICAgICAgICBsaWpuMV8yLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG4gICAgICAgIGlmIChtZWVCZXppZyB8fCBhZmdlcm9uZCkge1xuICAgICAgICAgICAgbWVlQmV6aWcuY2xhc3NMaXN0LmFkZChcImFjdGl2ZS1jbGFzc1wiKTtcbiAgICAgICAgICAgIGFmZ2Vyb25kLmNsYXNzTGlzdC5hZGQoXCJkb25lLWNsYXNzXCIpO1xuICAgICAgICB9XG5cblxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgNTApO1xuXG4gICAgICAgIHN0ZXAxX2NvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICBzdGVwMl9jb250ZW50LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLmhlaWdodCA9IFwiZml0LWNvbnRlbnRcIjtcbiAgICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUubWFyZ2luQm90dG9tID0gXCI0MHB4XCI7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5wYWRkaW5nID0gXCI1cHggMjVweFwiO1xuICAgIH1cbn1cblxuXG5cblxuLy8gT3BlbiBwcm9kdWN0IG1vZGFsXG5mdW5jdGlvbiBwcm9kdWN0TW9kYWwocHJvZHVjdFRpdGxlLCBwcm9kdWN0TGluaywgcHJvZHVjdEltZ1VybCkge1xuICAgIC8vIGdldHMgaW5uZXIgYW5kIG91dGVyIG1vZGFsc1xuICAgIHZhciB0aGVNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZHVjdE1vZGFsXCIpO1xuICAgIHZhciB0aGVNb2RhbElubmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9kdWN0TW9kYWxJbm5lclwiKTtcblxuICAgIC8vIGNoYW5nZXMgdGhlIGh0bWwgd2l0aCB0aGUgbmV3IHBhcmFtZXRlciBkYXRhIGluc2lkZSBvZiBpdFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWdXcmFwcGVyJykuaW5uZXJIVE1MID0gJzxhIGhyZWY9XCInICsgcHJvZHVjdExpbmsgKyAnXCI+PGltZyBjbGFzcz1cIm1vZGFsUHJvZHVjdEltYWdlXCIgc3JjPVwiJyArIHByb2R1Y3RJbWdVcmwgKyAnXCIvPjwvYT4nO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZHVjdFRpdGxlXCIpLmlubmVySFRNTCA9IHByb2R1Y3RUaXRsZTtcblxuICAgIC8vIGFkZHMgdGhlIGFjdGl2ZSBjbGFzcyB0byB0aGUgbW9kYWxcbiAgICB0aGVNb2RhbC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9fY2FydC0tYWN0aXZlJyk7XG4gICAgLy8gdGhlTW9kYWxJbm5lci5jbGFzc0xpc3QuYWRkKCdwcm9kdWN0X21vZGFsLWFuaW1hdGlvbicpO1xuXG4gICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShcInBhZ2Utb3ZlcmxheVwiKTtcbiAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QuYWRkKFwicGFnZS1vdmVybGF5LS1hY3RpdmVcIik7XG59XG5cbi8vIENsb3NlIHByb2R1Y3QgbW9kYWxcbmZ1bmN0aW9uIGNsb3NlUHJvZHVjdE1vZGFsKCkge1xuICAgIC8vIGdyYWJzIG1vZGFsIGJ5IHRoZSBpZCBhbmQgdGhlbiByZW1vdmUgdGhlIGFjdGl2ZSBjbGFzc1xuICAgIHZhciB0aGVNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZHVjdE1vZGFsXCIpO1xuICAgIHRoZU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX19jYXJ0LS1hY3RpdmUnKTtcblxuICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJwYWdlLW92ZXJsYXktLWFjdGl2ZVwiKTtcbiAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QuYWRkKFwicGFnZS1vdmVybGF5XCIpO1xufVxuXG5cbi8vIEFkZCBpbmNWQVQgcHJpY2UgdGhhdCBjaGFuZ2VzIHdpdGggdGhlIGNvbXBvc2l0ZSBwcmljZVxuXG4vLyBCRUdJTiBsaXN0ZW5lcnMgdG8gcHJpY2VcbnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcm9kdWN0UHJpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpY2VXYXRjaCcpXG4gICAgaWYgKHByb2R1Y3RQcmljZSkge1xuICAgICAgICB2YXIgcHJvZHVjdFNlbGVjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3QnKVxuICAgICAgICBpZiAocHJvZHVjdFNlbGVjdGlvbnMpIHtcbiAgICAgICAgICAgIHByb2R1Y3RTZWxlY3Rpb25zLmZvckVhY2goc2VsZWN0aW9uID0+IHtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGluY1ZBVCwgNTAwKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGluY1ZBVCwgNTAwKTtcbiAgICAgICAgfSlcbiAgICB9XG59LCA2MDApO1xuXG4vLyBTaG93IGluY1ZBVCBwcmljZSBmb3IgcHJvZHVjdFxuZnVuY3Rpb24gaW5jVkFUKCkge1xuICAgIHZhciBpbnB1dDEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZXByaWNlX3dyYXBwZXIgPiBkaXYuY29tcG9zaXRlX3ByaWNlID4gcCBzcGFuXCIpO1xuXG4gICAgaWYgKGlucHV0MSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gaW5wdXQxLmlubmVyVGV4dDtcbiAgICAgICAgdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4gICAgICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4gICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5jVkFUcHJpY2VcIikuaW5uZXJIVE1MID0gZmluYWxSZXN1bHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB3YXRjaFNlbGVjdGlvbnMoKSB7XG4gICAgdmFyIGRyb3Bkb3duU2VsZWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy52YXJpYXRpb25zIHNlbGVjdCwgLnF1YW50aXR5IGlucHV0JylcbiAgICBpZiAoZHJvcGRvd25TZWxlY3Rpb25zKSB7XG4gICAgICAgIGRyb3Bkb3duU2VsZWN0aW9ucy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaW5jVkFUKCk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChwcm9kdWN0VG90YWwsIDYwMClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG4vLyBTaG93IHRvdGFsIHByaWNlIGZvciBhY2Nlc3NvaXJlc1xuZnVuY3Rpb24gcHJvZHVjdFRvdGFsKCkge1xuICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlcHJpY2Vfd3JhcHBlciA+IGRpdi5jb21wb3NpdGVfcHJpY2UgPiBwIHNwYW5cIik7XG4gICAgdmFyIHByb2R1Y3RUb3RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2R1Y3RUb3RhbHNcIik7XG4gICAgaWYgKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBpbnB1dC5pbm5lclRleHQ7XG4gICAgfVxuICAgIGlmIChwcm9kdWN0VG90YWxzKSB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZHVjdFRvdGFsc1wiKS5pbm5lckhUTUwgPSByZXN1bHQ7XG4gICAgfVxufVxuXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKGV2ZW50KSA9PiB7XG4gICAgc2V0VGltZW91dChwcm9kdWN0VG90YWwsIDEwMCk7XG4gICAgc2V0VGltZW91dChpbmNWQVQsIDYwMCk7XG5cbiAgICB2YXIgcmFkaW9CdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJhZGlvX2J1dHRvbicpO1xuXG4gICAgaWYgKHJhZGlvQnV0dG9ucykge1xuICAgICAgICByYWRpb0J1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGluY1ZBVCgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0VG90YWwoKVxuICAgICAgICAgICAgICAgICAgICB3YXRjaFNlbGVjdGlvbnMoKVxuICAgICAgICAgICAgICAgIH0sIDEzMDApXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgb25jZTogZmFsc2VcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxufSk7XG5cbi8vVGltZWQgb3V0IGZ1bmN0aW9uIGZvciBWQVQgUHJpY2UgZm9yIEFjY2Vzc29pcmVzXG5mdW5jdGlvbiBpbmNWQVR0aW1lKCkge1xuICAgIHNldFRpbWVvdXQoaW5jVkFULCA1MDApO1xufVxuXG5cbi8vSW50ZXJ2YWwgZm9yIHRvdGFscHJpY2UgQWNjZXNzb2lyZXMgYm94XG52YXIgcHJvZHVjdFByaWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByaWNlV2F0Y2gnKTtcblxuaWYgKHByb2R1Y3RQcmljZSkge1xuICAgIHNldEludGVydmFsKHByb2R1Y3RUb3RhbCwgMTAwMClcbn0iXX0=
