function openPopup(e){document.getElementById(e).classList.toggle("active")}const openFaqContainer=document.querySelectorAll(".info__faq > .faq-item");for(let e=0;e<openFaqContainer.length;e++)openFaqContainer[e].onclick=function(){if(openFaqContainer[e].classList.contains("active"))openFaqContainer[e].classList.remove("active");else{for(let e of openFaqContainer)e.classList.remove("active");openFaqContainer[e].classList.add("active")}};function closePopup(e){document.getElementById(e).classList.remove("active")}function openSpecs(e){document.getElementById(e).classList.toggle("active");var t=document.querySelector("#specsWrap > div.more__specs");"Minder specificaties"===t.innerHTML?t.innerHTML="Meer specificaties":t.innerHTML="Minder specificaties"}function openFilters(e){document.getElementById(e).classList.toggle("active");var t=document.querySelector(".product-category__filters"),o=document.querySelector(".more-btn svg");t.classList.toggle("--active"),o.classList.toggle("svg--active");var n=document.querySelector(".more__specs");"Filters verbergen"===n.innerHTML?n.innerHTML="Filters weergeven":n.innerHTML="Filters verbergen"}function setCookie(e,t,o){var n="";if(o){var c=new Date;c.setTime(c.getTime()+1*o*60*60*1e3),n="; expires="+c.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var c=o[n];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(t))return c.substring(t.length,c.length)}return null}var popupCookie=getCookie("popupCookie");document.getElementById("can-i-help-popup").style.display=popupCookie?"none":"block",document.getElementById("can-i-help--close").onclick=function(){document.getElementById("can-i-help-popup").style.display="none",setCookie("popupCookie","popupCookievalue",7)};const addToCartButton=document.querySelector(".composite_data > div > div.composite_button"),productID=document.querySelector(".composite_data > div > div.composite_button > input[type=hidden]");if(addToCartButton&&addToCartButton.addEventListener("click",(function(){sessionStorage.setItem("productID",productID.value)})),window.sessionStorage.getItem("productID")){const e=document.getElementById("popup-accessoires"),t=document.getElementById("productAddedModalStandard"),o=document.getElementById("productAddedModalAdvanced");e?(o.style.display="block",o.classList.add("fade-in-bottom")):(t.style.display="block",t.classList.add("fade-in-bottom")),sessionStorage.clear()}function closePAM(){const e=document.getElementById("productAddedModalStandard"),t=document.getElementById("productAddedModalAdvanced");e.classList.remove("fade-in-bottom"),e.style.display="none",t.classList.remove("fade-in-bottom"),t.style.display="none",sessionStorage.clear()}const formProjectinrichting=document.querySelector(".wpcf7-form"),formStepBtnNext=document.getElementById("step__button-next"),formStepOne=document.querySelector(".step__one"),formStepTwo=document.querySelector(".step__two"),formSubmit=document.querySelector(".wpcf7-submit");function waitForElm(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const o=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),o.disconnect())}));o.observe(document.body,{childList:!0,subtree:!0})}))}formProjectinrichting&&(formStepBtnNext.addEventListener("click",(function(e){formStepOne.style.display="none",formStepTwo.style.display="block"})),formSubmit.addEventListener("click",(function(e){waitForElm(".invalid").then((e=>{formStepOne.style.display="block",formStepTwo.style.display="block",formStepBtnNext.style.display="none"}))}))),window.addEventListener("load",(function(){document.querySelector("div.component_inner > div.component_selections > div.component_content > .component_summary > .product"),validateOptons();var e=document.getElementsByClassName("component_options_load_more");e[0]&&e[0].addEventListener("click",(()=>{setTimeout((()=>{validateOptons()}),2e3)}));var t=document.getElementsByClassName("product_summary");t[0]&&t[0].addEventListener("click",(()=>{validateOptons()}))}));const menuItems=document.querySelectorAll(".menu .menu-item");function validateOptons(){performance.getEntriesByType("resource");performance.getEntriesByType("resource").filter((e=>"Rectangle-Copy-14.png"==e.name));var e=document.getElementsByClassName("component_option_thumbnails");const t=document.querySelector("div > div.composite_button > .single_add_to_cart_button");var o=0,n=0;for(let t of e){let e=t.children;o+=1;for(let t of e){let e=t.children;var c=0;for(let t of e)1,t.children[0].classList.contains("selected")&&(c+=1);c&&(n+=1)}}t&&(n===o?(t.style.opacity=1,t.style.pointerEvents="all"):(t.style.opacity=.6,t.style.pointerEvents="none"))}menuItems.forEach((e=>e.addEventListener("mouseenter",(function(){menuItems.forEach((e=>{document.getElementById("page-overlay").classList.add("page-overlay--active")}))})))),menuItems.forEach((e=>e.addEventListener("mouseout",(function(){menuItems.forEach((e=>{document.getElementById("page-overlay").classList.remove("page-overlay--active")}))})))),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".sub-menu");for(let o=0;o<e.length;o++){var t=document.createElement("div");t.className="sub-menu__overlay",e[o].appendChild(t)}}),!1);
var timeout,top1=!1,bottom=!1;function descPress(){var e=document.getElementById("description"),t=document.querySelector(".tab_info");(top1=!top1)?(e.classList.add("showDesc"),t.classList.add("rotateArrow")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}function extraPress(){var e=document.getElementById("additional"),t=document.querySelector(".tab_info:nth-child(2)");(bottom=!bottom)?(t.classList.add("rotateArrow"),e.classList.add("showDesc")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}jQuery(document).ready((function(e){e("form.cart").on("click","button.plus, button.minus",(function(){var t=e(this).closest("form.cart").find(".qty"),o=parseFloat(t.val()),a=parseFloat(t.attr("max")),n=parseFloat(t.attr("min")),s=parseFloat(t.attr("step"));e(this).is(".plus")?a&&a<=o?t.val(a):t.val(o+s):n&&n>=o?t.val(n):o>1&&t.val(o-s)}))})),jQuery((function(e){e(".woocommerce").on("change","input.qty",(function(){void 0!==timeout&&clearTimeout(timeout),timeout=setTimeout((function(){e("[name='update_cart']").trigger("click")}),500)}))}));const voornaam=document.getElementById("billing_first_name"),shipVoornaam=document.getElementById("shipping_first_name"),achternaam=document.getElementById("billing_last_name"),shipAchternaam=document.getElementById("shipping_last_name"),straat=document.getElementById("billing_address_1"),shipStraat=document.getElementById("shipping_address_1"),postcode=document.getElementById("billing_postcode"),shipPostcode=document.getElementById("shipping_postcode"),plaats=document.getElementById("billing_city"),shipPlaats=document.getElementById("shipping_city"),email=document.getElementById("billing_email"),phone=document.getElementById("billing_phone"),line=document.getElementById("tussen1-2"),errorMessage=document.getElementById("formValidation"),diffrentAdress=document.getElementById("ship-to-different-address-checkbox");var progress=12.5;line&&(line.style.width=progress+"%"),allInputs=[voornaam,achternaam,straat,postcode,plaats,email,phone],allInputs.forEach(checkInput);var proceed=!1;function checkInput(e){e&&(e.value&&(progress+=12.5,line.style.width=progress+"%",e.proceed=!0),e.addEventListener("change",(t=>{e.value&&!e.proceed?(progress+=12.5,line.style.width=progress+"%",e.proceed=!0):e.value&&e.proceed||(progress-=12.5,line.style.width=progress+"%",e.proceed=!1)})))}var shipVerder=!1;function nextStepCheckout(){var e=!0;if(shipVerder?shipVoornaam.value&&shipAchternaam.value&&shipStraat.value&&shipPostcode.value&&shipPlaats.value||(e=!1):voornaam.value&&achternaam.value&&straat.value&&postcode.value&&plaats.value&&email.value&&phone.value||(e=!1),e){var t=document.getElementById("checkout_step1"),o=document.getElementById("checkout_step2"),a=document.getElementById("stap1"),n=document.getElementById("stap2");document.getElementById("tussen1-2").style.width="100%",(n||a)&&(n.classList.add("active-class"),a.classList.add("done-class")),window.scrollTo(0,50),t.style.display="none",o.style.display="block",errorMessage.style.display="none"}else errorMessage.style.height="fit-content",errorMessage.style.opacity=1,errorMessage.style.marginBottom="40px",errorMessage.style.padding="5px 25px"}function productModal(e,t,o){var a=document.getElementById("productModal");document.getElementById("productModalInner");document.getElementById("imgWrapper").innerHTML='<a href="'+t+'"><img class="modalProductImage" src="'+o+'"/></a>',document.getElementById("productTitle").innerHTML=e,a.classList.add("modal__cart--active"),pageOverlay.classList.remove("page-overlay"),pageOverlay.classList.add("page-overlay--active")}function closeProductModal(){document.getElementById("productModal").classList.remove("modal__cart--active"),pageOverlay.classList.remove("page-overlay--active"),pageOverlay.classList.add("page-overlay")}function incVAT(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span");if(e){var t=(1.21*e.innerText.replace(/,/g,".")).toFixed(2).replace(".",",");document.getElementById("incVATprice").innerHTML=t}}function watchSelections(){var e=document.querySelectorAll(".variations select, .quantity input");e&&e.forEach((e=>{e.addEventListener("change",(function(){incVAT(),setTimeout(productTotal,600)}))}))}function productTotal(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span"),t=document.querySelector("#productTotals");if(e)var o=e.innerText;t&&(document.querySelector("#productTotals").innerHTML=o)}function incVATtime(){setTimeout(incVAT,500)}diffrentAdress&&diffrentAdress.addEventListener("change",(function(){shipVerder=!shipVerder})),setTimeout((function(){if(document.getElementById("priceWatch")){var e=document.querySelectorAll("select");e&&e.forEach((e=>{e.addEventListener("change",(function(){setTimeout(incVAT,500)}))})),window.addEventListener("click",(function(){setTimeout(incVAT,500)}))}}),600),window.addEventListener("load",(e=>{setTimeout(productTotal,100),setTimeout(incVAT,600);var t=document.querySelectorAll(".radio_button");t&&t.forEach((e=>{e.addEventListener("click",(function(){incVAT(),setTimeout((function(){productTotal(),watchSelections()}),1300)}),{once:!1})}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvb3Rlci5qcyIsIndvb2NvbW1lcmNlLmpzIl0sIm5hbWVzIjpbIm9wZW5Qb3B1cCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIm9wZW5GYXFDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsIm9uY2xpY2siLCJjb250YWlucyIsInJlbW92ZSIsImZhcUNvbnRhaW5lciIsImFkZCIsImNsb3NlUG9wdXAiLCJvcGVuU3BlY3MiLCJidG50ZXh0IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsIm9wZW5GaWx0ZXJzIiwiZmlsdGVyRGl2IiwiZmlsdGVyU1ZHIiwic2V0Q29va2llIiwibmFtZSIsInZhbHVlIiwiZGF5cyIsImV4cGlyZXMiLCJkYXRlIiwiRGF0ZSIsInNldFRpbWUiLCJnZXRUaW1lIiwidG9VVENTdHJpbmciLCJjb29raWUiLCJnZXRDb29raWUiLCJuYW1lRVEiLCJjYSIsInNwbGl0IiwiYyIsImNoYXJBdCIsInN1YnN0cmluZyIsImluZGV4T2YiLCJwb3B1cENvb2tpZSIsInN0eWxlIiwiZGlzcGxheSIsImFkZFRvQ2FydEJ1dHRvbiIsInByb2R1Y3RJRCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXNzaW9uU3RvcmFnZSIsInNldEl0ZW0iLCJ3aW5kb3ciLCJnZXRJdGVtIiwibW9kYWxJZGVudGlmaWVyIiwicHJvZHVjdE1vZGFsU3RhbmRhcmQiLCJwcm9kdWN0TW9kYWxBZHZhbmNlZCIsImNsZWFyIiwiY2xvc2VQQU0iLCJmb3JtUHJvamVjdGlucmljaHRpbmciLCJmb3JtU3RlcEJ0bk5leHQiLCJmb3JtU3RlcE9uZSIsImZvcm1TdGVwVHdvIiwiZm9ybVN1Ym1pdCIsIndhaXRGb3JFbG0iLCJzZWxlY3RvciIsIlByb21pc2UiLCJyZXNvbHZlIiwib2JzZXJ2ZXIiLCJNdXRhdGlvbk9ic2VydmVyIiwibXV0YXRpb25zIiwiZGlzY29ubmVjdCIsIm9ic2VydmUiLCJib2R5IiwiY2hpbGRMaXN0Iiwic3VidHJlZSIsImV2ZW50IiwidGhlbiIsImVsbSIsInZhbGlkYXRlT3B0b25zIiwibG9hZE1vcmVCdXR0b25DIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInNldFRpbWVvdXQiLCJwcm9kdWN0U3VtbWFyeSIsIm1lbnVJdGVtcyIsInBlcmZvcm1hbmNlIiwiZ2V0RW50cmllc0J5VHlwZSIsImZpbHRlciIsInJlc291cmNlIiwiYWFudGFsU3ViT3B0aWVzIiwib3B0aW9uc0NvdW50IiwiYWFudGFsU2VsZWN0ZWQiLCJzaW5nbGUiLCJzdWJPcHRpZXNDaGlsZHMiLCJjaGlsZHJlbiIsIm9wdGlvbk91dGVyIiwic2luZ2xlT3B0aW9uIiwiYWN0aXZlQ2xhc3MiLCJvcHRpb25MaSIsIm9wYWNpdHkiLCJwb2ludGVyRXZlbnRzIiwiZm9yRWFjaCIsImYiLCJlIiwic3ViTWVudSIsInN1Yk1lbnVEaXYiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiYXBwZW5kQ2hpbGQiLCJ0aW1lb3V0IiwidG9wMSIsImJvdHRvbSIsImRlc2NQcmVzcyIsImRlc2NyaXB0aW9uIiwiYXJyb3ciLCJleHRyYVByZXNzIiwialF1ZXJ5IiwicmVhZHkiLCIkIiwib24iLCJxdHkiLCJ0aGlzIiwiY2xvc2VzdCIsImZpbmQiLCJ2YWwiLCJwYXJzZUZsb2F0IiwibWF4IiwiYXR0ciIsIm1pbiIsInN0ZXAiLCJpcyIsInVuZGVmaW5lZCIsImNsZWFyVGltZW91dCIsInRyaWdnZXIiLCJ2b29ybmFhbSIsInNoaXBWb29ybmFhbSIsImFjaHRlcm5hYW0iLCJzaGlwQWNodGVybmFhbSIsInN0cmFhdCIsInNoaXBTdHJhYXQiLCJwb3N0Y29kZSIsInNoaXBQb3N0Y29kZSIsInBsYWF0cyIsInNoaXBQbGFhdHMiLCJlbWFpbCIsInBob25lIiwibGluZSIsImVycm9yTWVzc2FnZSIsImRpZmZyZW50QWRyZXNzIiwicHJvZ3Jlc3MiLCJ3aWR0aCIsImFsbElucHV0cyIsImNoZWNrSW5wdXQiLCJwcm9jZWVkIiwic2hpcFZlcmRlciIsIm5leHRTdGVwQ2hlY2tvdXQiLCJ2ZXJkZXIiLCJzdGVwMV9jb250ZW50Iiwic3RlcDJfY29udGVudCIsImFmZ2Vyb25kIiwibWVlQmV6aWciLCJzY3JvbGxUbyIsImhlaWdodCIsIm1hcmdpbkJvdHRvbSIsInBhZGRpbmciLCJwcm9kdWN0TW9kYWwiLCJwcm9kdWN0VGl0bGUiLCJwcm9kdWN0TGluayIsInByb2R1Y3RJbWdVcmwiLCJ0aGVNb2RhbCIsInBhZ2VPdmVybGF5IiwiY2xvc2VQcm9kdWN0TW9kYWwiLCJpbmNWQVQiLCJpbnB1dDEiLCJmaW5hbFJlc3VsdCIsImlubmVyVGV4dCIsInJlcGxhY2UiLCJ0b0ZpeGVkIiwid2F0Y2hTZWxlY3Rpb25zIiwiZHJvcGRvd25TZWxlY3Rpb25zIiwiZWxlbWVudCIsInByb2R1Y3RUb3RhbCIsImlucHV0IiwicHJvZHVjdFRvdGFscyIsInJlc3VsdCIsImluY1ZBVHRpbWUiLCJwcm9kdWN0U2VsZWN0aW9ucyIsInNlbGVjdGlvbiIsInJhZGlvQnV0dG9ucyIsImJ1dHRvbiIsIm9uY2UiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFVBQVVDLEdBQ1BDLFNBQVNDLGVBQWVGLEdBQzlCRyxVQUFVQyxPQUFPLFVBT3ZCLE1BQU1DLGlCQUFtQkosU0FBU0ssaUJBQWlCLDBCQUNuRCxJQUFJLElBQUlDLEVBQUksRUFBR0EsRUFBSUYsaUJBQWlCRyxPQUFRRCxJQUN4Q0YsaUJBQWlCRSxHQUFHRSxRQUFVLFdBRTFCLEdBRDZCSixpQkFBaUJFLEdBQUdKLFVBQVVPLFNBQVMsVUFHaEVMLGlCQUFpQkUsR0FBR0osVUFBVVEsT0FBTyxjQUNsQyxDQUNILElBQUssSUFBSUMsS0FBZ0JQLGlCQUNyQk8sRUFBYVQsVUFBVVEsT0FBTyxVQUVsQ04saUJBQWlCRSxHQUFHSixVQUFVVSxJQUFJLFlBUzlDLFNBQVNDLFdBQVdkLEdBQ1JDLFNBQVNDLGVBQWVGLEdBQzlCRyxVQUFVUSxPQUFPLFVBR3ZCLFNBQVNJLFVBQVVmLEdBQ1BDLFNBQVNDLGVBQWVGLEdBQzlCRyxVQUFVQyxPQUFPLFVBRW5CLElBQUlZLEVBQVVmLFNBQVNnQixjQUFjLGdDQUNYLHlCQUF0QkQsRUFBUUUsVUFDUkYsRUFBUUUsVUFBWSxxQkFFcEJGLEVBQVFFLFVBQVksdUJBRzVCLFNBQVNDLFlBQVluQixHQUNUQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVUMsT0FBTyxVQUVuQixJQUFJZ0IsRUFBWW5CLFNBQVNnQixjQUFjLDhCQUNuQ0ksRUFBWXBCLFNBQVNnQixjQUFjLGlCQUN2Q0csRUFBVWpCLFVBQVVDLE9BQU8sWUFDM0JpQixFQUFVbEIsVUFBVUMsT0FBTyxlQUMzQixJQUFJWSxFQUFVZixTQUFTZ0IsY0FBYyxnQkFDWCxzQkFBdEJELEVBQVFFLFVBQ1JGLEVBQVFFLFVBQVksb0JBR3BCRixFQUFRRSxVQUFZLG9CQWM1QixTQUFTSSxVQUFVQyxFQUFLQyxFQUFNQyxHQUMxQixJQUFJQyxFQUFVLEdBQ2QsR0FBSUQsRUFBTSxDQUNOLElBQUlFLEVBQU8sSUFBSUMsS0FDZkQsRUFBS0UsUUFBUUYsRUFBS0csVUFBa0IsRUFBTEwsRUFBTyxHQUFHLEdBQUcsS0FDNUNDLEVBQVUsYUFBZUMsRUFBS0ksY0FFbEM5QixTQUFTK0IsT0FBU1QsRUFBTyxLQUFPQyxHQUFTLElBQU9FLEVBQVUsV0FJOUQsU0FBU08sVUFBVVYsR0FHZixJQUZBLElBQUlXLEVBQVNYLEVBQU8sSUFDaEJZLEVBQUtsQyxTQUFTK0IsT0FBT0ksTUFBTSxLQUN2QjdCLEVBQUUsRUFBRUEsRUFBSTRCLEVBQUczQixPQUFPRCxJQUFLLENBRTNCLElBREEsSUFBSThCLEVBQUlGLEVBQUc1QixHQUNTLEtBQWI4QixFQUFFQyxPQUFPLElBQVNELEVBQUlBLEVBQUVFLFVBQVUsRUFBRUYsRUFBRTdCLFFBQzdDLEdBQXlCLEdBQXJCNkIsRUFBRUcsUUFBUU4sR0FBYyxPQUFPRyxFQUFFRSxVQUFVTCxFQUFPMUIsT0FBTzZCLEVBQUU3QixRQUVuRSxPQUFPLEtBSVgsSUFBSWlDLFlBQWNSLFVBQVUsZUFFeEJoQyxTQUFTQyxlQUFlLG9CQUFvQndDLE1BQU1DLFFBRGxERixZQUMwRCxPQUdBLFFBSTlEeEMsU0FBU0MsZUFBZSxxQkFBcUJPLFFBQVEsV0FDakRSLFNBQVNDLGVBQWUsb0JBQW9Cd0MsTUFBTUMsUUFBUSxPQUMxRHJCLFVBQVUsY0FBYyxtQkFBbUIsSUFNL0MsTUFBTXNCLGdCQUFrQjNDLFNBQVNnQixjQUFjLGdEQUN6QzRCLFVBQVk1QyxTQUFTZ0IsY0FBYyxxRUFRekMsR0FOSTJCLGlCQUNBQSxnQkFBZ0JFLGlCQUFpQixTQUFTLFdBQ3RDQyxlQUFlQyxRQUFRLFlBQWFILFVBQVVyQixVQUlsRHlCLE9BQU9GLGVBQWVHLFFBQVEsYUFBYyxDQUM1QyxNQUFNQyxFQUFrQmxELFNBQVNDLGVBQWUscUJBQzFDa0QsRUFBdUJuRCxTQUFTQyxlQUFlLDZCQUMvQ21ELEVBQXVCcEQsU0FBU0MsZUFBZSw2QkFFaERpRCxHQUlERSxFQUFxQlgsTUFBTUMsUUFBVSxRQUNyQ1UsRUFBcUJsRCxVQUFVVSxJQUFJLG9CQUpuQ3VDLEVBQXFCVixNQUFNQyxRQUFVLFFBQ3JDUyxFQUFxQmpELFVBQVVVLElBQUksbUJBTXZDa0MsZUFBZU8sUUFHbkIsU0FBU0MsV0FDTCxNQUFNSCxFQUF1Qm5ELFNBQVNDLGVBQWUsNkJBQy9DbUQsRUFBdUJwRCxTQUFTQyxlQUFlLDZCQUVyRGtELEVBQXFCakQsVUFBVVEsT0FBTyxrQkFDdEN5QyxFQUFxQlYsTUFBTUMsUUFBVSxPQUVyQ1UsRUFBcUJsRCxVQUFVUSxPQUFPLGtCQUN0QzBDLEVBQXFCWCxNQUFNQyxRQUFVLE9BRXJDSSxlQUFlTyxRQXlEbkIsTUFBTUUsc0JBQXdCdkQsU0FBU2dCLGNBQWMsZUFDL0N3QyxnQkFBa0J4RCxTQUFTQyxlQUFlLHFCQUMxQ3dELFlBQWN6RCxTQUFTZ0IsY0FBYyxjQUNyQzBDLFlBQWMxRCxTQUFTZ0IsY0FBYyxjQUNyQzJDLFdBQWEzRCxTQUFTZ0IsY0FBYyxpQkFJMUMsU0FBUzRDLFdBQVdDLEdBQ2hCLE9BQU8sSUFBSUMsU0FBUUMsSUFDZixHQUFJL0QsU0FBU2dCLGNBQWM2QyxHQUN2QixPQUFPRSxFQUFRL0QsU0FBU2dCLGNBQWM2QyxJQUcxQyxNQUFNRyxFQUFXLElBQUlDLGtCQUFpQkMsSUFDOUJsRSxTQUFTZ0IsY0FBYzZDLEtBQ3ZCRSxFQUFRL0QsU0FBU2dCLGNBQWM2QyxJQUMvQkcsRUFBU0csaUJBSWpCSCxFQUFTSSxRQUFRcEUsU0FBU3FFLEtBQU0sQ0FDNUJDLFdBQVcsRUFDWEMsU0FBUyxPQU1sQmhCLHdCQUNDQyxnQkFBZ0JYLGlCQUFpQixTQUFTLFNBQVUyQixHQUNoRGYsWUFBWWhCLE1BQU1DLFFBQVUsT0FDNUJnQixZQUFZakIsTUFBTUMsUUFBVSxXQUdoQ2lCLFdBQVdkLGlCQUFpQixTQUFTLFNBQVUyQixHQUczQ1osV0FBVyxZQUFZYSxNQUFNQyxJQUN6QmpCLFlBQVloQixNQUFNQyxRQUFVLFFBQzVCZ0IsWUFBWWpCLE1BQU1DLFFBQVUsUUFDNUJjLGdCQUFnQmYsTUFBTUMsUUFBVSxjQTBENUNNLE9BQU9ILGlCQUFpQixRQUFRLFdBRzVCN0MsU0FBU2dCLGNBQWMsMEdBRXZCMkQsaUJBR0EsSUFBSUMsRUFBa0I1RSxTQUFTNkUsdUJBQXVCLCtCQUVsREQsRUFBZ0IsSUFDaEJBLEVBQWdCLEdBQUcvQixpQkFBaUIsU0FBUyxLQUN6Q2lDLFlBQVcsS0FDUEgsbUJBQ0QsUUFJWCxJQUFJSSxFQUFpQi9FLFNBQVM2RSx1QkFBdUIsbUJBQ2pERSxFQUFlLElBQ2ZBLEVBQWUsR0FBR2xDLGlCQUFpQixTQUFTLEtBQ3hDOEIsdUJBNEJaLE1BQU1LLFVBQVloRixTQUFTSyxpQkFBaUIsb0JBZ0M1QyxTQUFTc0UsaUJBRUxNLFlBQVlDLGlCQUFpQixZQUVYRCxZQUFZQyxpQkFBaUIsWUFFckNDLFFBQU9DLEdBQTZCLHlCQUFqQkEsRUFBUzlELE9BRXRDLElBQUkrRCxFQUFrQnJGLFNBQVM2RSx1QkFBdUIsK0JBR3RELE1BQU1sQyxFQUFrQjNDLFNBQVNnQixjQUFjLDJEQUUvQyxJQUFJc0UsRUFBZSxFQUNmQyxFQUFpQixFQUVyQixJQUFLLElBQUlDLEtBQVVILEVBQWlCLENBQ2hDLElBQUlJLEVBQWtCRCxFQUFPRSxTQUU3QkosR0FBOEIsRUFFOUIsSUFBSyxJQUFJSyxLQUFlRixFQUFpQixDQUNyQyxJQUFJRyxFQUFlRCxFQUFZRCxTQUMvQixJQUNJRyxFQUFjLEVBRWxCLElBQUssSUFBSUMsS0FBWUYsRUFDVyxFQUV4QkUsRUFBU0osU0FBUyxHQUFHeEYsVUFBVU8sU0FBUyxjQUN4Q29GLEdBQTRCLEdBR2hDQSxJQUNBTixHQUFrQyxJQU0xQzVDLElBQ0k0QyxJQUFtQkQsR0FDbkIzQyxFQUFnQkYsTUFBTXNELFFBQVUsRUFDaENwRCxFQUFnQkYsTUFBTXVELGNBQWdCLFFBRXRDckQsRUFBZ0JGLE1BQU1zRCxRQUFVLEdBQ2hDcEQsRUFBZ0JGLE1BQU11RCxjQUFnQixTQTdFbERoQixVQUFVaUIsU0FBUUMsR0FBS0EsRUFBRXJELGlCQUFpQixjQUFjLFdBQ3BEbUMsVUFBVWlCLFNBQVFFLElBQ1FuRyxTQUFTQyxlQUFlLGdCQUNoQ0MsVUFBVVUsSUFBSSxnQ0FLcENvRSxVQUFVaUIsU0FBUUMsR0FBS0EsRUFBRXJELGlCQUFpQixZQUFZLFdBQ2xEbUMsVUFBVWlCLFNBQVFFLElBR0luRyxTQUFTQyxlQUFlLGdCQUNoQ0MsVUFBVVEsT0FBTyxnQ0FRbkNWLFNBQVM2QyxpQkFBaUIsb0JBQW9CLFdBQzFDLElBQUl1RCxFQUFVcEcsU0FBU0ssaUJBQWlCLGFBQ3hDLElBQUksSUFBSUMsRUFBSSxFQUFHQSxFQUFJOEYsRUFBUTdGLE9BQVFELElBQUksQ0FDbkMsSUFBSStGLEVBQWFyRyxTQUFTc0csY0FBYyxPQUN4Q0QsRUFBV0UsVUFBWSxvQkFDdkJILEVBQVE5RixHQUFHa0csWUFBWUgsT0FFNUI7QUM3WEgsSUFxRUlJLFFBckVBQyxNQUFPLEVBQ1BDLFFBQVMsRUFFYixTQUFTQyxZQUNMLElBQUlDLEVBQWM3RyxTQUFTQyxlQUFlLGVBQ3RDNkcsRUFBUTlHLFNBQVNnQixjQUFjLGNBQ25DMEYsTUFBUUEsT0FHSkcsRUFBWTNHLFVBQVVVLElBQUksWUFDMUJrRyxFQUFNNUcsVUFBVVUsSUFBSSxpQkFFcEJrRyxFQUFNNUcsVUFBVVEsT0FBTyxlQUN2Qm1HLEVBQVkzRyxVQUFVUSxPQUFPLGFBSXJDLFNBQVNxRyxhQUNMLElBQUlGLEVBQWM3RyxTQUFTQyxlQUFlLGNBQ3RDNkcsRUFBUTlHLFNBQVNnQixjQUFjLDJCQUNuQzJGLFFBQVVBLFNBR05HLEVBQU01RyxVQUFVVSxJQUFJLGVBQ3BCaUcsRUFBWTNHLFVBQVVVLElBQUksY0FFMUJrRyxFQUFNNUcsVUFBVVEsT0FBTyxlQUN2Qm1HLEVBQVkzRyxVQUFVUSxPQUFPLGFBTXJDc0csT0FBT2hILFVBQVVpSCxPQUFNLFNBQVNDLEdBRTVCQSxFQUFFLGFBQWFDLEdBQUksUUFBUyw2QkFBNkIsV0FHekQsSUFBSUMsRUFBTUYsRUFBR0csTUFBT0MsUUFBUyxhQUFjQyxLQUFNLFFBQzdDQyxFQUFRQyxXQUFXTCxFQUFJSSxPQUN2QkUsRUFBTUQsV0FBV0wsRUFBSU8sS0FBTSxRQUMzQkMsRUFBTUgsV0FBV0wsRUFBSU8sS0FBTSxRQUMzQkUsRUFBT0osV0FBV0wsRUFBSU8sS0FBTSxTQUczQlQsRUFBR0csTUFBT1MsR0FBSSxTQUNYSixHQUFTQSxHQUFPRixFQUNsQkosRUFBSUksSUFBS0UsR0FHWk4sRUFBSUksSUFBS0EsRUFBTUssR0FJVkQsR0FBU0EsR0FBT0osRUFDbEJKLEVBQUlJLElBQUtJLEdBRUZKLEVBQU0sR0FDYkosRUFBSUksSUFBS0EsRUFBTUssU0FhekJiLFFBQVEsU0FBVUUsR0FDakJBLEVBQUUsZ0JBQWdCQyxHQUFHLFNBQVUsYUFBYSxnQkFFMUJZLElBQVp0QixTQUNKdUIsYUFBY3ZCLFNBR2ZBLFFBQVUzQixZQUFXLFdBQ3BCb0MsRUFBRSx3QkFBd0JlLFFBQVEsV0FDaEMsV0FPTCxNQUFNQyxTQUFXbEksU0FBU0MsZUFBZSxzQkFDbkNrSSxhQUFlbkksU0FBU0MsZUFBZSx1QkFDdkNtSSxXQUFhcEksU0FBU0MsZUFBZSxxQkFDckNvSSxlQUFpQnJJLFNBQVNDLGVBQWUsc0JBQ3pDcUksT0FBU3RJLFNBQVNDLGVBQWUscUJBQ2pDc0ksV0FBYXZJLFNBQVNDLGVBQWUsc0JBQ3JDdUksU0FBV3hJLFNBQVNDLGVBQWUsb0JBQ25Dd0ksYUFBZXpJLFNBQVNDLGVBQWUscUJBQ3ZDeUksT0FBUzFJLFNBQVNDLGVBQWUsZ0JBQ2pDMEksV0FBYTNJLFNBQVNDLGVBQWUsaUJBQ3JDMkksTUFBUTVJLFNBQVNDLGVBQWUsaUJBQ2hDNEksTUFBUTdJLFNBQVNDLGVBQWUsaUJBQ2hDNkksS0FBTzlJLFNBQVNDLGVBQWUsYUFDL0I4SSxhQUFlL0ksU0FBU0MsZUFBZSxrQkFDdkMrSSxlQUFpQmhKLFNBQVNDLGVBQWUsc0NBSS9DLElBQUlnSixTQUFXLEtBQ1hILE9BQ0FBLEtBQUtyRyxNQUFNeUcsTUFBUUQsU0FBVyxLQUlsQ0UsVUFBWSxDQUFDakIsU0FBVUUsV0FBWUUsT0FBUUUsU0FBVUUsT0FBUUUsTUFBT0MsT0FFcEVNLFVBQVVsRCxRQUFRbUQsWUFDbEIsSUFBSUMsU0FBVSxFQUdkLFNBQVNELFdBQVc3SCxHQUNaQSxJQUNJQSxFQUFNQSxRQUNOMEgsVUFBc0IsS0FDdEJILEtBQUtyRyxNQUFNeUcsTUFBUUQsU0FBVyxJQUM5QjFILEVBQU04SCxTQUFVLEdBSXBCOUgsRUFBTXNCLGlCQUFpQixVQUFXMkIsSUFFMUJqRCxFQUFNQSxRQUFVQSxFQUFNOEgsU0FDdEJKLFVBQXNCLEtBQ3RCSCxLQUFLckcsTUFBTXlHLE1BQVFELFNBQVcsSUFDOUIxSCxFQUFNOEgsU0FBVSxHQUNWOUgsRUFBTUEsT0FBU0EsRUFBTThILFVBRzNCSixVQUFxQixLQUNyQkgsS0FBS3JHLE1BQU15RyxNQUFRRCxTQUFXLElBQzlCMUgsRUFBTThILFNBQVUsT0FLaEMsSUFBSUMsWUFBYSxFQU9qQixTQUFTQyxtQkFDTCxJQUFJQyxHQUFTLEVBU2IsR0FSSUYsV0FDS25CLGFBQWE1RyxPQUFVOEcsZUFBZTlHLE9BQVVnSCxXQUFXaEgsT0FBVWtILGFBQWFsSCxPQUFVb0gsV0FBV3BILFFBQ3hHaUksR0FBUyxHQUVMdEIsU0FBUzNHLE9BQVU2RyxXQUFXN0csT0FBVStHLE9BQU8vRyxPQUFVaUgsU0FBU2pILE9BQVVtSCxPQUFPbkgsT0FBVXFILE1BQU1ySCxPQUFVc0gsTUFBTXRILFFBQzNIaUksR0FBUyxHQUdUQSxFQUFRLENBQ1IsSUFBSUMsRUFBZ0J6SixTQUFTQyxlQUFlLGtCQUN4Q3lKLEVBQWdCMUosU0FBU0MsZUFBZSxrQkFFeEMwSixFQUFXM0osU0FBU0MsZUFBZSxTQUNuQzJKLEVBQVc1SixTQUFTQyxlQUFlLFNBRXpCRCxTQUFTQyxlQUFlLGFBRTlCd0MsTUFBTXlHLE1BQVEsUUFDbEJVLEdBQVlELEtBQ1pDLEVBQVMxSixVQUFVVSxJQUFJLGdCQUN2QitJLEVBQVN6SixVQUFVVSxJQUFJLGVBSTNCb0MsT0FBTzZHLFNBQVMsRUFBRyxJQUVuQkosRUFBY2hILE1BQU1DLFFBQVUsT0FDOUJnSCxFQUFjakgsTUFBTUMsUUFBVSxRQUM5QnFHLGFBQWF0RyxNQUFNQyxRQUFVLFlBRTdCcUcsYUFBYXRHLE1BQU1xSCxPQUFTLGNBQzVCZixhQUFhdEcsTUFBTXNELFFBQVUsRUFDN0JnRCxhQUFhdEcsTUFBTXNILGFBQWUsT0FDbENoQixhQUFhdEcsTUFBTXVILFFBQVUsV0FRckMsU0FBU0MsYUFBYUMsRUFBY0MsRUFBYUMsR0FFN0MsSUFBSUMsRUFBV3JLLFNBQVNDLGVBQWUsZ0JBQ25CRCxTQUFTQyxlQUFlLHFCQUc1Q0QsU0FBU0MsZUFBZSxjQUFjZ0IsVUFBWSxZQUFja0osRUFBYyx5Q0FBMkNDLEVBQWdCLFVBQ3pJcEssU0FBU0MsZUFBZSxnQkFBZ0JnQixVQUFZaUosRUFHcERHLEVBQVNuSyxVQUFVVSxJQUFJLHVCQUd2QjBKLFlBQVlwSyxVQUFVUSxPQUFPLGdCQUM3QjRKLFlBQVlwSyxVQUFVVSxJQUFJLHdCQUk5QixTQUFTMkosb0JBRVV2SyxTQUFTQyxlQUFlLGdCQUM5QkMsVUFBVVEsT0FBTyx1QkFFMUI0SixZQUFZcEssVUFBVVEsT0FBTyx3QkFDN0I0SixZQUFZcEssVUFBVVUsSUFBSSxnQkF5QjlCLFNBQVM0SixTQUNMLElBQUlDLEVBQVN6SyxTQUFTZ0IsY0FBYyxxRkFFcEMsR0FBSXlKLEVBQVEsQ0FDUixJQUdJQyxHQUQwQixLQUZqQkQsRUFBT0UsVUFDR0MsUUFBUSxLQUFNLE1BQ0RDLFFBQVEsR0FDZkQsUUFBUSxJQUFLLEtBQzFDNUssU0FBU0MsZUFBZSxlQUFlZ0IsVUFBWXlKLEdBSTNELFNBQVNJLGtCQUNMLElBQUlDLEVBQXFCL0ssU0FBU0ssaUJBQWlCLHVDQUMvQzBLLEdBQ0FBLEVBQW1COUUsU0FBUStFLElBQ3ZCQSxFQUFRbkksaUJBQWlCLFVBQVUsV0FDL0IySCxTQUNBMUYsV0FBV21HLGFBQWMsV0FPekMsU0FBU0EsZUFDTCxJQUFJQyxFQUFRbEwsU0FBU2dCLGNBQWMscUZBQy9CbUssRUFBZ0JuTCxTQUFTZ0IsY0FBYyxrQkFDM0MsR0FBSWtLLEVBQ0EsSUFBSUUsRUFBU0YsRUFBTVAsVUFFbkJRLElBQ0FuTCxTQUFTZ0IsY0FBYyxrQkFBa0JDLFVBQVltSyxHQWtGN0QsU0FBU0MsYUFDTHZHLFdBQVcwRixPQUFRLEtBck5uQnhCLGdCQUNBQSxlQUFlbkcsaUJBQWlCLFVBQVUsV0FDdEN5RyxZQUFjQSxjQThFdEJ4RSxZQUFXLFdBRVAsR0FEbUI5RSxTQUFTQyxlQUFlLGNBQ3pCLENBQ2QsSUFBSXFMLEVBQW9CdEwsU0FBU0ssaUJBQWlCLFVBQzlDaUwsR0FDQUEsRUFBa0JyRixTQUFRc0YsSUFDdEJBLEVBQVUxSSxpQkFBaUIsVUFBVSxXQUNqQ2lDLFdBQVcwRixPQUFRLFdBSS9CeEgsT0FBT0gsaUJBQWlCLFNBQVMsV0FDN0JpQyxXQUFXMEYsT0FBUSxXQUc1QixLQXdDSHhILE9BQU9ILGlCQUFpQixRQUFTMkIsSUFDN0JNLFdBQVdtRyxhQUFjLEtBQ3pCbkcsV0FBVzBGLE9BQVEsS0FFbkIsSUFBSWdCLEVBQWV4TCxTQUFTSyxpQkFBaUIsaUJBRXpDbUwsR0FDQUEsRUFBYXZGLFNBQVF3RixJQUNqQkEsRUFBTzVJLGlCQUFpQixTQUFTLFdBQzdCMkgsU0FDQTFGLFlBQVcsV0FDUG1HLGVBQ0FILG9CQUNELFFBQ0osQ0FDQ1ksTUFBTSIsImZpbGUiOiJmb290ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gb3BlblBvcHVwKGlkKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xufVxuXG5cblxuXG4vLyBvcGVuIC8gY2xvc2UgZmFxIGl0ZW1zXG5jb25zdCBvcGVuRmFxQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5pbmZvX19mYXEgPiAuZmFxLWl0ZW1cIik7XG5mb3IobGV0IGkgPSAwOyBpIDwgb3BlbkZhcUNvbnRhaW5lci5sZW5ndGg7IGkrKyl7XG4gICAgb3BlbkZhcUNvbnRhaW5lcltpXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBmYXFDb250YWluZXJIYXNDbGFzcyA9IG9wZW5GYXFDb250YWluZXJbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpO1xuICAgICAgICBpZihmYXFDb250YWluZXJIYXNDbGFzcykge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2hhcyBjbGFzcycpO1xuICAgICAgICAgICAgb3BlbkZhcUNvbnRhaW5lcltpXS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChsZXQgZmFxQ29udGFpbmVyIG9mIG9wZW5GYXFDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBmYXFDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wZW5GYXFDb250YWluZXJbaV0uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICAgICAgfTtcbiAgICB9O1xufVxuXG5cblxuXG5cbmZ1bmN0aW9uIGNsb3NlUG9wdXAoaWQpIHtcbiAgICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBlLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG59XG5cbmZ1bmN0aW9uIG9wZW5TcGVjcyhpZCkge1xuICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIGUuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiKTtcbiAgICBcbiAgICB2YXIgYnRudGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc3BlY3NXcmFwID4gZGl2Lm1vcmVfX3NwZWNzXCIpO1xuICAgIGlmIChidG50ZXh0LmlubmVySFRNTCA9PT0gXCJNaW5kZXIgc3BlY2lmaWNhdGllc1wiKSB7XG4gICAgICAgIGJ0bnRleHQuaW5uZXJIVE1MID0gJ01lZXIgc3BlY2lmaWNhdGllcyc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnRudGV4dC5pbm5lckhUTUwgPSAnTWluZGVyIHNwZWNpZmljYXRpZXMnO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG9wZW5GaWx0ZXJzKGlkKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xuXG4gICAgdmFyIGZpbHRlckRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZHVjdC1jYXRlZ29yeV9fZmlsdGVyc1wiKTtcbiAgICB2YXIgZmlsdGVyU1ZHID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb3JlLWJ0biBzdmdcIik7XG4gICAgZmlsdGVyRGl2LmNsYXNzTGlzdC50b2dnbGUoXCItLWFjdGl2ZVwiKTtcbiAgICBmaWx0ZXJTVkcuY2xhc3NMaXN0LnRvZ2dsZShcInN2Zy0tYWN0aXZlXCIpO1xuICAgIHZhciBidG50ZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb3JlX19zcGVjc1wiKTtcbiAgICBpZiAoYnRudGV4dC5pbm5lckhUTUwgPT09IFwiRmlsdGVycyB2ZXJiZXJnZW5cIikge1xuICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdGaWx0ZXJzIHdlZXJnZXZlbic7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdGaWx0ZXJzIHZlcmJlcmdlbic7XG4gICAgfVxufVxuXG5cblxuLy8gZnVuY3Rpb24gb3BlbkZpbHRlcnMoKSB7XG4vLyAgICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdC1jYXRlZ29yeV9fZmlsdGVyLWNvbnRhaW5lcicpO1xuLy8gICAgIGUuY2xhc3NMaXN0LnRvZ2dsZShcIi0taGlkZVwiKTtcbi8vIH1cblxuXG5cbi8vIFNldCBDb29raWUgZm9yIHBvcHVwXG5mdW5jdGlvbiBzZXRDb29raWUobmFtZSx2YWx1ZSxkYXlzKSB7XG4gICAgdmFyIGV4cGlyZXMgPSBcIlwiO1xuICAgIGlmIChkYXlzKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgKGRheXMqMSo2MCo2MCoxMDAwKSk7XG4gICAgICAgIGV4cGlyZXMgPSBcIjsgZXhwaXJlcz1cIiArIGRhdGUudG9VVENTdHJpbmcoKTtcbiAgICB9XG4gICAgZG9jdW1lbnQuY29va2llID0gbmFtZSArIFwiPVwiICsgKHZhbHVlIHx8IFwiXCIpICArIGV4cGlyZXMgKyBcIjsgcGF0aD0vXCI7XG59XG5cbi8vIFNldCBDb29raWUgZm9yIHBvcHVwXG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xuICAgIHZhciBuYW1lRVEgPSBuYW1lICsgXCI9XCI7XG4gICAgdmFyIGNhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7XG4gICAgZm9yKHZhciBpPTA7aSA8IGNhLmxlbmd0aDtpKyspIHtcbiAgICAgICAgdmFyIGMgPSBjYVtpXTtcbiAgICAgICAgd2hpbGUgKGMuY2hhckF0KDApPT0nICcpIGMgPSBjLnN1YnN0cmluZygxLGMubGVuZ3RoKTtcbiAgICAgICAgaWYgKGMuaW5kZXhPZihuYW1lRVEpID09IDApIHJldHVybiBjLnN1YnN0cmluZyhuYW1lRVEubGVuZ3RoLGMubGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbi8vIEhpZGUgcG9wdXAgaWYgY29va2llIGlzIHNldFxudmFyIHBvcHVwQ29va2llID0gZ2V0Q29va2llKCdwb3B1cENvb2tpZScpO1xuaWYgKHBvcHVwQ29va2llKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbi1pLWhlbHAtcG9wdXAnKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiXG59XG5lbHNlIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuLWktaGVscC1wb3B1cCcpLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiXG59XG5cbi8vIFNldCBDb29raWUgb24gcG9wdXAgY2xvc2VcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW4taS1oZWxwLS1jbG9zZScpLm9uY2xpY2s9ZnVuY3Rpb24oKXtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuLWktaGVscC1wb3B1cCcpLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7XG4gICAgc2V0Q29va2llKCdwb3B1cENvb2tpZScsJ3BvcHVwQ29va2lldmFsdWUnLDcpO1xufTtcblxuXG5cbi8vIFByb2R1Y3QgTW9kYWwgSlNcbmNvbnN0IGFkZFRvQ2FydEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlX2J1dHRvblwiKVxuY29uc3QgcHJvZHVjdElEID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVfYnV0dG9uID4gaW5wdXRbdHlwZT1oaWRkZW5dXCIpXG5cbmlmIChhZGRUb0NhcnRCdXR0b24pIHtcbiAgICBhZGRUb0NhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcInByb2R1Y3RJRFwiLCBwcm9kdWN0SUQudmFsdWUpO1xuICAgIH0pXG59XG5cbmlmICh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgncHJvZHVjdElEJykpIHtcbiAgICBjb25zdCBtb2RhbElkZW50aWZpZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXAtYWNjZXNzb2lyZXMnKTtcbiAgICBjb25zdCBwcm9kdWN0TW9kYWxTdGFuZGFyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0QWRkZWRNb2RhbFN0YW5kYXJkJylcbiAgICBjb25zdCBwcm9kdWN0TW9kYWxBZHZhbmNlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0QWRkZWRNb2RhbEFkdmFuY2VkJylcblxuICAgIGlmICghbW9kYWxJZGVudGlmaWVyKSB7XG4gICAgICAgIHByb2R1Y3RNb2RhbFN0YW5kYXJkLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICAgICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuY2xhc3NMaXN0LmFkZChcImZhZGUtaW4tYm90dG9tXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgcHJvZHVjdE1vZGFsQWR2YW5jZWQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIlxuICAgICAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5jbGFzc0xpc3QuYWRkKFwiZmFkZS1pbi1ib3R0b21cIilcbiAgICB9XG5cbiAgICBzZXNzaW9uU3RvcmFnZS5jbGVhcigpXG59XG5cbmZ1bmN0aW9uIGNsb3NlUEFNKCkge1xuICAgIGNvbnN0IHByb2R1Y3RNb2RhbFN0YW5kYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RBZGRlZE1vZGFsU3RhbmRhcmQnKVxuICAgIGNvbnN0IHByb2R1Y3RNb2RhbEFkdmFuY2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RBZGRlZE1vZGFsQWR2YW5jZWQnKVxuXG4gICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuY2xhc3NMaXN0LnJlbW92ZShcImZhZGUtaW4tYm90dG9tXCIpXG4gICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cbiAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5jbGFzc0xpc3QucmVtb3ZlKFwiZmFkZS1pbi1ib3R0b21cIilcbiAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcblxuICAgIHNlc3Npb25TdG9yYWdlLmNsZWFyKClcbn1cblxuXG5cblxuLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgIC8vIHZhciBwcmljZVN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYWNldHdwLXN1Ym1pdCcpLmlubmVySFRNTDtcbi8vICAgICAvLyBwcmljZVN1Ym1pdEJ0biA9IFwiTXkgbmV3IHRleHQhXCI7XG4vLyAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mYWNldHdwLXN1Ym1pdFwiKS5pbm5lckhUTUwgPSBcIkkgaGF2ZSBjaGFuZ2VkIVwiO1xuLy8gfSk7XG5cblxuXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIChldmVudCkgPT4ge1xuLy8gICAgIHZhciBwcm9kdWN0T3B0aW9uQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJjb21wb25lbnRfb3B0aW9uX3RodW1ibmFpbF90YXBcIik7XG4vLyAgICAgLy8gdmFyIHByb2R1Y3RPcHRpb25CdG5zQXJyYXkgPSBbLi4ucHJvZHVjdE9wdGlvbkJ0bnNdO1xuLy8gICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlcHJpY2Vfd3JhcHBlciA+IGRpdi5jb21wb3NpdGVfcHJpY2UgPiBwIHNwYW5cIik7XG5cblx0XG4vLyBcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBwcm9kdWN0T3B0aW9uQnRucy5sZW5ndGg7ICsraSkge1xuLy8gXHRcdFx0Ly8gcHJvZHVjdE9wdGlvbkJ0bltpXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgeyBcbi8vICAgICAgICAgICAgIHByb2R1Y3RPcHRpb25CdG5zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbi8vICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuLy8gICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBpbnB1dC5pbm5lclRleHQ7XG4vLyAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4vLyAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdGNhbGMgPSAocmVzdWx0Zml4ICogMS4yMSkudG9GaXhlZCgyKTtcbi8vICAgICAgICAgICAgICAgICB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuLy8gICAgICAgICAgICAgICAgIGlmKHJlc3VsdCkge1xuLy8gICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuLy8gICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcm9kdWN0T3B0aW9uQnRuc1tpXSk7XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG5zW2ldKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICB9XG5cbi8vICAgICB9KTtcbiAgICAvLyBmb3IgKGxldCBwcm9kdWN0T3B0aW9uQnRuIG9mIHByb2R1Y3RPcHRpb25CdG5zQXJyYXkpIHtcbiAgICAvLyAgICAgcHJvZHVjdE9wdGlvbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgLy8gICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vICAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0LmlubmVyVGV4dDtcbiAgICAvLyAgICAgICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuICAgIC8vICAgICAgICAgdmFyIHJlc3VsdGNhbGMgPSAocmVzdWx0Zml4ICogMS4yMSkudG9GaXhlZCgyKTtcbiAgICAvLyAgICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4gICAgLy8gICAgICAgICBpZihyZXN1bHQpIHtcbiAgICAvLyAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuICAgIC8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG4pO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgY29uc29sZS5sb2cocHJvZHVjdE9wdGlvbkJ0bik7XG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZygncHJvZHVjdE9wdGlvbkJ0bicpO1xuICAgIC8vICAgICB9KTtcbiAgXG4gICAgLy8gfVxuICAgIC8vIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG5zQXJyYXkpOyAgXG5cblxuLy8gRm9ybSBwcm9qZWN0aW5yaWNodGluZyBtdWx0aXN0ZXBcbmNvbnN0IGZvcm1Qcm9qZWN0aW5yaWNodGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53cGNmNy1mb3JtJyk7XG5jb25zdCBmb3JtU3RlcEJ0bk5leHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RlcF9fYnV0dG9uLW5leHQnKTtcbmNvbnN0IGZvcm1TdGVwT25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0ZXBfX29uZScpO1xuY29uc3QgZm9ybVN0ZXBUd28gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3RlcF9fdHdvJyk7XG5jb25zdCBmb3JtU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndwY2Y3LXN1Ym1pdCcpO1xuLy8gZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4vLyBvYnNlcnZlciBmb3Igd2FpdGluZyBjbGFzcyB0byBleGlzdFxuZnVuY3Rpb24gd2FpdEZvckVsbShzZWxlY3Rvcikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKG11dGF0aW9ucyA9PiB7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpKTtcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuLy8gc2hvdyAvIGhpZGUgbXVsdGlzdGVwIGZvcm1cbmlmKGZvcm1Qcm9qZWN0aW5yaWNodGluZyl7XG4gICAgZm9ybVN0ZXBCdG5OZXh0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGZvcm1TdGVwT25lLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICB9KTtcbiAgICBcbiAgICBmb3JtU3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cblxuICAgICAgICB3YWl0Rm9yRWxtKCcuaW52YWxpZCcpLnRoZW4oKGVsbSkgPT4ge1xuICAgICAgICAgICAgZm9ybVN0ZXBPbmUuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICAgIGZvcm1TdGVwVHdvLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgICAgICBmb3JtU3RlcEJ0bk5leHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG4gICAgICAgIH0pO1xuXG5cblxuICAgICAgICAvLyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vICAgICBjb25zdCBmb3JtSGFzQ2xhc3NJbnZhbGlkID0gZm9ybVByb2plY3RpbnJpY2h0aW5nLmNsYXNzTGlzdC5jb250YWlucygnaW52YWxpZCcpO1xuICAgICAgICAvLyAgICAgaWYoZm9ybUhhc0NsYXNzSW52YWxpZCkge1xuICAgICAgICAvLyAgICAgICAgIGZvcm1TdGVwT25lLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIC8vICAgICAgICAgZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgLy8gICAgICAgICBmb3JtU3RlcEJ0bk5leHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG4gICAgICAgIC8vICAgICB9O1xuICAgICAgICAvLyB9LCAyNTAwKTtcbiAgICB9KTtcbn07XG5cblxuXG5cbi8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbi8vICAgICAvLyB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmFjZXR3cC1zdWJtaXQnKTtcbi8vICAgICB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyc19fcHJpY2UnKTtcbi8vICAgICB2YXIgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBcbi8vICAgICBlbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLCBlbCk7XG4vLyAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChlbCk7XG4vLyB9LCBmYWxzZSk7XG5cblxuLy8gY29uc3QgY29tcG9uZW50U2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tcG9uZW50X29wdGlvbl90aHVtYm5haWwnKTtcbi8vIGNvbnN0IGNvbXBvbmVudFNlbGVjdGVkQ2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcbi8vIGNvbnN0IGNvbXBvc2l0ZUFkZFRvQ2FydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21wb3NpdGVfYWRkX3RvX2NhcnRfYnV0dG9uJyk7XG4vLyAvLyBjb21wb3NpdGVBZGRUb0NhcnQuc2V0QXR0cmlidXRlKFwicG9pbnRlci1ldmVudHNcIiwgXCJub25lXCIpO1xuLy8gaWYoY29tcG9uZW50U2VsZWN0ZWQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbXBvbmVudFNlbGVjdGVkQ2xhc3MpICkge1xuLy8gICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG5cbi8vIH1cblxuXG5cbi8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCl7XG4gICAgLy8gbGV0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV4dEJ0bicpO1xuICAgIC8vIGxldCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZCdG4nKTtcbiAgICAvLyBsZXQgZWxlbWVudEluZGV4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVsZW1lbnRfaW5kZXgnKTtcbiAgICAvLyBpZihuZXh0QnRuKSB7XG4gICAgLy8gICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgLy8gICAgICAgICB2YXIgY29tcG9zaXRlUGFnaW5hdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbGVtZW50X2luZGV4Jyk7XG4gICAgLy8gICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgY29tcG9zaXRlUGFnaW5hdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbXBvc2l0ZVBhZ2luYXRpb24pO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9KTtcbiAgICAvLyB9XG5cblxuXG4vLyB9KTtcblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuXG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2LmNvbXBvbmVudF9pbm5lciA+IGRpdi5jb21wb25lbnRfc2VsZWN0aW9ucyA+IGRpdi5jb21wb25lbnRfY29udGVudCA+IC5jb21wb25lbnRfc3VtbWFyeSA+IC5wcm9kdWN0XCIpXG5cbiAgICB2YWxpZGF0ZU9wdG9ucygpO1xuICAgIC8vIGxpc3RlbmVyIGZvciBvbmNsaWNrIG9mXG5cbiAgICB2YXIgbG9hZE1vcmVCdXR0b25DID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29tcG9uZW50X29wdGlvbnNfbG9hZF9tb3JlJylcblxuICAgIGlmIChsb2FkTW9yZUJ1dHRvbkNbMF0pIHtcbiAgICAgICAgbG9hZE1vcmVCdXR0b25DWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZU9wdG9ucygpO1xuICAgICAgICAgICAgfSwgMjAwMClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB2YXIgcHJvZHVjdFN1bW1hcnkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9kdWN0X3N1bW1hcnknKVxuICAgIGlmIChwcm9kdWN0U3VtbWFyeVswXSkge1xuICAgICAgICBwcm9kdWN0U3VtbWFyeVswXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdmFsaWRhdGVPcHRvbnMoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cblxuXG5cbiAgICAvLyBibHVycnkgYmFja2dyb3VuZCBvbiBtZW51IGhvdmVyXG4gICAgLy8gdmFyIG1lbnVJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZW51LXdlYnNob3AtMSA+IGxpJyk7XG4gICAgLy8gZm9yKGxldCBpID0gMDsgaSA9IG1lbnVJdGVtcy5sZW5ndGg7IGkrKykge1xuICAgIC8vICAgICBtZW51SXRlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGV2ZW50KSA9PiB7XG5cbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG4gICAgICAgIFxuXG4gICAgLy8gICAgIH0sIGZhbHNlKTtcbiAgICAvLyB9XG5cblxuXG5cbn0pXG5cblxuXG5cblxuLy8gb3ZlcmxheSBhY3RpdmUgb24gbW91c2UgaG92ZXIgbWVudSBpdGVtc1xuY29uc3QgbWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUgLm1lbnUtaXRlbScpO1xubWVudUl0ZW1zLmZvckVhY2goZiA9PiBmLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBmdW5jdGlvbigpIHtcbiAgICBtZW51SXRlbXMuZm9yRWFjaChlID0+IHtcbiAgICAgICAgY29uc3Qgb3ZlcmxheUFjdGl2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlLW92ZXJsYXknKVxuICAgICAgICBvdmVybGF5QWN0aXZlLmNsYXNzTGlzdC5hZGQoJ3BhZ2Utb3ZlcmxheS0tYWN0aXZlJyk7XG4gICAgLy8gY29uc3QgYm9keUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuICAgIC8vIGJvZHlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCItLW1lbnUtaG92ZXJcIik7XG4gIH0pXG59KSk7XG5tZW51SXRlbXMuZm9yRWFjaChmID0+IGYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBmdW5jdGlvbigpIHtcbiAgICBtZW51SXRlbXMuZm9yRWFjaChlID0+IHtcbiAgICAvLyBjb25zdCBib2R5RWxlbWVudCA9IGRvY3VtZW50LmJvZHk7XG4gICAgLy8gYm9keUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIi0tbWVudS1ob3ZlclwiKTtcbiAgICBjb25zdCBvdmVybGF5QWN0aXZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2Utb3ZlcmxheScpXG4gICAgb3ZlcmxheUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdwYWdlLW92ZXJsYXktLWFjdGl2ZScpO1xuICB9KVxufSkpO1xuXG5cblxuXG4vLyBhcHBlbmQgY2xhc3MgdG8gc3ViLW1lbnVcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3ViTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdWItbWVudScpXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHN1Yk1lbnUubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgc3ViTWVudURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgc3ViTWVudURpdi5jbGFzc05hbWUgPSBcInN1Yi1tZW51X19vdmVybGF5XCI7XG4gICAgICAgIHN1Yk1lbnVbaV0uYXBwZW5kQ2hpbGQoc3ViTWVudURpdilcbiAgICB9XG59LCBmYWxzZSk7XG5cblxuZnVuY3Rpb24gdmFsaWRhdGVPcHRvbnMoKSB7XG5cbiAgICBwZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwicmVzb3VyY2VcIilcblxuICAgIGNvbnN0IHJlc291cmNlcyA9IHBlcmZvcm1hbmNlLmdldEVudHJpZXNCeVR5cGUoXCJyZXNvdXJjZVwiKTtcblxuICAgIHJlc291cmNlcy5maWx0ZXIocmVzb3VyY2UgPT4gcmVzb3VyY2UubmFtZSA9PSBcIlJlY3RhbmdsZS1Db3B5LTE0LnBuZ1wiKVxuXG4gICAgdmFyIGFhbnRhbFN1Yk9wdGllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NvbXBvbmVudF9vcHRpb25fdGh1bWJuYWlscycpO1xuXG5cbiAgICBjb25zdCBhZGRUb0NhcnRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2ID4gZGl2LmNvbXBvc2l0ZV9idXR0b24gPiAuc2luZ2xlX2FkZF90b19jYXJ0X2J1dHRvblwiKVxuXG4gICAgdmFyIG9wdGlvbnNDb3VudCA9IDA7XG4gICAgdmFyIGFhbnRhbFNlbGVjdGVkID0gMDtcblxuICAgIGZvciAobGV0IHNpbmdsZSBvZiBhYW50YWxTdWJPcHRpZXMpIHtcbiAgICAgICAgbGV0IHN1Yk9wdGllc0NoaWxkcyA9IHNpbmdsZS5jaGlsZHJlbjtcblxuICAgICAgICBvcHRpb25zQ291bnQgPSBvcHRpb25zQ291bnQgKyAxO1xuXG4gICAgICAgIGZvciAobGV0IG9wdGlvbk91dGVyIG9mIHN1Yk9wdGllc0NoaWxkcykge1xuICAgICAgICAgICAgbGV0IHNpbmdsZU9wdGlvbiA9IG9wdGlvbk91dGVyLmNoaWxkcmVuO1xuICAgICAgICAgICAgdmFyIGdsb2JhbENvdW50ID0gMDtcbiAgICAgICAgICAgIHZhciBhY3RpdmVDbGFzcyA9IDA7XG5cbiAgICAgICAgICAgIGZvciAobGV0IG9wdGlvbkxpIG9mIHNpbmdsZU9wdGlvbikge1xuICAgICAgICAgICAgICAgIGdsb2JhbENvdW50ID0gZ2xvYmFsQ291bnQgKyAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbkxpLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVDbGFzcyA9IGFjdGl2ZUNsYXNzICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWN0aXZlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBhYW50YWxTZWxlY3RlZCA9IGFhbnRhbFNlbGVjdGVkICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIG9ubHkgY2hhbmdlIHN0eWxpbmcgb2YgdGhlIGFkZCB0byBjYXJ0IGJ1dHRvbiB3aGVuIHRoZXJlIGFyZSBtdWNoIHNlbGVjdGVkIGJveGVzIGFzIHJvd3Mgb2Ygb3B0aW9uc1xuICAgIGlmIChhZGRUb0NhcnRCdXR0b24pIHtcbiAgICAgICAgaWYgKGFhbnRhbFNlbGVjdGVkID09PSBvcHRpb25zQ291bnQpIHtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhbGxcIlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkVG9DYXJ0QnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAuNjtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCJcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5cblxuXG4vLyBjb25zdCB3ZWJzaG9wTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51LXdlYnNob3AtY29udGFpbmVyID4gLm1lbnUtaXRlbScpXG4vLyBjb25zdCBcblxuLy8gZm9yKGxldCBpID0gMDsgaSA8IHdlYnNob3BNZW51Lmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgd2Vic2hvcE1lbnVbaV0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24oIGV2ZW50ICkgeyAgIFxuLy8gICAgICAgICBldmVudC50YXJnZXQuc3R5bGUuY29sb3IgPSBcInB1cnBsZVwiO1xuXG4vLyAgICAgICB9LCBmYWxzZSk7XG4vLyB9XG5cblxuXG4iLCJ2YXIgdG9wMSA9IGZhbHNlXG52YXIgYm90dG9tID0gZmFsc2VcblxuZnVuY3Rpb24gZGVzY1ByZXNzKCkge1xuICAgIHZhciBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXNjcmlwdGlvbicpO1xuICAgIHZhciBhcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFiX2luZm9cIik7XG4gICAgdG9wMSA9ICF0b3AxXG5cbiAgICBpZiAodG9wMSkge1xuICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKFwic2hvd0Rlc2NcIik7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5hZGQoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhcnJvdy5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlQXJyb3dcIik7XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93RGVzY1wiKVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZXh0cmFQcmVzcygpIHtcbiAgICB2YXIgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkaXRpb25hbCcpO1xuICAgIHZhciBhcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFiX2luZm86bnRoLWNoaWxkKDIpXCIpO1xuICAgIGJvdHRvbSA9ICFib3R0b207XG5cbiAgICBpZiAoYm90dG9tKSB7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5hZGQoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInNob3dEZXNjXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LnJlbW92ZShcInNob3dEZXNjXCIpO1xuICAgIH1cbn1cblxuLy8gTWludXMgYW5kIFBsdXMgYnV0dG9ucyBxdWFudGl0eVxuXG5qUXVlcnkoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCQpe1xuXG4gICAgJCgnZm9ybS5jYXJ0Jykub24oICdjbGljaycsICdidXR0b24ucGx1cywgYnV0dG9uLm1pbnVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAvLyBHZXQgY3VycmVudCBxdWFudGl0eSB2YWx1ZXNcbiAgICB2YXIgcXR5ID0gJCggdGhpcyApLmNsb3Nlc3QoICdmb3JtLmNhcnQnICkuZmluZCggJy5xdHknICk7XG4gICAgdmFyIHZhbCAgID0gcGFyc2VGbG9hdChxdHkudmFsKCkpO1xuICAgIHZhciBtYXggPSBwYXJzZUZsb2F0KHF0eS5hdHRyKCAnbWF4JyApKTtcbiAgICB2YXIgbWluID0gcGFyc2VGbG9hdChxdHkuYXR0ciggJ21pbicgKSk7XG4gICAgdmFyIHN0ZXAgPSBwYXJzZUZsb2F0KHF0eS5hdHRyKCAnc3RlcCcgKSk7XG5cbiAgICAvLyBDaGFuZ2UgdGhlIHZhbHVlIGlmIHBsdXMgb3IgbWludXNcbiAgICBpZiAoICQoIHRoaXMgKS5pcyggJy5wbHVzJyApICkge1xuICAgICAgIGlmICggbWF4ICYmICggbWF4IDw9IHZhbCApICkge1xuICAgICAgICAgIHF0eS52YWwoIG1heCApO1xuICAgICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICBxdHkudmFsKCB2YWwgKyBzdGVwICk7XG4gICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgIGlmICggbWluICYmICggbWluID49IHZhbCApICkge1xuICAgICAgICAgIHF0eS52YWwoIG1pbiApO1xuICAgICAgIH1cbiAgICAgICBlbHNlIGlmICggdmFsID4gMSApIHtcbiAgICAgICAgICBxdHkudmFsKCB2YWwgLSBzdGVwICk7XG4gICAgICAgfVxuICAgIH1cblxuIH0pO1xuXG59KTtcblxuXG4vLyBBamF4IHF1YW50aXR5IGFkZFxuXG52YXIgdGltZW91dDtcblxualF1ZXJ5KCBmdW5jdGlvbiggJCApIHtcblx0JCgnLndvb2NvbW1lcmNlJykub24oJ2NoYW5nZScsICdpbnB1dC5xdHknLCBmdW5jdGlvbigpe1xuXG5cdFx0aWYgKCB0aW1lb3V0ICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcblx0XHR9XG5cblx0XHR0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdCQoXCJbbmFtZT0ndXBkYXRlX2NhcnQnXVwiKS50cmlnZ2VyKFwiY2xpY2tcIik7XG5cdFx0fSwgNTAwICk7IC8vIDAuNSBzZWNvbmQgZGVsYXlcblxuXHR9ICk7XG59ICk7XG5cblxuLy8gZ2V0dGluZyBhbGwgaW5wdXQgZmllbGRzICYgcHJvZ3Jlc3MgbGluZVxuY29uc3Qgdm9vcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19maXJzdF9uYW1lJylcbmNvbnN0IHNoaXBWb29ybmFhbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19maXJzdF9uYW1lJylcbmNvbnN0IGFjaHRlcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19sYXN0X25hbWUnKVxuY29uc3Qgc2hpcEFjaHRlcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfbGFzdF9uYW1lJylcbmNvbnN0IHN0cmFhdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2FkZHJlc3NfMScpXG5jb25zdCBzaGlwU3RyYWF0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXBwaW5nX2FkZHJlc3NfMScpXG5jb25zdCBwb3N0Y29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX3Bvc3Rjb2RlJylcbmNvbnN0IHNoaXBQb3N0Y29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19wb3N0Y29kZScpXG5jb25zdCBwbGFhdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19jaXR5JylcbmNvbnN0IHNoaXBQbGFhdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfY2l0eScpXG5jb25zdCBlbWFpbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2VtYWlsJylcbmNvbnN0IHBob25lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfcGhvbmUnKVxuY29uc3QgbGluZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXNzZW4xLTInKTtcbmNvbnN0IGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtVmFsaWRhdGlvbicpO1xuY29uc3QgZGlmZnJlbnRBZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcC10by1kaWZmZXJlbnQtYWRkcmVzcy1jaGVja2JveCcpO1xuXG5cblxudmFyIHByb2dyZXNzID0gMTIuNTtcbmlmIChsaW5lKSB7XG4gICAgbGluZS5zdHlsZS53aWR0aCA9IHByb2dyZXNzICsgXCIlXCI7XG59XG5cbi8vIHB1dHRpbmcgdGhlIGlucHV0cyBpbiBhbiBhcnJheVxuYWxsSW5wdXRzID0gW3Zvb3JuYWFtLCBhY2h0ZXJuYWFtLCBzdHJhYXQsIHBvc3Rjb2RlLCBwbGFhdHMsIGVtYWlsLCBwaG9uZV1cblxuYWxsSW5wdXRzLmZvckVhY2goY2hlY2tJbnB1dCk7XG52YXIgcHJvY2VlZCA9IGZhbHNlO1xuXG5cbmZ1bmN0aW9uIGNoZWNrSW5wdXQodmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlLnZhbHVlKSB7XG4gICAgICAgICAgICBwcm9ncmVzcyA9IHByb2dyZXNzICsgMTIuNTtcbiAgICAgICAgICAgIGxpbmUuc3R5bGUud2lkdGggPSBwcm9ncmVzcyArIFwiJVwiO1xuICAgICAgICAgICAgdmFsdWUucHJvY2VlZCA9IHRydWU7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHZhbHVlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldmVudCkgPT4ge1xuXG4gICAgICAgICAgICBpZiAodmFsdWUudmFsdWUgJiYgIXZhbHVlLnByb2NlZWQpIHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHByb2dyZXNzICsgMTIuNTtcbiAgICAgICAgICAgICAgICBsaW5lLnN0eWxlLndpZHRoID0gcHJvZ3Jlc3MgKyBcIiVcIjtcbiAgICAgICAgICAgICAgICB2YWx1ZS5wcm9jZWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZih2YWx1ZS52YWx1ZSAmJiB2YWx1ZS5wcm9jZWVkKSB7XG4gICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHByb2dyZXNzIC0xMi41O1xuICAgICAgICAgICAgICAgIGxpbmUuc3R5bGUud2lkdGggPSBwcm9ncmVzcyArIFwiJVwiO1xuICAgICAgICAgICAgICAgIHZhbHVlLnByb2NlZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxudmFyIHNoaXBWZXJkZXIgPSBmYWxzZTtcbmlmIChkaWZmcmVudEFkcmVzcykge1xuICAgIGRpZmZyZW50QWRyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzaGlwVmVyZGVyID0gIXNoaXBWZXJkZXI7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gbmV4dFN0ZXBDaGVja291dCgpIHtcbiAgICB2YXIgdmVyZGVyID0gdHJ1ZTtcbiAgICBpZiAoc2hpcFZlcmRlcikge1xuICAgICAgICBpZiAoIXNoaXBWb29ybmFhbS52YWx1ZSB8fCAhc2hpcEFjaHRlcm5hYW0udmFsdWUgfHwgIXNoaXBTdHJhYXQudmFsdWUgfHwgIXNoaXBQb3N0Y29kZS52YWx1ZSB8fCAhc2hpcFBsYWF0cy52YWx1ZSkge1xuICAgICAgICAgICAgdmVyZGVyID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCF2b29ybmFhbS52YWx1ZSB8fCAhYWNodGVybmFhbS52YWx1ZSB8fCAhc3RyYWF0LnZhbHVlIHx8ICFwb3N0Y29kZS52YWx1ZSB8fCAhcGxhYXRzLnZhbHVlIHx8ICFlbWFpbC52YWx1ZSB8fCAhcGhvbmUudmFsdWUpIHtcbiAgICAgICAgdmVyZGVyID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHZlcmRlcikge1xuICAgICAgICB2YXIgc3RlcDFfY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hlY2tvdXRfc3RlcDFcIik7XG4gICAgICAgIHZhciBzdGVwMl9jb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGVja291dF9zdGVwMlwiKTtcblxuICAgICAgICB2YXIgYWZnZXJvbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXAxXCIpO1xuICAgICAgICB2YXIgbWVlQmV6aWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXAyXCIpO1xuXG4gICAgICAgIHZhciBsaWpuMV8yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0dXNzZW4xLTJcIik7XG5cbiAgICAgICAgbGlqbjFfMi5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuICAgICAgICBpZiAobWVlQmV6aWcgfHwgYWZnZXJvbmQpIHtcbiAgICAgICAgICAgIG1lZUJlemlnLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtY2xhc3NcIik7XG4gICAgICAgICAgICBhZmdlcm9uZC5jbGFzc0xpc3QuYWRkKFwiZG9uZS1jbGFzc1wiKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDUwKTtcblxuICAgICAgICBzdGVwMV9jb250ZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgc3RlcDJfY29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5oZWlnaHQgPSBcImZpdC1jb250ZW50XCI7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiNDBweFwiO1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUucGFkZGluZyA9IFwiNXB4IDI1cHhcIjtcbiAgICB9XG59XG5cblxuXG5cbi8vIE9wZW4gcHJvZHVjdCBtb2RhbFxuZnVuY3Rpb24gcHJvZHVjdE1vZGFsKHByb2R1Y3RUaXRsZSwgcHJvZHVjdExpbmssIHByb2R1Y3RJbWdVcmwpIHtcbiAgICAvLyBnZXRzIGlubmVyIGFuZCBvdXRlciBtb2RhbHNcbiAgICB2YXIgdGhlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RNb2RhbFwiKTtcbiAgICB2YXIgdGhlTW9kYWxJbm5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZHVjdE1vZGFsSW5uZXJcIik7XG5cbiAgICAvLyBjaGFuZ2VzIHRoZSBodG1sIHdpdGggdGhlIG5ldyBwYXJhbWV0ZXIgZGF0YSBpbnNpZGUgb2YgaXRcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1nV3JhcHBlcicpLmlubmVySFRNTCA9ICc8YSBocmVmPVwiJyArIHByb2R1Y3RMaW5rICsgJ1wiPjxpbWcgY2xhc3M9XCJtb2RhbFByb2R1Y3RJbWFnZVwiIHNyYz1cIicgKyBwcm9kdWN0SW1nVXJsICsgJ1wiLz48L2E+JztcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RUaXRsZVwiKS5pbm5lckhUTUwgPSBwcm9kdWN0VGl0bGU7XG5cbiAgICAvLyBhZGRzIHRoZSBhY3RpdmUgY2xhc3MgdG8gdGhlIG1vZGFsXG4gICAgdGhlTW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWxfX2NhcnQtLWFjdGl2ZScpO1xuICAgIC8vIHRoZU1vZGFsSW5uZXIuY2xhc3NMaXN0LmFkZCgncHJvZHVjdF9tb2RhbC1hbmltYXRpb24nKTtcblxuICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJwYWdlLW92ZXJsYXlcIik7XG4gICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LmFkZChcInBhZ2Utb3ZlcmxheS0tYWN0aXZlXCIpO1xufVxuXG4vLyBDbG9zZSBwcm9kdWN0IG1vZGFsXG5mdW5jdGlvbiBjbG9zZVByb2R1Y3RNb2RhbCgpIHtcbiAgICAvLyBncmFicyBtb2RhbCBieSB0aGUgaWQgYW5kIHRoZW4gcmVtb3ZlIHRoZSBhY3RpdmUgY2xhc3NcbiAgICB2YXIgdGhlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RNb2RhbFwiKTtcbiAgICB0aGVNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9fY2FydC0tYWN0aXZlJyk7XG5cbiAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwicGFnZS1vdmVybGF5LS1hY3RpdmVcIik7XG4gICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LmFkZChcInBhZ2Utb3ZlcmxheVwiKTtcbn1cblxuXG4vLyBBZGQgaW5jVkFUIHByaWNlIHRoYXQgY2hhbmdlcyB3aXRoIHRoZSBjb21wb3NpdGUgcHJpY2VcblxuLy8gQkVHSU4gbGlzdGVuZXJzIHRvIHByaWNlXG5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcHJvZHVjdFByaWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByaWNlV2F0Y2gnKVxuICAgIGlmIChwcm9kdWN0UHJpY2UpIHtcbiAgICAgICAgdmFyIHByb2R1Y3RTZWxlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JylcbiAgICAgICAgaWYgKHByb2R1Y3RTZWxlY3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9kdWN0U2VsZWN0aW9ucy5mb3JFYWNoKHNlbGVjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChpbmNWQVQsIDUwMCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2V0VGltZW91dChpbmNWQVQsIDUwMCk7XG4gICAgICAgIH0pXG4gICAgfVxufSwgNjAwKTtcblxuLy8gU2hvdyBpbmNWQVQgcHJpY2UgZm9yIHByb2R1Y3RcbmZ1bmN0aW9uIGluY1ZBVCgpIHtcbiAgICB2YXIgaW5wdXQxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVwcmljZV93cmFwcGVyID4gZGl2LmNvbXBvc2l0ZV9wcmljZSA+IHAgc3BhblwiKTtcblxuICAgIGlmIChpbnB1dDEpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0MS5pbm5lclRleHQ7XG4gICAgICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuICAgICAgICB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuICAgICAgICB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gd2F0Y2hTZWxlY3Rpb25zKCkge1xuICAgIHZhciBkcm9wZG93blNlbGVjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudmFyaWF0aW9ucyBzZWxlY3QsIC5xdWFudGl0eSBpbnB1dCcpXG4gICAgaWYgKGRyb3Bkb3duU2VsZWN0aW9ucykge1xuICAgICAgICBkcm9wZG93blNlbGVjdGlvbnMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGluY1ZBVCgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocHJvZHVjdFRvdGFsLCA2MDApXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuLy8gU2hvdyB0b3RhbCBwcmljZSBmb3IgYWNjZXNzb2lyZXNcbmZ1bmN0aW9uIHByb2R1Y3RUb3RhbCgpIHtcbiAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZXByaWNlX3dyYXBwZXIgPiBkaXYuY29tcG9zaXRlX3ByaWNlID4gcCBzcGFuXCIpO1xuICAgIHZhciBwcm9kdWN0VG90YWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9kdWN0VG90YWxzXCIpO1xuICAgIGlmIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gaW5wdXQuaW5uZXJUZXh0O1xuICAgIH1cbiAgICBpZiAocHJvZHVjdFRvdGFscykge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2R1Y3RUb3RhbHNcIikuaW5uZXJIVE1MID0gcmVzdWx0O1xuICAgIH1cbn1cblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIChldmVudCkgPT4ge1xuICAgIHNldFRpbWVvdXQocHJvZHVjdFRvdGFsLCAxMDApO1xuICAgIHNldFRpbWVvdXQoaW5jVkFULCA2MDApO1xuXG4gICAgdmFyIHJhZGlvQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yYWRpb19idXR0b24nKTtcblxuICAgIGlmIChyYWRpb0J1dHRvbnMpIHtcbiAgICAgICAgcmFkaW9CdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpbmNWQVQoKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdFRvdGFsKClcbiAgICAgICAgICAgICAgICAgICAgd2F0Y2hTZWxlY3Rpb25zKClcbiAgICAgICAgICAgICAgICB9LCAxMzAwKVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG9uY2U6IGZhbHNlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbn0pO1xuXG5cbi8vIGFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4vLyAgICAgdmFyIHByaWNlT2ZmZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndvb2NvbW1lcmNlLVByaWNlLWFtb3VudFwiKTtcbi8vICAgICBpZihwcmljZU9mZmVyKSB7XG4vLyAgICAgICAgIHZhciByZXN1bHQgPSBwcmljZU9mZmVyLmlubmVyVGV4dDtcbi8vICAgICAgICAgdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4vLyAgICAgICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4vLyAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2FsZS1hbW91bnRfX3JlZ3VsYXItcHJpY2UgYmRpXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0ICsgXCIgXCI7XG4vLyAgICAgfVxuLy8gfSk7XG5cblxuXG5cbi8vIGFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4vLyAgICAgbGV0IGNvbXBvbmVudFRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29tcG9uZW50X29wdGlvbl90aHVtYm5haWwnKTtcbi8vICAgICBjb25zb2xlLmxvZygnbG9hZGVkJyk7XG4vLyAgICAgZm9yKGxldCBpID0gMDsgaSA8IGNvbXBvbmVudFRpbGUubGVuZ3RoOyBpKyspe1xuXG5cbi8vICAgICAgICAgY29tcG9uZW50VGlsZVtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsaWNrZWQnKTtcbi8vICAgICAgICAgfSk7XG5cblxuXG4vLyAgICAgICAgICAgICAvLyBsZXQgcHJpY2VJbmNsVmF0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvb2NvbW1lcmNlLVByaWNlLWFtb3VudCcpLmlubmVyVGV4dDtcbi8vICAgICAgICAgICAgIC8vIGxldCBwcmljZUV4Y2xWYXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5jVkFUcHJpY2UnKS5pbm5lclRleHQ7XG4vLyAgICAgICAgICAgICAvLyBwcmljZUluY2xWYXRXaXRoUG9pbnQgPSBwcmljZUluY2xWYXQucmVwbGFjZSgvLC9nLCAnLicpO1xuLy8gICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJpY2VJbmNsVmF0V2l0aFBvaW50KTtcblxuXG4vLyAgICAgICAgICAgICAvLyB2YXIgcmVzdWx0Zml4ID0gcmVzdWx0LnJlcGxhY2UoLywvZywgJy4nKTtcbi8vICAgICAgICAgICAgIC8vIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgICAgICAvLyB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuLy8gICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNWQVRwcmljZVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdDtcblxuXG4vLyAgICAgICAgICAgICAvLyB2YXIgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZXByaWNlX3dyYXBwZXIgPiBkaXYuY29tcG9zaXRlX3ByaWNlID4gcCBzcGFuXCIpO1xuLy8gICAgICAgICAgICAgLy8gaWYoaW5wdXQpIHtcbi8vICAgICAgICAgICAgIC8vICAgICB2YXIgcmVzdWx0ID0gaW5wdXQuaW5uZXJUZXh0O1xuLy8gICAgICAgICAgICAgLy8gICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuLy8gICAgICAgICAgICAgLy8gICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgICAgICAvLyAgICAgdmFyIGZpbmFsUmVzdWx0ID0gcmVzdWx0Y2FsYy5yZXBsYWNlKCcuJywgJywnKTtcbi8vICAgICAgICAgICAgIC8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuLy8gICAgICAgICAgICAgLy8gfVxuXG5cblxuLy8gICAgIH07XG5cblxuLy8gfSk7XG5cbi8vVGltZWQgb3V0IGZ1bmN0aW9uIGZvciBWQVQgUHJpY2UgZm9yIEFjY2Vzc29pcmVzXG5mdW5jdGlvbiBpbmNWQVR0aW1lKCkge1xuICAgIHNldFRpbWVvdXQoaW5jVkFULCA1MDApO1xufSJdfQ==
