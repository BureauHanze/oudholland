function openPopup(e){document.getElementById(e).classList.toggle("active")}const openFaqContainer=document.querySelectorAll(".info__faq > .faq-item");for(let e=0;e<openFaqContainer.length;e++)openFaqContainer[e].onclick=function(){if(openFaqContainer[e].classList.contains("active"))openFaqContainer[e].classList.remove("active");else{for(let e of openFaqContainer)e.classList.remove("active");openFaqContainer[e].classList.add("active")}};function closePopup(e){document.getElementById(e).classList.remove("active")}function openSpecs(e){document.getElementById(e).classList.toggle("active");var t=document.querySelector("#specsWrap > div.more__specs");"Minder specificaties"===t.innerHTML?t.innerHTML="Meer specificaties":t.innerHTML="Minder specificaties"}function setCookie(e,t,o){var n="";if(o){var c=new Date;c.setTime(c.getTime()+1*o*60*60*1e3),n="; expires="+c.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var c=o[n];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(t))return c.substring(t.length,c.length)}return null}var popupCookie=getCookie("popupCookie");document.getElementById("can-i-help-popup").style.display=popupCookie?"none":"block",document.getElementById("can-i-help--close").onclick=function(){document.getElementById("can-i-help-popup").style.display="none",setCookie("popupCookie","popupCookievalue",7)};const addToCartButton=document.querySelector(".composite_data > div > div.composite_button"),productID=document.querySelector(".composite_data > div > div.composite_button > input[type=hidden]");if(addToCartButton&&addToCartButton.addEventListener("click",(function(){sessionStorage.setItem("productID",productID.value)})),window.sessionStorage.getItem("productID")){const e=document.getElementById("popup-accessoires"),t=document.getElementById("productAddedModalStandard"),o=document.getElementById("productAddedModalAdvanced");e?(o.style.display="block",o.classList.add("fade-in-bottom")):(t.style.display="block",t.classList.add("fade-in-bottom")),sessionStorage.clear()}function closePAM(){const e=document.getElementById("productAddedModalStandard"),t=document.getElementById("productAddedModalAdvanced");e.classList.remove("fade-in-bottom"),e.style.display="none",t.classList.remove("fade-in-bottom"),t.style.display="none",sessionStorage.clear()}const formProjectinrichting=document.querySelector(".wpcf7-form"),formStepBtnNext=document.getElementById("step__button-next"),formStepOne=document.querySelector(".step__one"),formStepTwo=document.querySelector(".step__two"),formSubmit=document.querySelector(".wpcf7-submit");function waitForElm(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const o=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),o.disconnect())}));o.observe(document.body,{childList:!0,subtree:!0})}))}function validateOptons(){performance.getEntriesByType("resource");performance.getEntriesByType("resource").filter((e=>"Rectangle-Copy-14.png"==e.name));var e=document.getElementsByClassName("component_option_thumbnails");const t=document.querySelector("div > div.composite_button > .single_add_to_cart_button");var o=0,n=0;for(let t of e){let e=t.children;o+=1;for(let t of e){let e=t.children;var c=0;for(let t of e)1,t.children[0].classList.contains("selected")&&(c+=1);c&&(n+=1)}}t&&(n===o?(t.style.opacity=1,t.style.pointerEvents="all"):(t.style.opacity=.6,t.style.pointerEvents="none"))}formProjectinrichting&&(formStepBtnNext.addEventListener("click",(function(e){formStepOne.style.display="none",formStepTwo.style.display="block"})),formSubmit.addEventListener("click",(function(e){waitForElm(".invalid").then((e=>{formStepOne.style.display="block",formStepTwo.style.display="block",formStepBtnNext.style.display="none"}))}))),window.addEventListener("load",(function(){document.querySelector("div.component_inner > div.component_selections > div.component_content > .component_summary > .product"),validateOptons();var e=document.getElementsByClassName("component_options_load_more");e[0]&&e[0].addEventListener("click",(()=>{setTimeout((()=>{validateOptons()}),2e3)}));var t=document.getElementsByClassName("product_summary");t[0]&&t[0].addEventListener("click",(()=>{validateOptons()}))})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".sub-menu");for(let o=0;o<e.length;o++){var t=document.createElement("div");t.className="sub-menu__overlay",e[o].appendChild(t)}}),!1);
var timeout,top1=!1,bottom=!1;function descPress(){var e=document.getElementById("description"),t=document.querySelector(".tab_info");(top1=!top1)?(e.classList.add("showDesc"),t.classList.add("rotateArrow")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}function extraPress(){var e=document.getElementById("additional"),t=document.querySelector(".tab_info:nth-child(2)");(bottom=!bottom)?(t.classList.add("rotateArrow"),e.classList.add("showDesc")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}jQuery(document).ready((function(e){e("form.cart").on("click","button.plus, button.minus",(function(){var t=e(this).closest("form.cart").find(".qty"),o=parseFloat(t.val()),a=parseFloat(t.attr("max")),n=parseFloat(t.attr("min")),s=parseFloat(t.attr("step"));e(this).is(".plus")?a&&a<=o?t.val(a):t.val(o+s):n&&n>=o?t.val(n):o>1&&t.val(o-s)}))})),jQuery((function(e){e(".woocommerce").on("change","input.qty",(function(){void 0!==timeout&&clearTimeout(timeout),timeout=setTimeout((function(){e("[name='update_cart']").trigger("click")}),500)}))}));const voornaam=document.getElementById("billing_first_name"),shipVoornaam=document.getElementById("shipping_first_name"),achternaam=document.getElementById("billing_last_name"),shipAchternaam=document.getElementById("shipping_last_name"),straat=document.getElementById("billing_address_1"),shipStraat=document.getElementById("shipping_address_1"),postcode=document.getElementById("billing_postcode"),shipPostcode=document.getElementById("shipping_postcode"),plaats=document.getElementById("billing_city"),shipPlaats=document.getElementById("shipping_city"),email=document.getElementById("billing_email"),phone=document.getElementById("billing_phone"),line=document.getElementById("tussen1-2"),errorMessage=document.getElementById("formValidation"),diffrentAdress=document.getElementById("ship-to-different-address-checkbox");var progress=12.5;line&&(line.style.width=progress+"%"),allInputs=[voornaam,achternaam,straat,postcode,plaats,email,phone],allInputs.forEach(checkInput);var proceed=!1;function checkInput(e){e&&(e.value&&(progress+=12.5,line.style.width=progress+"%",e.proceed=!0),e.addEventListener("change",(t=>{e.value&&!e.proceed?(progress+=12.5,line.style.width=progress+"%",e.proceed=!0):e.value&&e.proceed||(progress-=12.5,line.style.width=progress+"%",e.proceed=!1)})))}var shipVerder=!1;function nextStepCheckout(){var e=!0;if(shipVerder?shipVoornaam.value&&shipAchternaam.value&&shipStraat.value&&shipPostcode.value&&shipPlaats.value||(e=!1):voornaam.value&&achternaam.value&&straat.value&&postcode.value&&plaats.value&&email.value&&phone.value||(e=!1),e){var t=document.getElementById("checkout_step1"),o=document.getElementById("checkout_step2"),a=document.getElementById("stap1"),n=document.getElementById("stap2");document.getElementById("tussen1-2").style.width="100%",(n||a)&&(n.classList.add("active-class"),a.classList.add("done-class")),window.scrollTo(0,50),t.style.display="none",o.style.display="block",errorMessage.style.display="none"}else errorMessage.style.height="fit-content",errorMessage.style.opacity=1,errorMessage.style.marginBottom="40px",errorMessage.style.padding="5px 25px"}function productModal(e,t,o){var a=document.getElementById("productModal");document.getElementById("productModalInner");document.getElementById("imgWrapper").innerHTML='<a href="'+t+'"><img class="modalProductImage" src="'+o+'"/></a>',document.getElementById("productTitle").innerHTML=e,a.classList.add("modal__cart--active"),pageOverlay.classList.remove("page-overlay"),pageOverlay.classList.add("page-overlay--active")}function closeProductModal(){document.getElementById("productModal").classList.remove("modal__cart--active"),pageOverlay.classList.remove("page-overlay--active"),pageOverlay.classList.add("page-overlay")}function incVAT(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span");if(e){var t=(1.21*e.innerText.replace(/,/g,".")).toFixed(2).replace(".",",");document.getElementById("incVATprice").innerHTML=t}}function watchSelections(){var e=document.querySelectorAll(".variations select, .quantity input");e&&e.forEach((e=>{e.addEventListener("change",(function(){incVAT(),setTimeout(productTotal,600)}))}))}function productTotal(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span"),t=document.querySelector("#productTotals");if(e)var o=e.innerText;t&&(document.querySelector("#productTotals").innerHTML=o)}function incVATtime(){setTimeout(incVAT,500)}diffrentAdress&&diffrentAdress.addEventListener("change",(function(){shipVerder=!shipVerder})),setTimeout((function(){if(document.getElementById("priceWatch")){var e=document.querySelectorAll("select");e&&e.forEach((e=>{e.addEventListener("change",(function(){setTimeout(incVAT,500)}))})),window.addEventListener("click",(function(){setTimeout(incVAT,500)}))}}),600),window.addEventListener("load",(e=>{setTimeout(productTotal,100),setTimeout(incVAT,600);var t=document.querySelectorAll(".radio_button");t&&t.forEach((e=>{e.addEventListener("click",(function(){incVAT(),setTimeout((function(){productTotal(),watchSelections()}),1300)}),{once:!1})}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvb3Rlci5qcyIsIndvb2NvbW1lcmNlLmpzIl0sIm5hbWVzIjpbIm9wZW5Qb3B1cCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIm9wZW5GYXFDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsIm9uY2xpY2siLCJjb250YWlucyIsInJlbW92ZSIsImZhcUNvbnRhaW5lciIsImFkZCIsImNsb3NlUG9wdXAiLCJvcGVuU3BlY3MiLCJidG50ZXh0IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsInNldENvb2tpZSIsIm5hbWUiLCJ2YWx1ZSIsImRheXMiLCJleHBpcmVzIiwiZGF0ZSIsIkRhdGUiLCJzZXRUaW1lIiwiZ2V0VGltZSIsInRvVVRDU3RyaW5nIiwiY29va2llIiwiZ2V0Q29va2llIiwibmFtZUVRIiwiY2EiLCJzcGxpdCIsImMiLCJjaGFyQXQiLCJzdWJzdHJpbmciLCJpbmRleE9mIiwicG9wdXBDb29raWUiLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRUb0NhcnRCdXR0b24iLCJwcm9kdWN0SUQiLCJhZGRFdmVudExpc3RlbmVyIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwid2luZG93IiwiZ2V0SXRlbSIsIm1vZGFsSWRlbnRpZmllciIsInByb2R1Y3RNb2RhbFN0YW5kYXJkIiwicHJvZHVjdE1vZGFsQWR2YW5jZWQiLCJjbGVhciIsImNsb3NlUEFNIiwiZm9ybVByb2plY3RpbnJpY2h0aW5nIiwiZm9ybVN0ZXBCdG5OZXh0IiwiZm9ybVN0ZXBPbmUiLCJmb3JtU3RlcFR3byIsImZvcm1TdWJtaXQiLCJ3YWl0Rm9yRWxtIiwic2VsZWN0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm9ic2VydmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9ucyIsImRpc2Nvbm5lY3QiLCJvYnNlcnZlIiwiYm9keSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJ2YWxpZGF0ZU9wdG9ucyIsInBlcmZvcm1hbmNlIiwiZ2V0RW50cmllc0J5VHlwZSIsImZpbHRlciIsInJlc291cmNlIiwiYWFudGFsU3ViT3B0aWVzIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIm9wdGlvbnNDb3VudCIsImFhbnRhbFNlbGVjdGVkIiwic2luZ2xlIiwic3ViT3B0aWVzQ2hpbGRzIiwiY2hpbGRyZW4iLCJvcHRpb25PdXRlciIsInNpbmdsZU9wdGlvbiIsImFjdGl2ZUNsYXNzIiwib3B0aW9uTGkiLCJvcGFjaXR5IiwicG9pbnRlckV2ZW50cyIsImV2ZW50IiwidGhlbiIsImVsbSIsImxvYWRNb3JlQnV0dG9uQyIsInNldFRpbWVvdXQiLCJwcm9kdWN0U3VtbWFyeSIsInN1Yk1lbnUiLCJzdWJNZW51RGl2IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwidGltZW91dCIsInRvcDEiLCJib3R0b20iLCJkZXNjUHJlc3MiLCJkZXNjcmlwdGlvbiIsImFycm93IiwiZXh0cmFQcmVzcyIsImpRdWVyeSIsInJlYWR5IiwiJCIsIm9uIiwicXR5IiwidGhpcyIsImNsb3Nlc3QiLCJmaW5kIiwidmFsIiwicGFyc2VGbG9hdCIsIm1heCIsImF0dHIiLCJtaW4iLCJzdGVwIiwiaXMiLCJ1bmRlZmluZWQiLCJjbGVhclRpbWVvdXQiLCJ0cmlnZ2VyIiwidm9vcm5hYW0iLCJzaGlwVm9vcm5hYW0iLCJhY2h0ZXJuYWFtIiwic2hpcEFjaHRlcm5hYW0iLCJzdHJhYXQiLCJzaGlwU3RyYWF0IiwicG9zdGNvZGUiLCJzaGlwUG9zdGNvZGUiLCJwbGFhdHMiLCJzaGlwUGxhYXRzIiwiZW1haWwiLCJwaG9uZSIsImxpbmUiLCJlcnJvck1lc3NhZ2UiLCJkaWZmcmVudEFkcmVzcyIsInByb2dyZXNzIiwid2lkdGgiLCJhbGxJbnB1dHMiLCJmb3JFYWNoIiwiY2hlY2tJbnB1dCIsInByb2NlZWQiLCJzaGlwVmVyZGVyIiwibmV4dFN0ZXBDaGVja291dCIsInZlcmRlciIsInN0ZXAxX2NvbnRlbnQiLCJzdGVwMl9jb250ZW50IiwiYWZnZXJvbmQiLCJtZWVCZXppZyIsInNjcm9sbFRvIiwiaGVpZ2h0IiwibWFyZ2luQm90dG9tIiwicGFkZGluZyIsInByb2R1Y3RNb2RhbCIsInByb2R1Y3RUaXRsZSIsInByb2R1Y3RMaW5rIiwicHJvZHVjdEltZ1VybCIsInRoZU1vZGFsIiwicGFnZU92ZXJsYXkiLCJjbG9zZVByb2R1Y3RNb2RhbCIsImluY1ZBVCIsImlucHV0MSIsImZpbmFsUmVzdWx0IiwiaW5uZXJUZXh0IiwicmVwbGFjZSIsInRvRml4ZWQiLCJ3YXRjaFNlbGVjdGlvbnMiLCJkcm9wZG93blNlbGVjdGlvbnMiLCJlbGVtZW50IiwicHJvZHVjdFRvdGFsIiwiaW5wdXQiLCJwcm9kdWN0VG90YWxzIiwicmVzdWx0IiwiaW5jVkFUdGltZSIsInByb2R1Y3RTZWxlY3Rpb25zIiwic2VsZWN0aW9uIiwicmFkaW9CdXR0b25zIiwiYnV0dG9uIiwib25jZSJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsVUFBVUMsR0FDUEMsU0FBU0MsZUFBZUYsR0FDOUJHLFVBQVVDLE9BQU8sU0FDdkIsQ0FNQSxNQUFNQyxpQkFBbUJKLFNBQVNLLGlCQUFpQiwwQkFDbkQsSUFBSSxJQUFJQyxFQUFJLEVBQUdBLEVBQUlGLGlCQUFpQkcsT0FBUUQsSUFDeENGLGlCQUFpQkUsR0FBR0UsUUFBVSxXQUUxQixHQUQ2QkosaUJBQWlCRSxHQUFHSixVQUFVTyxTQUFTLFVBR2hFTCxpQkFBaUJFLEdBQUdKLFVBQVVRLE9BQU8sY0FDbEMsQ0FDSCxJQUFLLElBQUlDLEtBQWdCUCxpQkFDckJPLEVBQWFULFVBQVVRLE9BQU8sVUFFbENOLGlCQUFpQkUsR0FBR0osVUFBVVUsSUFBSSxTQUN0QyxDQUNKLEVBT0osU0FBU0MsV0FBV2QsR0FDUkMsU0FBU0MsZUFBZUYsR0FDOUJHLFVBQVVRLE9BQU8sU0FDdkIsQ0FFQSxTQUFTSSxVQUFVZixHQUNQQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVUMsT0FBTyxVQUVuQixJ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QSxlQUNMLElBQUlDLEVBQVE1SyxTQUFTZ0IsY0FBYyxxRkFDL0I2SixFQUFnQjdLLFNBQVNnQixjQUFjLGtCQUMzQyxHQUFJNEosRUFDQSxJQUFJRSxFQUFTRixFQUFNUCxVQUVuQlEsSUFDQTdLLFNBQVNnQixjQUFjLGtCQUFrQkMsVUFBWTZKLEVBRTdELENBZ0ZBLFNBQVNDLGFBQ0xwRixXQUFXdUUsT0FBUSxJQUN2QixDQXROSXpCLGdCQUNBQSxlQUFlL0YsaUJBQWlCLFVBQVUsV0FDdENzRyxZQUFjQSxVQUNsQixJQTZFSnJELFlBQVcsV0FFUCxHQURtQjNGLFNBQVNDLGVBQWUsY0FDekIsQ0FDZCxJQUFJK0ssRUFBb0JoTCxTQUFTSyxpQkFBaUIsVUFDOUMySyxHQUNBQSxFQUFrQm5DLFNBQVFvQyxJQUN0QkEsRUFBVXZJLGlCQUFpQixVQUFVLFdBQ2pDaUQsV0FBV3VFLE9BQVEsSUFDdkIsR0FBQyxJQUdUckgsT0FBT0gsaUJBQWlCLFNBQVMsV0FDN0JpRCxXQUFXdUUsT0FBUSxJQUN2QixHQUNKLENBQ0osR0FBRyxLQXdDSHJILE9BQU9ILGlCQUFpQixRQUFTNkMsSUFDN0JJLFdBQVdnRixhQUFjLEtBQ3pCaEYsV0FBV3VFLE9BQVEsS0FFbkIsSUFBSWdCLEVBQWVsTCxTQUFTSyxpQkFBaUIsaUJBRXpDNkssR0FDQUEsRUFBYXJDLFNBQVFzQyxJQUNqQkEsRUFBT3pJLGlCQUFpQixTQUFTLFdBQzdCd0gsU0FDQXZFLFlBQVcsV0FDUGdGLGVBQ0FILGlCQUNKLEdBQUcsS0FDUCxHQUFHLENBQ0NZLE1BQU0sR0FDVCxHQUVUIiwiZmlsZSI6ImZvb3Rlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBvcGVuUG9wdXAoaWQpIHtcbiAgICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBlLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIik7XG59XG5cblxuXG5cbi8vIG9wZW4gLyBjbG9zZSBmYXEgaXRlbXNcbmNvbnN0IG9wZW5GYXFDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmluZm9fX2ZhcSA+IC5mYXEtaXRlbVwiKTtcbmZvcihsZXQgaSA9IDA7IGkgPCBvcGVuRmFxQ29udGFpbmVyLmxlbmd0aDsgaSsrKXtcbiAgICBvcGVuRmFxQ29udGFpbmVyW2ldLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IGZhcUNvbnRhaW5lckhhc0NsYXNzID0gb3BlbkZhcUNvbnRhaW5lcltpXS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIik7XG4gICAgICAgIGlmKGZhcUNvbnRhaW5lckhhc0NsYXNzKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnaGFzIGNsYXNzJyk7XG4gICAgICAgICAgICBvcGVuRmFxQ29udGFpbmVyW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGxldCBmYXFDb250YWluZXIgb2Ygb3BlbkZhcUNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIGZhcUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3BlbkZhcUNvbnRhaW5lcltpXS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgICAgICB9O1xuICAgIH07XG59XG5cblxuXG5cblxuZnVuY3Rpb24gY2xvc2VQb3B1cChpZCkge1xuICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIGUuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbn1cblxuZnVuY3Rpb24gb3BlblNwZWNzKGlkKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xuICAgIFxuICAgIHZhciBidG50ZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzcGVjc1dyYXAgPiBkaXYubW9yZV9fc3BlY3NcIik7XG4gICAgaWYgKGJ0bnRleHQuaW5uZXJIVE1MID09PSBcIk1pbmRlciBzcGVjaWZpY2F0aWVzXCIpIHtcbiAgICAgICAgYnRudGV4dC5pbm5lckhUTUwgPSAnTWVlciBzcGVjaWZpY2F0aWVzJztcbiAgICB9IGVsc2Uge1xuICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdNaW5kZXIgc3BlY2lmaWNhdGllcyc7XG4gICAgfVxufVxuXG4vLyBmdW5jdGlvbiBvcGVuRmlsdGVycyhpZCkge1xuLy8gICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuLy8gICAgIGUuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiKTtcblxuLy8gICAgIHZhciBmaWx0ZXJEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2R1Y3QtY2F0ZWdvcnlfX2ZpbHRlcnNcIik7XG4vLyAgICAgdmFyIGZpbHRlclNWRyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9yZS1idG4gc3ZnXCIpO1xuLy8gICAgIGZpbHRlckRpdi5jbGFzc0xpc3QudG9nZ2xlKFwiLS1hY3RpdmVcIik7XG4vLyAgICAgZmlsdGVyU1ZHLmNsYXNzTGlzdC50b2dnbGUoXCJzdmctLWFjdGl2ZVwiKTtcbi8vICAgICB2YXIgYnRudGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9yZV9fc3BlY3NcIik7XG4vLyAgICAgaWYgKGJ0bnRleHQuaW5uZXJIVE1MID09PSBcIkZpbHRlcnMgdmVyYmVyZ2VuXCIpIHtcbi8vICAgICAgICAgYnRudGV4dC5pbm5lckhUTUwgPSAnRmlsdGVycyB3ZWVyZ2V2ZW4nO1xuXG4vLyAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgYnRudGV4dC5pbm5lckhUTUwgPSAnRmlsdGVycyB2ZXJiZXJnZW4nO1xuLy8gICAgIH1cbi8vIH1cblxuLy8gU2V0IENvb2tpZSBmb3IgcG9wdXBcbmZ1bmN0aW9uIHNldENvb2tpZShuYW1lLHZhbHVlLGRheXMpIHtcbiAgICB2YXIgZXhwaXJlcyA9IFwiXCI7XG4gICAgaWYgKGRheXMpIHtcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkgKyAoZGF5cyoxKjYwKjYwKjEwMDApKTtcbiAgICAgICAgZXhwaXJlcyA9IFwiOyBleHBpcmVzPVwiICsgZGF0ZS50b1VUQ1N0cmluZygpO1xuICAgIH1cbiAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgXCI9XCIgKyAodmFsdWUgfHwgXCJcIikgICsgZXhwaXJlcyArIFwiOyBwYXRoPS9cIjtcbn1cblxuLy8gU2V0IENvb2tpZSBmb3IgcG9wdXBcbmZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XG4gICAgdmFyIG5hbWVFUSA9IG5hbWUgKyBcIj1cIjtcbiAgICB2YXIgY2EgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcbiAgICBmb3IodmFyIGk9MDtpIDwgY2EubGVuZ3RoO2krKykge1xuICAgICAgICB2YXIgYyA9IGNhW2ldO1xuICAgICAgICB3aGlsZSAoYy5jaGFyQXQoMCk9PScgJykgYyA9IGMuc3Vic3RyaW5nKDEsYy5sZW5ndGgpO1xuICAgICAgICBpZiAoYy5pbmRleE9mKG5hbWVFUSkgPT0gMCkgcmV0dXJuIGMuc3Vic3RyaW5nKG5hbWVFUS5sZW5ndGgsYy5sZW5ndGgpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuLy8gSGlkZSBwb3B1cCBpZiBjb29raWUgaXMgc2V0XG52YXIgcG9wdXBDb29raWUgPSBnZXRDb29raWUoJ3BvcHVwQ29va2llJyk7XG5pZiAocG9wdXBDb29raWUpIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuLWktaGVscC1wb3B1cCcpLnN0eWxlLmRpc3BsYXk9XCJub25lXCJcbn1cbmVsc2Uge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW4taS1oZWxwLXBvcHVwJykuc3R5bGUuZGlzcGxheT1cImJsb2NrXCJcbn1cblxuLy8gU2V0IENvb2tpZSBvbiBwb3B1cCBjbG9zZVxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbi1pLWhlbHAtLWNsb3NlJykub25jbGljaz1mdW5jdGlvbigpe1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW4taS1oZWxwLXBvcHVwJykuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjtcbiAgICBzZXRDb29raWUoJ3BvcHVwQ29va2llJywncG9wdXBDb29raWV2YWx1ZScsNyk7XG59O1xuXG5cblxuLy8gUHJvZHVjdCBNb2RhbCBKU1xuY29uc3QgYWRkVG9DYXJ0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVfYnV0dG9uXCIpXG5jb25zdCBwcm9kdWN0SUQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZV9idXR0b24gPiBpbnB1dFt0eXBlPWhpZGRlbl1cIilcblxuaWYgKGFkZFRvQ2FydEJ1dHRvbikge1xuICAgIGFkZFRvQ2FydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwicHJvZHVjdElEXCIsIHByb2R1Y3RJRC52YWx1ZSk7XG4gICAgfSlcbn1cblxuaWYgKHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdwcm9kdWN0SUQnKSkge1xuICAgIGNvbnN0IG1vZGFsSWRlbnRpZmllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cC1hY2Nlc3NvaXJlcycpO1xuICAgIGNvbnN0IHByb2R1Y3RNb2RhbFN0YW5kYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RBZGRlZE1vZGFsU3RhbmRhcmQnKVxuICAgIGNvbnN0IHByb2R1Y3RNb2RhbEFkdmFuY2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RBZGRlZE1vZGFsQWR2YW5jZWQnKVxuXG4gICAgaWYgKCFtb2RhbElkZW50aWZpZXIpIHtcbiAgICAgICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIlxuICAgICAgICBwcm9kdWN0TW9kYWxTdGFuZGFyZC5jbGFzc0xpc3QuYWRkKFwiZmFkZS1pbi1ib3R0b21cIilcbiAgICB9IGVsc2Uge1xuICAgICAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiXG4gICAgICAgIHByb2R1Y3RNb2RhbEFkdmFuY2VkLmNsYXNzTGlzdC5hZGQoXCJmYWRlLWluLWJvdHRvbVwiKVxuICAgIH1cblxuICAgIHNlc3Npb25TdG9yYWdlLmNsZWFyKClcbn1cblxuZnVuY3Rpb24gY2xvc2VQQU0oKSB7XG4gICAgY29uc3QgcHJvZHVjdE1vZGFsU3RhbmRhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdEFkZGVkTW9kYWxTdGFuZGFyZCcpXG4gICAgY29uc3QgcHJvZHVjdE1vZGFsQWR2YW5jZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdEFkZGVkTW9kYWxBZHZhbmNlZCcpXG5cbiAgICBwcm9kdWN0TW9kYWxTdGFuZGFyZC5jbGFzc0xpc3QucmVtb3ZlKFwiZmFkZS1pbi1ib3R0b21cIilcbiAgICBwcm9kdWN0TW9kYWxTdGFuZGFyZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcblxuICAgIHByb2R1Y3RNb2RhbEFkdmFuY2VkLmNsYXNzTGlzdC5yZW1vdmUoXCJmYWRlLWluLWJvdHRvbVwiKVxuICAgIHByb2R1Y3RNb2RhbEFkdmFuY2VkLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuXG4gICAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKVxufVxuXG5cblxuXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKSB7XG4vLyAgICAgLy8gdmFyIHByaWNlU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZhY2V0d3Atc3VibWl0JykuaW5uZXJIVE1MO1xuLy8gICAgIC8vIHByaWNlU3VibWl0QnRuID0gXCJNeSBuZXcgdGV4dCFcIjtcbi8vICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZhY2V0d3Atc3VibWl0XCIpLmlubmVySFRNTCA9IFwiSSBoYXZlIGNoYW5nZWQhXCI7XG4vLyB9KTtcblxuXG5cbi8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKGV2ZW50KSA9PiB7XG4vLyAgICAgdmFyIHByb2R1Y3RPcHRpb25CdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImNvbXBvbmVudF9vcHRpb25fdGh1bWJuYWlsX3RhcFwiKTtcbi8vICAgICAvLyB2YXIgcHJvZHVjdE9wdGlvbkJ0bnNBcnJheSA9IFsuLi5wcm9kdWN0T3B0aW9uQnRuc107XG4vLyAgICAgdmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVwcmljZV93cmFwcGVyID4gZGl2LmNvbXBvc2l0ZV9wcmljZSA+IHAgc3BhblwiKTtcblxuXHRcbi8vIFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHByb2R1Y3RPcHRpb25CdG5zLmxlbmd0aDsgKytpKSB7XG4vLyBcdFx0XHQvLyBwcm9kdWN0T3B0aW9uQnRuW2ldLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7IFxuLy8gICAgICAgICAgICAgcHJvZHVjdE9wdGlvbkJ0bnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuLy8gICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4vLyAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0LmlubmVyVGV4dDtcbi8vICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0Zml4ID0gcmVzdWx0LnJlcGxhY2UoLywvZywgJy4nKTtcbi8vICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuLy8gICAgICAgICAgICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4vLyAgICAgICAgICAgICAgICAgaWYocmVzdWx0KSB7XG4vLyAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5jVkFUcHJpY2VcIikuaW5uZXJIVE1MID0gZmluYWxSZXN1bHQ7XG4vLyAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG5zW2ldKTtcbi8vICAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocHJvZHVjdE9wdGlvbkJ0bnNbaV0pO1xuLy8gICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgIH1cblxuLy8gICAgIH0pO1xuICAgIC8vIGZvciAobGV0IHByb2R1Y3RPcHRpb25CdG4gb2YgcHJvZHVjdE9wdGlvbkJ0bnNBcnJheSkge1xuICAgIC8vICAgICBwcm9kdWN0T3B0aW9uQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAvLyAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy8gICAgICAgICB2YXIgcmVzdWx0ID0gaW5wdXQuaW5uZXJUZXh0O1xuICAgIC8vICAgICAgICAgdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4gICAgLy8gICAgICAgICB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuICAgIC8vICAgICAgICAgdmFyIGZpbmFsUmVzdWx0ID0gcmVzdWx0Y2FsYy5yZXBsYWNlKCcuJywgJywnKTtcbiAgICAvLyAgICAgICAgIGlmKHJlc3VsdCkge1xuICAgIC8vICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5jVkFUcHJpY2VcIikuaW5uZXJIVE1MID0gZmluYWxSZXN1bHQ7XG4gICAgLy8gICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvZHVjdE9wdGlvbkJ0bik7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhwcm9kdWN0T3B0aW9uQnRuKTtcbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCdwcm9kdWN0T3B0aW9uQnRuJyk7XG4gICAgLy8gICAgIH0pO1xuICBcbiAgICAvLyB9XG4gICAgLy8gY29uc29sZS5sb2cocHJvZHVjdE9wdGlvbkJ0bnNBcnJheSk7ICBcblxuXG4vLyBGb3JtIHByb2plY3RpbnJpY2h0aW5nIG11bHRpc3RlcFxuY29uc3QgZm9ybVByb2plY3RpbnJpY2h0aW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndwY2Y3LWZvcm0nKTtcbmNvbnN0IGZvcm1TdGVwQnRuTmV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGVwX19idXR0b24tbmV4dCcpO1xuY29uc3QgZm9ybVN0ZXBPbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3RlcF9fb25lJyk7XG5jb25zdCBmb3JtU3RlcFR3byA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdGVwX190d28nKTtcbmNvbnN0IGZvcm1TdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3BjZjctc3VibWl0Jyk7XG4vLyBmb3JtU3RlcFR3by5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbi8vIG9ic2VydmVyIGZvciB3YWl0aW5nIGNsYXNzIHRvIGV4aXN0XG5mdW5jdGlvbiB3YWl0Rm9yRWxtKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25zID0+IHtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpO1xuICAgICAgICAgICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7XG4gICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG4vLyBzaG93IC8gaGlkZSBtdWx0aXN0ZXAgZm9ybVxuaWYoZm9ybVByb2plY3RpbnJpY2h0aW5nKXtcbiAgICBmb3JtU3RlcEJ0bk5leHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZm9ybVN0ZXBPbmUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICBmb3JtU3RlcFR3by5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIH0pO1xuICAgIFxuICAgIGZvcm1TdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcblxuXG4gICAgICAgIHdhaXRGb3JFbG0oJy5pbnZhbGlkJykudGhlbigoZWxtKSA9PiB7XG4gICAgICAgICAgICBmb3JtU3RlcE9uZS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAgICAgZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICAgIGZvcm1TdGVwQnRuTmV4dC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcbiAgICAgICAgfSk7XG5cblxuXG4gICAgICAgIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gICAgIGNvbnN0IGZvcm1IYXNDbGFzc0ludmFsaWQgPSBmb3JtUHJvamVjdGlucmljaHRpbmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdpbnZhbGlkJyk7XG4gICAgICAgIC8vICAgICBpZihmb3JtSGFzQ2xhc3NJbnZhbGlkKSB7XG4gICAgICAgIC8vICAgICAgICAgZm9ybVN0ZXBPbmUuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgLy8gICAgICAgICBmb3JtU3RlcFR3by5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAvLyAgICAgICAgIGZvcm1TdGVwQnRuTmV4dC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcbiAgICAgICAgLy8gICAgIH07XG4gICAgICAgIC8vIH0sIDI1MDApO1xuICAgIH0pO1xufTtcblxuXG5cblxuLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuLy8gICAgIC8vIHZhciBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYWNldHdwLXN1Ym1pdCcpO1xuLy8gICAgIHZhciBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXJzX19wcmljZScpO1xuLy8gICAgIHZhciB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIFxuLy8gICAgIGVsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHdyYXBwZXIsIGVsKTtcbi8vICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGVsKTtcbi8vIH0sIGZhbHNlKTtcblxuXG4vLyBjb25zdCBjb21wb25lbnRTZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21wb25lbnRfb3B0aW9uX3RodW1ibmFpbCcpO1xuLy8gY29uc3QgY29tcG9uZW50U2VsZWN0ZWRDbGFzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWxlY3RlZCcpO1xuLy8gY29uc3QgY29tcG9zaXRlQWRkVG9DYXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXBvc2l0ZV9hZGRfdG9fY2FydF9idXR0b24nKTtcbi8vIC8vIGNvbXBvc2l0ZUFkZFRvQ2FydC5zZXRBdHRyaWJ1dGUoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIik7XG4vLyBpZihjb21wb25lbnRTZWxlY3RlZC5jbGFzc0xpc3QuY29udGFpbnMoY29tcG9uZW50U2VsZWN0ZWRDbGFzcykgKSB7XG4vLyAgICAgY29uc29sZS5sb2coJ3Rlc3QnKTtcblxuLy8gfVxuXG5cblxuLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKXtcbiAgICAvLyBsZXQgbmV4dEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXh0QnRuJyk7XG4gICAgLy8gbGV0IHByZXZCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldkJ0bicpO1xuICAgIC8vIGxldCBlbGVtZW50SW5kZXggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWxlbWVudF9pbmRleCcpO1xuICAgIC8vIGlmKG5leHRCdG4pIHtcbiAgICAvLyAgICAgbmV4dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAvLyAgICAgICAgIHZhciBjb21wb3NpdGVQYWdpbmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVsZW1lbnRfaW5kZXgnKTtcbiAgICAvLyAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBjb21wb3NpdGVQYWdpbmF0aW9uLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAgICAgICAgICAgY29uc29sZS5sb2coY29tcG9zaXRlUGFnaW5hdGlvbik7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH0pO1xuICAgIC8vIH1cblxuXG5cbi8vIH0pO1xuXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7XG5cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJkaXYuY29tcG9uZW50X2lubmVyID4gZGl2LmNvbXBvbmVudF9zZWxlY3Rpb25zID4gZGl2LmNvbXBvbmVudF9jb250ZW50ID4gLmNvbXBvbmVudF9zdW1tYXJ5ID4gLnByb2R1Y3RcIilcblxuICAgIHZhbGlkYXRlT3B0b25zKCk7XG4gICAgLy8gbGlzdGVuZXIgZm9yIG9uY2xpY2sgb2ZcblxuICAgIHZhciBsb2FkTW9yZUJ1dHRvbkMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb21wb25lbnRfb3B0aW9uc19sb2FkX21vcmUnKVxuXG4gICAgaWYgKGxvYWRNb3JlQnV0dG9uQ1swXSkge1xuICAgICAgICBsb2FkTW9yZUJ1dHRvbkNbMF0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlT3B0b25zKCk7XG4gICAgICAgICAgICB9LCAyMDAwKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHZhciBwcm9kdWN0U3VtbWFyeSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Byb2R1Y3Rfc3VtbWFyeScpXG4gICAgaWYgKHByb2R1Y3RTdW1tYXJ5WzBdKSB7XG4gICAgICAgIHByb2R1Y3RTdW1tYXJ5WzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB2YWxpZGF0ZU9wdG9ucygpO1xuICAgICAgICB9KVxuICAgIH1cblxuXG5cblxuICAgIC8vIGJsdXJyeSBiYWNrZ3JvdW5kIG9uIG1lbnUgaG92ZXJcbiAgICAvLyB2YXIgbWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21lbnUtd2Vic2hvcC0xID4gbGknKTtcbiAgICAvLyBmb3IobGV0IGkgPSAwOyBpID0gbWVudUl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAgIG1lbnVJdGVtc1tpXS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoZXZlbnQpID0+IHtcblxuICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJ3Rlc3QnKTtcbiAgICAgICAgXG5cbiAgICAvLyAgICAgfSwgZmFsc2UpO1xuICAgIC8vIH1cblxuXG5cblxufSlcblxuXG5cblxuXG4vLyAvLyBvdmVybGF5IGFjdGl2ZSBvbiBtb3VzZSBob3ZlciBtZW51IGl0ZW1zXG4vLyBjb25zdCBtZW51SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudSAubWVudS1pdGVtJyk7XG4vLyBtZW51SXRlbXMuZm9yRWFjaChmID0+IGYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGZ1bmN0aW9uKCkge1xuLy8gICAgIG1lbnVJdGVtcy5mb3JFYWNoKGUgPT4ge1xuLy8gICAgICAgICBjb25zdCBvdmVybGF5QWN0aXZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2Utb3ZlcmxheScpXG4vLyAgICAgICAgIG92ZXJsYXlBY3RpdmUuY2xhc3NMaXN0LmFkZCgncGFnZS1vdmVybGF5LS1hY3RpdmUnKTtcbi8vICAgICAvLyBjb25zdCBib2R5RWxlbWVudCA9IGRvY3VtZW50LmJvZHk7XG4vLyAgICAgLy8gYm9keUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIi0tbWVudS1ob3ZlclwiKTtcbi8vICAgfSlcbi8vIH0pKTtcbi8vIG1lbnVJdGVtcy5mb3JFYWNoKGYgPT4gZi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uKCkge1xuLy8gICAgIG1lbnVJdGVtcy5mb3JFYWNoKGUgPT4ge1xuLy8gICAgIC8vIGNvbnN0IGJvZHlFbGVtZW50ID0gZG9jdW1lbnQuYm9keTtcbi8vICAgICAvLyBib2R5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiLS1tZW51LWhvdmVyXCIpO1xuLy8gICAgIGNvbnN0IG92ZXJsYXlBY3RpdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZS1vdmVybGF5Jylcbi8vICAgICBvdmVybGF5QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ3BhZ2Utb3ZlcmxheS0tYWN0aXZlJyk7XG4vLyAgIH0pXG4vLyB9KSk7XG5cblxuXG4vLyBhcHBlbmQgY2xhc3MgdG8gc3ViLW1lbnVcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3ViTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdWItbWVudScpXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHN1Yk1lbnUubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgc3ViTWVudURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgc3ViTWVudURpdi5jbGFzc05hbWUgPSBcInN1Yi1tZW51X19vdmVybGF5XCI7XG4gICAgICAgIHN1Yk1lbnVbaV0uYXBwZW5kQ2hpbGQoc3ViTWVudURpdilcbiAgICB9XG59LCBmYWxzZSk7XG5cblxuZnVuY3Rpb24gdmFsaWRhdGVPcHRvbnMoKSB7XG5cbiAgICBwZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwicmVzb3VyY2VcIilcblxuICAgIGNvbnN0IHJlc291cmNlcyA9IHBlcmZvcm1hbmNlLmdldEVudHJpZXNCeVR5cGUoXCJyZXNvdXJjZVwiKTtcblxuICAgIHJlc291cmNlcy5maWx0ZXIocmVzb3VyY2UgPT4gcmVzb3VyY2UubmFtZSA9PSBcIlJlY3RhbmdsZS1Db3B5LTE0LnBuZ1wiKVxuXG4gICAgdmFyIGFhbnRhbFN1Yk9wdGllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NvbXBvbmVudF9vcHRpb25fdGh1bWJuYWlscycpO1xuXG5cbiAgICBjb25zdCBhZGRUb0NhcnRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2ID4gZGl2LmNvbXBvc2l0ZV9idXR0b24gPiAuc2luZ2xlX2FkZF90b19jYXJ0X2J1dHRvblwiKVxuXG4gICAgdmFyIG9wdGlvbnNDb3VudCA9IDA7XG4gICAgdmFyIGFhbnRhbFNlbGVjdGVkID0gMDtcblxuICAgIGZvciAobGV0IHNpbmdsZSBvZiBhYW50YWxTdWJPcHRpZXMpIHtcbiAgICAgICAgbGV0IHN1Yk9wdGllc0NoaWxkcyA9IHNpbmdsZS5jaGlsZHJlbjtcblxuICAgICAgICBvcHRpb25zQ291bnQgPSBvcHRpb25zQ291bnQgKyAxO1xuXG4gICAgICAgIGZvciAobGV0IG9wdGlvbk91dGVyIG9mIHN1Yk9wdGllc0NoaWxkcykge1xuICAgICAgICAgICAgbGV0IHNpbmdsZU9wdGlvbiA9IG9wdGlvbk91dGVyLmNoaWxkcmVuO1xuICAgICAgICAgICAgdmFyIGdsb2JhbENvdW50ID0gMDtcbiAgICAgICAgICAgIHZhciBhY3RpdmVDbGFzcyA9IDA7XG5cbiAgICAgICAgICAgIGZvciAobGV0IG9wdGlvbkxpIG9mIHNpbmdsZU9wdGlvbikge1xuICAgICAgICAgICAgICAgIGdsb2JhbENvdW50ID0gZ2xvYmFsQ291bnQgKyAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbkxpLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVDbGFzcyA9IGFjdGl2ZUNsYXNzICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWN0aXZlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBhYW50YWxTZWxlY3RlZCA9IGFhbnRhbFNlbGVjdGVkICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIG9ubHkgY2hhbmdlIHN0eWxpbmcgb2YgdGhlIGFkZCB0byBjYXJ0IGJ1dHRvbiB3aGVuIHRoZXJlIGFyZSBtdWNoIHNlbGVjdGVkIGJveGVzIGFzIHJvd3Mgb2Ygb3B0aW9uc1xuICAgIGlmIChhZGRUb0NhcnRCdXR0b24pIHtcbiAgICAgICAgaWYgKGFhbnRhbFNlbGVjdGVkID09PSBvcHRpb25zQ291bnQpIHtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhbGxcIlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkVG9DYXJ0QnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAuNjtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCJcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5cblxuXG4vLyBjb25zdCB3ZWJzaG9wTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51LXdlYnNob3AtY29udGFpbmVyID4gLm1lbnUtaXRlbScpXG4vLyBjb25zdCBcblxuLy8gZm9yKGxldCBpID0gMDsgaSA8IHdlYnNob3BNZW51Lmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgd2Vic2hvcE1lbnVbaV0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24oIGV2ZW50ICkgeyAgIFxuLy8gICAgICAgICBldmVudC50YXJnZXQuc3R5bGUuY29sb3IgPSBcInB1cnBsZVwiO1xuXG4vLyAgICAgICB9LCBmYWxzZSk7XG4vLyB9XG5cblxuXG4iLCJ2YXIgdG9wMSA9IGZhbHNlXG52YXIgYm90dG9tID0gZmFsc2VcblxuZnVuY3Rpb24gZGVzY1ByZXNzKCkge1xuICAgIHZhciBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXNjcmlwdGlvbicpO1xuICAgIHZhciBhcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFiX2luZm9cIik7XG4gICAgdG9wMSA9ICF0b3AxXG5cbiAgICBpZiAodG9wMSkge1xuICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKFwic2hvd0Rlc2NcIik7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5hZGQoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhcnJvdy5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlQXJyb3dcIik7XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93RGVzY1wiKVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZXh0cmFQcmVzcygpIHtcbiAgICB2YXIgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkaXRpb25hbCcpO1xuICAgIHZhciBhcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFiX2luZm86bnRoLWNoaWxkKDIpXCIpO1xuICAgIGJvdHRvbSA9ICFib3R0b207XG5cbiAgICBpZiAoYm90dG9tKSB7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5hZGQoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInNob3dEZXNjXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFycm93LmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVBcnJvd1wiKTtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LnJlbW92ZShcInNob3dEZXNjXCIpO1xuICAgIH1cbn1cblxuLy8gTWludXMgYW5kIFBsdXMgYnV0dG9ucyBxdWFudGl0eVxuXG5qUXVlcnkoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCQpe1xuXG4gICAgJCgnZm9ybS5jYXJ0Jykub24oICdjbGljaycsICdidXR0b24ucGx1cywgYnV0dG9uLm1pbnVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAvLyBHZXQgY3VycmVudCBxdWFudGl0eSB2YWx1ZXNcbiAgICB2YXIgcXR5ID0gJCggdGhpcyApLmNsb3Nlc3QoICdmb3JtLmNhcnQnICkuZmluZCggJy5xdHknICk7XG4gICAgdmFyIHZhbCAgID0gcGFyc2VGbG9hdChxdHkudmFsKCkpO1xuICAgIHZhciBtYXggPSBwYXJzZUZsb2F0KHF0eS5hdHRyKCAnbWF4JyApKTtcbiAgICB2YXIgbWluID0gcGFyc2VGbG9hdChxdHkuYXR0ciggJ21pbicgKSk7XG4gICAgdmFyIHN0ZXAgPSBwYXJzZUZsb2F0KHF0eS5hdHRyKCAnc3RlcCcgKSk7XG5cbiAgICAvLyBDaGFuZ2UgdGhlIHZhbHVlIGlmIHBsdXMgb3IgbWludXNcbiAgICBpZiAoICQoIHRoaXMgKS5pcyggJy5wbHVzJyApICkge1xuICAgICAgIGlmICggbWF4ICYmICggbWF4IDw9IHZhbCApICkge1xuICAgICAgICAgIHF0eS52YWwoIG1heCApO1xuICAgICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICBxdHkudmFsKCB2YWwgKyBzdGVwICk7XG4gICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgIGlmICggbWluICYmICggbWluID49IHZhbCApICkge1xuICAgICAgICAgIHF0eS52YWwoIG1pbiApO1xuICAgICAgIH1cbiAgICAgICBlbHNlIGlmICggdmFsID4gMSApIHtcbiAgICAgICAgICBxdHkudmFsKCB2YWwgLSBzdGVwICk7XG4gICAgICAgfVxuICAgIH1cblxuIH0pO1xuXG59KTtcblxuXG4vLyBBamF4IHF1YW50aXR5IGFkZFxuXG52YXIgdGltZW91dDtcblxualF1ZXJ5KCBmdW5jdGlvbiggJCApIHtcblx0JCgnLndvb2NvbW1lcmNlJykub24oJ2NoYW5nZScsICdpbnB1dC5xdHknLCBmdW5jdGlvbigpe1xuXG5cdFx0aWYgKCB0aW1lb3V0ICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcblx0XHR9XG5cblx0XHR0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdCQoXCJbbmFtZT0ndXBkYXRlX2NhcnQnXVwiKS50cmlnZ2VyKFwiY2xpY2tcIik7XG5cdFx0fSwgNTAwICk7IC8vIDAuNSBzZWNvbmQgZGVsYXlcblxuXHR9ICk7XG59ICk7XG5cblxuLy8gZ2V0dGluZyBhbGwgaW5wdXQgZmllbGRzICYgcHJvZ3Jlc3MgbGluZVxuY29uc3Qgdm9vcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19maXJzdF9uYW1lJylcbmNvbnN0IHNoaXBWb29ybmFhbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19maXJzdF9uYW1lJylcbmNvbnN0IGFjaHRlcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19sYXN0X25hbWUnKVxuY29uc3Qgc2hpcEFjaHRlcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfbGFzdF9uYW1lJylcbmNvbnN0IHN0cmFhdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2FkZHJlc3NfMScpXG5jb25zdCBzaGlwU3RyYWF0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXBwaW5nX2FkZHJlc3NfMScpXG5jb25zdCBwb3N0Y29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX3Bvc3Rjb2RlJylcbmNvbnN0IHNoaXBQb3N0Y29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19wb3N0Y29kZScpXG5jb25zdCBwbGFhdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19jaXR5JylcbmNvbnN0IHNoaXBQbGFhdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfY2l0eScpXG5jb25zdCBlbWFpbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX2VtYWlsJylcbmNvbnN0IHBob25lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfcGhvbmUnKVxuY29uc3QgbGluZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXNzZW4xLTInKTtcbmNvbnN0IGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtVmFsaWRhdGlvbicpO1xuY29uc3QgZGlmZnJlbnRBZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcC10by1kaWZmZXJlbnQtYWRkcmVzcy1jaGVja2JveCcpO1xuXG5cblxudmFyIHByb2dyZXNzID0gMTIuNTtcbmlmIChsaW5lKSB7XG4gICAgbGluZS5zdHlsZS53aWR0aCA9IHByb2dyZXNzICsgXCIlXCI7XG59XG5cbi8vIHB1dHRpbmcgdGhlIGlucHV0cyBpbiBhbiBhcnJheVxuYWxsSW5wdXRzID0gW3Zvb3JuYWFtLCBhY2h0ZXJuYWFtLCBzdHJhYXQsIHBvc3Rjb2RlLCBwbGFhdHMsIGVtYWlsLCBwaG9uZV1cblxuYWxsSW5wdXRzLmZvckVhY2goY2hlY2tJbnB1dCk7XG52YXIgcHJvY2VlZCA9IGZhbHNlO1xuXG5cbmZ1bmN0aW9uIGNoZWNrSW5wdXQodmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlLnZhbHVlKSB7XG4gICAgICAgICAgICBwcm9ncmVzcyA9IHByb2dyZXNzICsgMTIuNTtcbiAgICAgICAgICAgIGxpbmUuc3R5bGUud2lkdGggPSBwcm9ncmVzcyArIFwiJVwiO1xuICAgICAgICAgICAgdmFsdWUucHJvY2VlZCA9IHRydWU7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHZhbHVlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldmVudCkgPT4ge1xuXG4gICAgICAgICAgICBpZiAodmFsdWUudmFsdWUgJiYgIXZhbHVlLnByb2NlZWQpIHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHByb2dyZXNzICsgMTIuNTtcbiAgICAgICAgICAgICAgICBsaW5lLnN0eWxlLndpZHRoID0gcHJvZ3Jlc3MgKyBcIiVcIjtcbiAgICAgICAgICAgICAgICB2YWx1ZS5wcm9jZWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZih2YWx1ZS52YWx1ZSAmJiB2YWx1ZS5wcm9jZWVkKSB7XG4gICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHByb2dyZXNzIC0xMi41O1xuICAgICAgICAgICAgICAgIGxpbmUuc3R5bGUud2lkdGggPSBwcm9ncmVzcyArIFwiJVwiO1xuICAgICAgICAgICAgICAgIHZhbHVlLnByb2NlZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxudmFyIHNoaXBWZXJkZXIgPSBmYWxzZTtcbmlmIChkaWZmcmVudEFkcmVzcykge1xuICAgIGRpZmZyZW50QWRyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBzaGlwVmVyZGVyID0gIXNoaXBWZXJkZXI7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gbmV4dFN0ZXBDaGVja291dCgpIHtcbiAgICB2YXIgdmVyZGVyID0gdHJ1ZTtcbiAgICBpZiAoc2hpcFZlcmRlcikge1xuICAgICAgICBpZiAoIXNoaXBWb29ybmFhbS52YWx1ZSB8fCAhc2hpcEFjaHRlcm5hYW0udmFsdWUgfHwgIXNoaXBTdHJhYXQudmFsdWUgfHwgIXNoaXBQb3N0Y29kZS52YWx1ZSB8fCAhc2hpcFBsYWF0cy52YWx1ZSkge1xuICAgICAgICAgICAgdmVyZGVyID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCF2b29ybmFhbS52YWx1ZSB8fCAhYWNodGVybmFhbS52YWx1ZSB8fCAhc3RyYWF0LnZhbHVlIHx8ICFwb3N0Y29kZS52YWx1ZSB8fCAhcGxhYXRzLnZhbHVlIHx8ICFlbWFpbC52YWx1ZSB8fCAhcGhvbmUudmFsdWUpIHtcbiAgICAgICAgdmVyZGVyID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHZlcmRlcikge1xuICAgICAgICB2YXIgc3RlcDFfY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hlY2tvdXRfc3RlcDFcIik7XG4gICAgICAgIHZhciBzdGVwMl9jb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGVja291dF9zdGVwMlwiKTtcblxuICAgICAgICB2YXIgYWZnZXJvbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXAxXCIpO1xuICAgICAgICB2YXIgbWVlQmV6aWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXAyXCIpO1xuXG4gICAgICAgIHZhciBsaWpuMV8yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0dXNzZW4xLTJcIik7XG5cbiAgICAgICAgbGlqbjFfMi5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuICAgICAgICBpZiAobWVlQmV6aWcgfHwgYWZnZXJvbmQpIHtcbiAgICAgICAgICAgIG1lZUJlemlnLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtY2xhc3NcIik7XG4gICAgICAgICAgICBhZmdlcm9uZC5jbGFzc0xpc3QuYWRkKFwiZG9uZS1jbGFzc1wiKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDUwKTtcblxuICAgICAgICBzdGVwMV9jb250ZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgc3RlcDJfY29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5oZWlnaHQgPSBcImZpdC1jb250ZW50XCI7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiNDBweFwiO1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUucGFkZGluZyA9IFwiNXB4IDI1cHhcIjtcbiAgICB9XG59XG5cblxuXG5cbi8vIE9wZW4gcHJvZHVjdCBtb2RhbFxuZnVuY3Rpb24gcHJvZHVjdE1vZGFsKHByb2R1Y3RUaXRsZSwgcHJvZHVjdExpbmssIHByb2R1Y3RJbWdVcmwpIHtcbiAgICAvLyBnZXRzIGlubmVyIGFuZCBvdXRlciBtb2RhbHNcbiAgICB2YXIgdGhlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RNb2RhbFwiKTtcbiAgICB2YXIgdGhlTW9kYWxJbm5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZHVjdE1vZGFsSW5uZXJcIik7XG5cbiAgICAvLyBjaGFuZ2VzIHRoZSBodG1sIHdpdGggdGhlIG5ldyBwYXJhbWV0ZXIgZGF0YSBpbnNpZGUgb2YgaXRcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1nV3JhcHBlcicpLmlubmVySFRNTCA9ICc8YSBocmVmPVwiJyArIHByb2R1Y3RMaW5rICsgJ1wiPjxpbWcgY2xhc3M9XCJtb2RhbFByb2R1Y3RJbWFnZVwiIHNyYz1cIicgKyBwcm9kdWN0SW1nVXJsICsgJ1wiLz48L2E+JztcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RUaXRsZVwiKS5pbm5lckhUTUwgPSBwcm9kdWN0VGl0bGU7XG5cbiAgICAvLyBhZGRzIHRoZSBhY3RpdmUgY2xhc3MgdG8gdGhlIG1vZGFsXG4gICAgdGhlTW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWxfX2NhcnQtLWFjdGl2ZScpO1xuICAgIC8vIHRoZU1vZGFsSW5uZXIuY2xhc3NMaXN0LmFkZCgncHJvZHVjdF9tb2RhbC1hbmltYXRpb24nKTtcblxuICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJwYWdlLW92ZXJsYXlcIik7XG4gICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LmFkZChcInBhZ2Utb3ZlcmxheS0tYWN0aXZlXCIpO1xufVxuXG4vLyBDbG9zZSBwcm9kdWN0IG1vZGFsXG5mdW5jdGlvbiBjbG9zZVByb2R1Y3RNb2RhbCgpIHtcbiAgICAvLyBncmFicyBtb2RhbCBieSB0aGUgaWQgYW5kIHRoZW4gcmVtb3ZlIHRoZSBhY3RpdmUgY2xhc3NcbiAgICB2YXIgdGhlTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RNb2RhbFwiKTtcbiAgICB0aGVNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9fY2FydC0tYWN0aXZlJyk7XG5cbiAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwicGFnZS1vdmVybGF5LS1hY3RpdmVcIik7XG4gICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LmFkZChcInBhZ2Utb3ZlcmxheVwiKTtcbn1cblxuXG4vLyBBZGQgaW5jVkFUIHByaWNlIHRoYXQgY2hhbmdlcyB3aXRoIHRoZSBjb21wb3NpdGUgcHJpY2VcblxuLy8gQkVHSU4gbGlzdGVuZXJzIHRvIHByaWNlXG5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcHJvZHVjdFByaWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByaWNlV2F0Y2gnKVxuICAgIGlmIChwcm9kdWN0UHJpY2UpIHtcbiAgICAgICAgdmFyIHByb2R1Y3RTZWxlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JylcbiAgICAgICAgaWYgKHByb2R1Y3RTZWxlY3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9kdWN0U2VsZWN0aW9ucy5mb3JFYWNoKHNlbGVjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChpbmNWQVQsIDUwMCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2V0VGltZW91dChpbmNWQVQsIDUwMCk7XG4gICAgICAgIH0pXG4gICAgfVxufSwgNjAwKTtcblxuLy8gU2hvdyBpbmNWQVQgcHJpY2UgZm9yIHByb2R1Y3RcbmZ1bmN0aW9uIGluY1ZBVCgpIHtcbiAgICB2YXIgaW5wdXQxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVwcmljZV93cmFwcGVyID4gZGl2LmNvbXBvc2l0ZV9wcmljZSA+IHAgc3BhblwiKTtcblxuICAgIGlmIChpbnB1dDEpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0MS5pbm5lclRleHQ7XG4gICAgICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuICAgICAgICB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuICAgICAgICB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gd2F0Y2hTZWxlY3Rpb25zKCkge1xuICAgIHZhciBkcm9wZG93blNlbGVjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudmFyaWF0aW9ucyBzZWxlY3QsIC5xdWFudGl0eSBpbnB1dCcpXG4gICAgaWYgKGRyb3Bkb3duU2VsZWN0aW9ucykge1xuICAgICAgICBkcm9wZG93blNlbGVjdGlvbnMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGluY1ZBVCgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocHJvZHVjdFRvdGFsLCA2MDApXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuLy8gU2hvdyB0b3RhbCBwcmljZSBmb3IgYWNjZXNzb2lyZXNcbmZ1bmN0aW9uIHByb2R1Y3RUb3RhbCgpIHtcbiAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZXByaWNlX3dyYXBwZXIgPiBkaXYuY29tcG9zaXRlX3ByaWNlID4gcCBzcGFuXCIpO1xuICAgIHZhciBwcm9kdWN0VG90YWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9kdWN0VG90YWxzXCIpO1xuICAgIGlmIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gaW5wdXQuaW5uZXJUZXh0O1xuICAgIH1cbiAgICBpZiAocHJvZHVjdFRvdGFscykge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2R1Y3RUb3RhbHNcIikuaW5uZXJIVE1MID0gcmVzdWx0O1xuICAgIH1cbn1cblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIChldmVudCkgPT4ge1xuICAgIHNldFRpbWVvdXQocHJvZHVjdFRvdGFsLCAxMDApO1xuICAgIHNldFRpbWVvdXQoaW5jVkFULCA2MDApO1xuXG4gICAgdmFyIHJhZGlvQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yYWRpb19idXR0b24nKTtcblxuICAgIGlmIChyYWRpb0J1dHRvbnMpIHtcbiAgICAgICAgcmFkaW9CdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpbmNWQVQoKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdFRvdGFsKClcbiAgICAgICAgICAgICAgICAgICAgd2F0Y2hTZWxlY3Rpb25zKClcbiAgICAgICAgICAgICAgICB9LCAxMzAwKVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG9uY2U6IGZhbHNlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbn0pO1xuXG5cbi8vIGFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4vLyAgICAgdmFyIHByaWNlT2ZmZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndvb2NvbW1lcmNlLVByaWNlLWFtb3VudFwiKTtcbi8vICAgICBpZihwcmljZU9mZmVyKSB7XG4vLyAgICAgICAgIHZhciByZXN1bHQgPSBwcmljZU9mZmVyLmlubmVyVGV4dDtcbi8vICAgICAgICAgdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4vLyAgICAgICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4vLyAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2FsZS1hbW91bnRfX3JlZ3VsYXItcHJpY2UgYmRpXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0ICsgXCIgXCI7XG4vLyAgICAgfVxuLy8gfSk7XG5cblxuXG5cbi8vIGFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4vLyAgICAgbGV0IGNvbXBvbmVudFRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29tcG9uZW50X29wdGlvbl90aHVtYm5haWwnKTtcbi8vICAgICBjb25zb2xlLmxvZygnbG9hZGVkJyk7XG4vLyAgICAgZm9yKGxldCBpID0gMDsgaSA8IGNvbXBvbmVudFRpbGUubGVuZ3RoOyBpKyspe1xuXG5cbi8vICAgICAgICAgY29tcG9uZW50VGlsZVtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsaWNrZWQnKTtcbi8vICAgICAgICAgfSk7XG5cblxuXG4vLyAgICAgICAgICAgICAvLyBsZXQgcHJpY2VJbmNsVmF0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvb2NvbW1lcmNlLVByaWNlLWFtb3VudCcpLmlubmVyVGV4dDtcbi8vICAgICAgICAgICAgIC8vIGxldCBwcmljZUV4Y2xWYXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5jVkFUcHJpY2UnKS5pbm5lclRleHQ7XG4vLyAgICAgICAgICAgICAvLyBwcmljZUluY2xWYXRXaXRoUG9pbnQgPSBwcmljZUluY2xWYXQucmVwbGFjZSgvLC9nLCAnLicpO1xuLy8gICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJpY2VJbmNsVmF0V2l0aFBvaW50KTtcblxuXG4vLyAgICAgICAgICAgICAvLyB2YXIgcmVzdWx0Zml4ID0gcmVzdWx0LnJlcGxhY2UoLywvZywgJy4nKTtcbi8vICAgICAgICAgICAgIC8vIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgICAgICAvLyB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuLy8gICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNWQVRwcmljZVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdDtcblxuXG4vLyAgICAgICAgICAgICAvLyB2YXIgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvc2l0ZV9kYXRhID4gZGl2ID4gZGl2LmNvbXBvc2l0ZXByaWNlX3dyYXBwZXIgPiBkaXYuY29tcG9zaXRlX3ByaWNlID4gcCBzcGFuXCIpO1xuLy8gICAgICAgICAgICAgLy8gaWYoaW5wdXQpIHtcbi8vICAgICAgICAgICAgIC8vICAgICB2YXIgcmVzdWx0ID0gaW5wdXQuaW5uZXJUZXh0O1xuLy8gICAgICAgICAgICAgLy8gICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuLy8gICAgICAgICAgICAgLy8gICAgIHZhciByZXN1bHRjYWxjID0gKHJlc3VsdGZpeCAqIDEuMjEpLnRvRml4ZWQoMik7XG4vLyAgICAgICAgICAgICAvLyAgICAgdmFyIGZpbmFsUmVzdWx0ID0gcmVzdWx0Y2FsYy5yZXBsYWNlKCcuJywgJywnKTtcbi8vICAgICAgICAgICAgIC8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuLy8gICAgICAgICAgICAgLy8gfVxuXG5cblxuLy8gICAgIH07XG5cblxuLy8gfSk7XG5cbi8vVGltZWQgb3V0IGZ1bmN0aW9uIGZvciBWQVQgUHJpY2UgZm9yIEFjY2Vzc29pcmVzXG5mdW5jdGlvbiBpbmNWQVR0aW1lKCkge1xuICAgIHNldFRpbWVvdXQoaW5jVkFULCA1MDApO1xufSJdfQ==
