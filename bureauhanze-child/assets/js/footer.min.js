function openPopup(e){document.getElementById(e).classList.toggle("active")}const openFaqContainer=document.querySelectorAll(".info__faq > .faq-item");for(let e=0;e<openFaqContainer.length;e++)openFaqContainer[e].onclick=function(){if(openFaqContainer[e].classList.contains("active"))openFaqContainer[e].classList.remove("active");else{for(let e of openFaqContainer)e.classList.remove("active");openFaqContainer[e].classList.add("active")}};function closePopup(e){document.getElementById(e).classList.remove("active")}function openSpecs(e){document.getElementById(e).classList.toggle("active");var t=document.querySelector("#specsWrap > div.more__specs");"Minder specificaties"===t.innerHTML?t.innerHTML="Meer specificaties":t.innerHTML="Minder specificaties"}function openFilters(e){document.getElementById(e).classList.toggle("active");var t=document.querySelector(".product-category__filters"),o=document.querySelector(".more-btn svg");t.classList.toggle("--active"),o.classList.toggle("svg--active");var n=document.querySelector(".more__specs");"Filters verbergen"===n.innerHTML?n.innerHTML="Filters weergeven":n.innerHTML="Filters verbergen"}function setCookie(e,t,o){var n="";if(o){var c=new Date;c.setTime(c.getTime()+1*o*60*60*1e3),n="; expires="+c.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var c=o[n];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(t))return c.substring(t.length,c.length)}return null}var popupCookie=getCookie("popupCookie");document.getElementById("can-i-help-popup").style.display=popupCookie?"none":"block",document.getElementById("can-i-help--close").onclick=function(){document.getElementById("can-i-help-popup").style.display="none",setCookie("popupCookie","popupCookievalue",7)};const addToCartButton=document.querySelector(".composite_data > div > div.composite_button"),productID=document.querySelector(".composite_data > div > div.composite_button > input[type=hidden]");if(addToCartButton&&addToCartButton.addEventListener("click",(function(){sessionStorage.setItem("productID",productID.value)})),window.sessionStorage.getItem("productID")){const e=document.getElementById("popup-accessoires"),t=document.getElementById("productAddedModalStandard"),o=document.getElementById("productAddedModalAdvanced");e?(o.style.display="block",o.classList.add("fade-in-bottom")):(t.style.display="block",t.classList.add("fade-in-bottom")),sessionStorage.clear()}function closePAM(){const e=document.getElementById("productAddedModalStandard"),t=document.getElementById("productAddedModalAdvanced");e.classList.remove("fade-in-bottom"),e.style.display="none",t.classList.remove("fade-in-bottom"),t.style.display="none",sessionStorage.clear()}const formProjectinrichting=document.querySelector(".wpcf7-form"),formStepBtnNext=document.getElementById("step__button-next"),formStepOne=document.querySelector(".step__one"),formStepTwo=document.querySelector(".step__two"),formSubmit=document.querySelector(".wpcf7-submit");function waitForElm(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const o=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),o.disconnect())}));o.observe(document.body,{childList:!0,subtree:!0})}))}function validateOptons(){performance.getEntriesByType("resource");performance.getEntriesByType("resource").filter((e=>"Rectangle-Copy-14.png"==e.name));var e=document.getElementsByClassName("component_option_thumbnails");const t=document.querySelector("div > div.composite_button > .single_add_to_cart_button");var o=0,n=0;for(let t of e){let e=t.children;o+=1;for(let t of e){let e=t.children;var c=0;for(let t of e)1,t.children[0].classList.contains("selected")&&(c+=1);c&&(n+=1)}}t&&(n===o?(t.style.opacity=1,t.style.pointerEvents="all"):(t.style.opacity=.6,t.style.pointerEvents="none"))}formProjectinrichting&&(formStepBtnNext.addEventListener("click",(function(e){formStepOne.style.display="none",formStepTwo.style.display="block"})),formSubmit.addEventListener("click",(function(e){waitForElm(".invalid").then((e=>{formStepOne.style.display="block",formStepTwo.style.display="block",formStepBtnNext.style.display="none"}))}))),window.addEventListener("load",(function(){document.querySelector("div.component_inner > div.component_selections > div.component_content > .component_summary > .product"),validateOptons();var e=document.getElementsByClassName("component_options_load_more");e[0]&&e[0].addEventListener("click",(()=>{setTimeout((()=>{validateOptons()}),2e3)}));var t=document.getElementsByClassName("product_summary");t[0]&&t[0].addEventListener("click",(()=>{validateOptons()}))})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".sub-menu");for(let o=0;o<e.length;o++){var t=document.createElement("div");t.className="sub-menu__overlay",e[o].appendChild(t)}}),!1);
var timeout,top1=!1,bottom=!1;function descPress(){var e=document.getElementById("description"),t=document.querySelector(".tab_info");(top1=!top1)?(e.classList.add("showDesc"),t.classList.add("rotateArrow")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}function extraPress(){var e=document.getElementById("additional"),t=document.querySelector(".tab_info:nth-child(2)");(bottom=!bottom)?(t.classList.add("rotateArrow"),e.classList.add("showDesc")):(t.classList.remove("rotateArrow"),e.classList.remove("showDesc"))}jQuery(document).ready((function(e){e("form.cart").on("click","button.plus, button.minus",(function(){var t=e(this).closest("form.cart").find(".qty"),o=parseFloat(t.val()),a=parseFloat(t.attr("max")),n=parseFloat(t.attr("min")),s=parseFloat(t.attr("step"));e(this).is(".plus")?a&&a<=o?t.val(a):t.val(o+s):n&&n>=o?t.val(n):o>1&&t.val(o-s)}))})),jQuery((function(e){e(".woocommerce").on("change","input.qty",(function(){void 0!==timeout&&clearTimeout(timeout),timeout=setTimeout((function(){e("[name='update_cart']").trigger("click")}),500)}))}));const voornaam=document.getElementById("billing_first_name"),shipVoornaam=document.getElementById("shipping_first_name"),achternaam=document.getElementById("billing_last_name"),shipAchternaam=document.getElementById("shipping_last_name"),straat=document.getElementById("billing_address_1"),shipStraat=document.getElementById("shipping_address_1"),postcode=document.getElementById("billing_postcode"),shipPostcode=document.getElementById("shipping_postcode"),plaats=document.getElementById("billing_city"),shipPlaats=document.getElementById("shipping_city"),email=document.getElementById("billing_email"),phone=document.getElementById("billing_phone"),line=document.getElementById("tussen1-2"),errorMessage=document.getElementById("formValidation"),diffrentAdress=document.getElementById("ship-to-different-address-checkbox");var progress=12.5;line&&(line.style.width=progress+"%"),allInputs=[voornaam,achternaam,straat,postcode,plaats,email,phone],allInputs.forEach(checkInput);var proceed=!1;function checkInput(e){e&&(e.value&&(progress+=12.5,line.style.width=progress+"%",e.proceed=!0),e.addEventListener("change",(t=>{e.value&&!e.proceed?(progress+=12.5,line.style.width=progress+"%",e.proceed=!0):e.value&&e.proceed||(progress-=12.5,line.style.width=progress+"%",e.proceed=!1)})))}var shipVerder=!1;function nextStepCheckout(){var e=!0;if(shipVerder?shipVoornaam.value&&shipAchternaam.value&&shipStraat.value&&shipPostcode.value&&shipPlaats.value||(e=!1):voornaam.value&&achternaam.value&&straat.value&&postcode.value&&plaats.value&&email.value&&phone.value||(e=!1),e){var t=document.getElementById("checkout_step1"),o=document.getElementById("checkout_step2"),a=document.getElementById("stap1"),n=document.getElementById("stap2");document.getElementById("tussen1-2").style.width="100%",(n||a)&&(n.classList.add("active-class"),a.classList.add("done-class")),window.scrollTo(0,50),t.style.display="none",o.style.display="block",errorMessage.style.display="none"}else errorMessage.style.height="fit-content",errorMessage.style.opacity=1,errorMessage.style.marginBottom="40px",errorMessage.style.padding="5px 25px"}function productModal(e,t,o){var a=document.getElementById("productModal");document.getElementById("productModalInner");document.getElementById("imgWrapper").innerHTML='<a href="'+t+'"><img class="modalProductImage" src="'+o+'"/></a>',document.getElementById("productTitle").innerHTML=e,a.classList.add("modal__cart--active"),pageOverlay.classList.remove("page-overlay"),pageOverlay.classList.add("page-overlay--active")}function closeProductModal(){document.getElementById("productModal").classList.remove("modal__cart--active"),pageOverlay.classList.remove("page-overlay--active"),pageOverlay.classList.add("page-overlay")}function incVAT(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span");if(e){var t=(1.21*e.innerText.replace(/,/g,".")).toFixed(2).replace(".",",");document.getElementById("incVATprice").innerHTML=t}}function watchSelections(){var e=document.querySelectorAll(".variations select, .quantity input");e&&e.forEach((e=>{e.addEventListener("change",(function(){incVAT(),setTimeout(productTotal,600)}))}))}function productTotal(){var e=document.querySelector(".composite_data > div > div.compositeprice_wrapper > div.composite_price > p span"),t=document.querySelector("#productTotals");if(e)var o=e.innerText;t&&(document.querySelector("#productTotals").innerHTML=o)}function incVATtime(){setTimeout(incVAT,500)}diffrentAdress&&diffrentAdress.addEventListener("change",(function(){shipVerder=!shipVerder})),setTimeout((function(){if(document.getElementById("priceWatch")){var e=document.querySelectorAll("select");e&&e.forEach((e=>{e.addEventListener("change",(function(){setTimeout(incVAT,500)}))})),window.addEventListener("click",(function(){setTimeout(incVAT,500)}))}}),600),window.addEventListener("load",(e=>{setTimeout(productTotal,100),setTimeout(incVAT,600);var t=document.querySelectorAll(".radio_button");t&&t.forEach((e=>{e.addEventListener("click",(function(){incVAT(),setTimeout((function(){productTotal(),watchSelections()}),1300)}),{once:!1})}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvb3Rlci5qcyIsIndvb2NvbW1lcmNlLmpzIl0sIm5hbWVzIjpbIm9wZW5Qb3B1cCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIm9wZW5GYXFDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsIm9uY2xpY2siLCJjb250YWlucyIsInJlbW92ZSIsImZhcUNvbnRhaW5lciIsImFkZCIsImNsb3NlUG9wdXAiLCJvcGVuU3BlY3MiLCJidG50ZXh0IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsIm9wZW5GaWx0ZXJzIiwiZmlsdGVyRGl2IiwiZmlsdGVyU1ZHIiwic2V0Q29va2llIiwibmFtZSIsInZhbHVlIiwiZGF5cyIsImV4cGlyZXMiLCJkYXRlIiwiRGF0ZSIsInNldFRpbWUiLCJnZXRUaW1lIiwidG9VVENTdHJpbmciLCJjb29raWUiLCJnZXRDb29raWUiLCJuYW1lRVEiLCJjYSIsInNwbGl0IiwiYyIsImNoYXJBdCIsInN1YnN0cmluZyIsImluZGV4T2YiLCJwb3B1cENvb2tpZSIsInN0eWxlIiwiZGlzcGxheSIsImFkZFRvQ2FydEJ1dHRvbiIsInByb2R1Y3RJRCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXNzaW9uU3RvcmFnZSIsInNldEl0ZW0iLCJ3aW5kb3ciLCJnZXRJdGVtIiwibW9kYWxJZGVudGlmaWVyIiwicHJvZHVjdE1vZGFsU3RhbmRhcmQiLCJwcm9kdWN0TW9kYWxBZHZhbmNlZCIsImNsZWFyIiwiY2xvc2VQQU0iLCJmb3JtUHJvamVjdGlucmljaHRpbmciLCJmb3JtU3RlcEJ0bk5leHQiLCJmb3JtU3RlcE9uZSIsImZvcm1TdGVwVHdvIiwiZm9ybVN1Ym1pdCIsIndhaXRGb3JFbG0iLCJzZWxlY3RvciIsIlByb21pc2UiLCJyZXNvbHZlIiwib2JzZXJ2ZXIiLCJNdXRhdGlvbk9ic2VydmVyIiwibXV0YXRpb25zIiwiZGlzY29ubmVjdCIsIm9ic2VydmUiLCJib2R5IiwiY2hpbGRMaXN0Iiwic3VidHJlZSIsInZhbGlkYXRlT3B0b25zIiwicGVyZm9ybWFuY2UiLCJnZXRFbnRyaWVzQnlUeXBlIiwiZmlsdGVyIiwicmVzb3VyY2UiLCJhYW50YWxTdWJPcHRpZXMiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwib3B0aW9uc0NvdW50IiwiYWFudGFsU2VsZWN0ZWQiLCJzaW5nbGUiLCJzdWJPcHRpZXNDaGlsZHMiLCJjaGlsZHJlbiIsIm9wdGlvbk91dGVyIiwic2luZ2xlT3B0aW9uIiwiYWN0aXZlQ2xhc3MiLCJvcHRpb25MaSIsIm9wYWNpdHkiLCJwb2ludGVyRXZlbnRzIiwiZXZlbnQiLCJ0aGVuIiwiZWxtIiwibG9hZE1vcmVCdXR0b25DIiwic2V0VGltZW91dCIsInByb2R1Y3RTdW1tYXJ5Iiwic3ViTWVudSIsInN1Yk1lbnVEaXYiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiYXBwZW5kQ2hpbGQiLCJ0aW1lb3V0IiwidG9wMSIsImJvdHRvbSIsImRlc2NQcmVzcyIsImRlc2NyaXB0aW9uIiwiYXJyb3ciLCJleHRyYVByZXNzIiwialF1ZXJ5IiwicmVhZHkiLCIkIiwib24iLCJxdHkiLCJ0aGlzIiwiY2xvc2VzdCIsImZpbmQiLCJ2YWwiLCJwYXJzZUZsb2F0IiwibWF4IiwiYXR0ciIsIm1pbiIsInN0ZXAiLCJpcyIsInVuZGVmaW5lZCIsImNsZWFyVGltZW91dCIsInRyaWdnZXIiLCJ2b29ybmFhbSIsInNoaXBWb29ybmFhbSIsImFjaHRlcm5hYW0iLCJzaGlwQWNodGVybmFhbSIsInN0cmFhdCIsInNoaXBTdHJhYXQiLCJwb3N0Y29kZSIsInNoaXBQb3N0Y29kZSIsInBsYWF0cyIsInNoaXBQbGFhdHMiLCJlbWFpbCIsInBob25lIiwibGluZSIsImVycm9yTWVzc2FnZSIsImRpZmZyZW50QWRyZXNzIiwicHJvZ3Jlc3MiLCJ3aWR0aCIsImFsbElucHV0cyIsImZvckVhY2giLCJjaGVja0lucHV0IiwicHJvY2VlZCIsInNoaXBWZXJkZXIiLCJuZXh0U3RlcENoZWNrb3V0IiwidmVyZGVyIiwic3RlcDFfY29udGVudCIsInN0ZXAyX2NvbnRlbnQiLCJhZmdlcm9uZCIsIm1lZUJlemlnIiwic2Nyb2xsVG8iLCJoZWlnaHQiLCJtYXJnaW5Cb3R0b20iLCJwYWRkaW5nIiwicHJvZHVjdE1vZGFsIiwicHJvZHVjdFRpdGxlIiwicHJvZHVjdExpbmsiLCJwcm9kdWN0SW1nVXJsIiwidGhlTW9kYWwiLCJwYWdlT3ZlcmxheSIsImNsb3NlUHJvZHVjdE1vZGFsIiwiaW5jVkFUIiwiaW5wdXQxIiwiZmluYWxSZXN1bHQiLCJpbm5lclRleHQiLCJyZXBsYWNlIiwidG9GaXhlZCIsIndhdGNoU2VsZWN0aW9ucyIsImRyb3Bkb3duU2VsZWN0aW9ucyIsImVsZW1lbnQiLCJwcm9kdWN0VG90YWwiLCJpbnB1dCIsInByb2R1Y3RUb3RhbHMiLCJyZXN1bHQiLCJpbmNWQVR0aW1lIiwicHJvZHVjdFNlbGVjdGlvbnMiLCJzZWxlY3Rpb24iLCJyYWRpb0J1dHRvbnMiLCJidXR0b24iLCJvbmNlIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxVQUFVQyxHQUNQQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVUMsT0FBTyxTQUN2QixDQU1BLE1BQU1DLGlCQUFtQkosU0FBU0ssaUJBQWlCLDBCQUNuRCxJQUFJLElBQUlDLEVBQUksRUFBR0EsRUFBSUYsaUJBQWlCRyxPQUFRRCxJQUN4Q0YsaUJBQWlCRSxHQUFHRSxRQUFVLFdBRTFCLEdBRDZCSixpQkFBaUJFLEdBQUdKLFVBQVVPLFNBQVMsVUFHaEVMLGlCQUFpQkUsR0FBR0osVUFBVVEsT0FBTyxjQUNsQyxDQUNILElBQUssSUFBSUMsS0FBZ0JQLGlCQUNyQk8sRUFBYVQsVUFBVVEsT0FBTyxVQUVsQ04saUJBQWlCRSxHQUFHSixVQUFVVSxJQUFJLFNBQ3RDLENBQ0osRUFPSixTQUFTQyxXQUFXZCxHQUNSQyxTQUFTQyxlQUFlRixHQUM5QkcsVUFBVVEsT0FBTyxTQUN2QixDQUVBLFNBQVNJLFVBQVVmLEdBQ1BD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SSxpQkFBaUIsU0FBUyxXQUM3QndILFNBQ0F2RSxZQUFXLFdBQ1BnRixlQUNBSCxpQkFDSixHQUFHLEtBQ1AsR0FBRyxDQUNDWSxNQUFNLEdBQ1QsR0FFVCIsImZpbGUiOiJmb290ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gb3BlblBvcHVwKGlkKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xufVxuXG5cblxuXG4vLyBvcGVuIC8gY2xvc2UgZmFxIGl0ZW1zXG5jb25zdCBvcGVuRmFxQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5pbmZvX19mYXEgPiAuZmFxLWl0ZW1cIik7XG5mb3IobGV0IGkgPSAwOyBpIDwgb3BlbkZhcUNvbnRhaW5lci5sZW5ndGg7IGkrKyl7XG4gICAgb3BlbkZhcUNvbnRhaW5lcltpXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBmYXFDb250YWluZXJIYXNDbGFzcyA9IG9wZW5GYXFDb250YWluZXJbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpO1xuICAgICAgICBpZihmYXFDb250YWluZXJIYXNDbGFzcykge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2hhcyBjbGFzcycpO1xuICAgICAgICAgICAgb3BlbkZhcUNvbnRhaW5lcltpXS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChsZXQgZmFxQ29udGFpbmVyIG9mIG9wZW5GYXFDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBmYXFDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wZW5GYXFDb250YWluZXJbaV0uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICAgICAgfTtcbiAgICB9O1xufVxuXG5cblxuXG5cbmZ1bmN0aW9uIGNsb3NlUG9wdXAoaWQpIHtcbiAgICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBlLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG59XG5cbmZ1bmN0aW9uIG9wZW5TcGVjcyhpZCkge1xuICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIGUuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiKTtcbiAgICBcbiAgICB2YXIgYnRudGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc3BlY3NXcmFwID4gZGl2Lm1vcmVfX3NwZWNzXCIpO1xuICAgIGlmIChidG50ZXh0LmlubmVySFRNTCA9PT0gXCJNaW5kZXIgc3BlY2lmaWNhdGllc1wiKSB7XG4gICAgICAgIGJ0bnRleHQuaW5uZXJIVE1MID0gJ01lZXIgc3BlY2lmaWNhdGllcyc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnRudGV4dC5pbm5lckhUTUwgPSAnTWluZGVyIHNwZWNpZmljYXRpZXMnO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG9wZW5GaWx0ZXJzKGlkKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xuXG4gICAgdmFyIGZpbHRlckRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZHVjdC1jYXRlZ29yeV9fZmlsdGVyc1wiKTtcbiAgICB2YXIgZmlsdGVyU1ZHID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb3JlLWJ0biBzdmdcIik7XG4gICAgZmlsdGVyRGl2LmNsYXNzTGlzdC50b2dnbGUoXCItLWFjdGl2ZVwiKTtcbiAgICBmaWx0ZXJTVkcuY2xhc3NMaXN0LnRvZ2dsZShcInN2Zy0tYWN0aXZlXCIpO1xuICAgIHZhciBidG50ZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb3JlX19zcGVjc1wiKTtcbiAgICBpZiAoYnRudGV4dC5pbm5lckhUTUwgPT09IFwiRmlsdGVycyB2ZXJiZXJnZW5cIikge1xuICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdGaWx0ZXJzIHdlZXJnZXZlbic7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBidG50ZXh0LmlubmVySFRNTCA9ICdGaWx0ZXJzIHZlcmJlcmdlbic7XG4gICAgfVxufVxuXG5cblxuLy8gZnVuY3Rpb24gb3BlbkZpbHRlcnMoKSB7XG4vLyAgICAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdC1jYXRlZ29yeV9fZmlsdGVyLWNvbnRhaW5lcicpO1xuLy8gICAgIGUuY2xhc3NMaXN0LnRvZ2dsZShcIi0taGlkZVwiKTtcbi8vIH1cblxuXG5cbi8vIFNldCBDb29raWUgZm9yIHBvcHVwXG5mdW5jdGlvbiBzZXRDb29raWUobmFtZSx2YWx1ZSxkYXlzKSB7XG4gICAgdmFyIGV4cGlyZXMgPSBcIlwiO1xuICAgIGlmIChkYXlzKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgKGRheXMqMSo2MCo2MCoxMDAwKSk7XG4gICAgICAgIGV4cGlyZXMgPSBcIjsgZXhwaXJlcz1cIiArIGRhdGUudG9VVENTdHJpbmcoKTtcbiAgICB9XG4gICAgZG9jdW1lbnQuY29va2llID0gbmFtZSArIFwiPVwiICsgKHZhbHVlIHx8IFwiXCIpICArIGV4cGlyZXMgKyBcIjsgcGF0aD0vXCI7XG59XG5cbi8vIFNldCBDb29raWUgZm9yIHBvcHVwXG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xuICAgIHZhciBuYW1lRVEgPSBuYW1lICsgXCI9XCI7XG4gICAgdmFyIGNhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7XG4gICAgZm9yKHZhciBpPTA7aSA8IGNhLmxlbmd0aDtpKyspIHtcbiAgICAgICAgdmFyIGMgPSBjYVtpXTtcbiAgICAgICAgd2hpbGUgKGMuY2hhckF0KDApPT0nICcpIGMgPSBjLnN1YnN0cmluZygxLGMubGVuZ3RoKTtcbiAgICAgICAgaWYgKGMuaW5kZXhPZihuYW1lRVEpID09IDApIHJldHVybiBjLnN1YnN0cmluZyhuYW1lRVEubGVuZ3RoLGMubGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbi8vIEhpZGUgcG9wdXAgaWYgY29va2llIGlzIHNldFxudmFyIHBvcHVwQ29va2llID0gZ2V0Q29va2llKCdwb3B1cENvb2tpZScpO1xuaWYgKHBvcHVwQ29va2llKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbi1pLWhlbHAtcG9wdXAnKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiXG59XG5lbHNlIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuLWktaGVscC1wb3B1cCcpLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiXG59XG5cbi8vIFNldCBDb29raWUgb24gcG9wdXAgY2xvc2VcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW4taS1oZWxwLS1jbG9zZScpLm9uY2xpY2s9ZnVuY3Rpb24oKXtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuLWktaGVscC1wb3B1cCcpLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7XG4gICAgc2V0Q29va2llKCdwb3B1cENvb2tpZScsJ3BvcHVwQ29va2lldmFsdWUnLDcpO1xufTtcblxuXG5cbi8vIFByb2R1Y3QgTW9kYWwgSlNcbmNvbnN0IGFkZFRvQ2FydEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlX2J1dHRvblwiKVxuY29uc3QgcHJvZHVjdElEID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVfYnV0dG9uID4gaW5wdXRbdHlwZT1oaWRkZW5dXCIpXG5cbmlmIChhZGRUb0NhcnRCdXR0b24pIHtcbiAgICBhZGRUb0NhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcInByb2R1Y3RJRFwiLCBwcm9kdWN0SUQudmFsdWUpO1xuICAgIH0pXG59XG5cbmlmICh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgncHJvZHVjdElEJykpIHtcbiAgICBjb25zdCBtb2RhbElkZW50aWZpZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXAtYWNjZXNzb2lyZXMnKTtcbiAgICBjb25zdCBwcm9kdWN0TW9kYWxTdGFuZGFyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0QWRkZWRNb2RhbFN0YW5kYXJkJylcbiAgICBjb25zdCBwcm9kdWN0TW9kYWxBZHZhbmNlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0QWRkZWRNb2RhbEFkdmFuY2VkJylcblxuICAgIGlmICghbW9kYWxJZGVudGlmaWVyKSB7XG4gICAgICAgIHByb2R1Y3RNb2RhbFN0YW5kYXJkLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICAgICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuY2xhc3NMaXN0LmFkZChcImZhZGUtaW4tYm90dG9tXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgcHJvZHVjdE1vZGFsQWR2YW5jZWQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIlxuICAgICAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5jbGFzc0xpc3QuYWRkKFwiZmFkZS1pbi1ib3R0b21cIilcbiAgICB9XG5cbiAgICBzZXNzaW9uU3RvcmFnZS5jbGVhcigpXG59XG5cbmZ1bmN0aW9uIGNsb3NlUEFNKCkge1xuICAgIGNvbnN0IHByb2R1Y3RNb2RhbFN0YW5kYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RBZGRlZE1vZGFsU3RhbmRhcmQnKVxuICAgIGNvbnN0IHByb2R1Y3RNb2RhbEFkdmFuY2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RBZGRlZE1vZGFsQWR2YW5jZWQnKVxuXG4gICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuY2xhc3NMaXN0LnJlbW92ZShcImZhZGUtaW4tYm90dG9tXCIpXG4gICAgcHJvZHVjdE1vZGFsU3RhbmRhcmQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cbiAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5jbGFzc0xpc3QucmVtb3ZlKFwiZmFkZS1pbi1ib3R0b21cIilcbiAgICBwcm9kdWN0TW9kYWxBZHZhbmNlZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcblxuICAgIHNlc3Npb25TdG9yYWdlLmNsZWFyKClcbn1cblxuXG5cblxuLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xuLy8gICAgIC8vIHZhciBwcmljZVN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYWNldHdwLXN1Ym1pdCcpLmlubmVySFRNTDtcbi8vICAgICAvLyBwcmljZVN1Ym1pdEJ0biA9IFwiTXkgbmV3IHRleHQhXCI7XG4vLyAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mYWNldHdwLXN1Ym1pdFwiKS5pbm5lckhUTUwgPSBcIkkgaGF2ZSBjaGFuZ2VkIVwiO1xuLy8gfSk7XG5cblxuXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIChldmVudCkgPT4ge1xuLy8gICAgIHZhciBwcm9kdWN0T3B0aW9uQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJjb21wb25lbnRfb3B0aW9uX3RodW1ibmFpbF90YXBcIik7XG4vLyAgICAgLy8gdmFyIHByb2R1Y3RPcHRpb25CdG5zQXJyYXkgPSBbLi4ucHJvZHVjdE9wdGlvbkJ0bnNdO1xuLy8gICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlcHJpY2Vfd3JhcHBlciA+IGRpdi5jb21wb3NpdGVfcHJpY2UgPiBwIHNwYW5cIik7XG5cblx0XG4vLyBcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBwcm9kdWN0T3B0aW9uQnRucy5sZW5ndGg7ICsraSkge1xuLy8gXHRcdFx0Ly8gcHJvZHVjdE9wdGlvbkJ0bltpXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgeyBcbi8vICAgICAgICAgICAgIHByb2R1Y3RPcHRpb25CdG5zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbi8vICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuLy8gICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBpbnB1dC5pbm5lclRleHQ7XG4vLyAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4vLyAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdGNhbGMgPSAocmVzdWx0Zml4ICogMS4yMSkudG9GaXhlZCgyKTtcbi8vICAgICAgICAgICAgICAgICB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuLy8gICAgICAgICAgICAgICAgIGlmKHJlc3VsdCkge1xuLy8gICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuLy8gICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcm9kdWN0T3B0aW9uQnRuc1tpXSk7XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG5zW2ldKTtcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICB9XG5cbi8vICAgICB9KTtcbiAgICAvLyBmb3IgKGxldCBwcm9kdWN0T3B0aW9uQnRuIG9mIHByb2R1Y3RPcHRpb25CdG5zQXJyYXkpIHtcbiAgICAvLyAgICAgcHJvZHVjdE9wdGlvbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgLy8gICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vICAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0LmlubmVyVGV4dDtcbiAgICAvLyAgICAgICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuICAgIC8vICAgICAgICAgdmFyIHJlc3VsdGNhbGMgPSAocmVzdWx0Zml4ICogMS4yMSkudG9GaXhlZCgyKTtcbiAgICAvLyAgICAgICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4gICAgLy8gICAgICAgICBpZihyZXN1bHQpIHtcbiAgICAvLyAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY1ZBVHByaWNlXCIpLmlubmVySFRNTCA9IGZpbmFsUmVzdWx0O1xuICAgIC8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG4pO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgY29uc29sZS5sb2cocHJvZHVjdE9wdGlvbkJ0bik7XG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZygncHJvZHVjdE9wdGlvbkJ0bicpO1xuICAgIC8vICAgICB9KTtcbiAgXG4gICAgLy8gfVxuICAgIC8vIGNvbnNvbGUubG9nKHByb2R1Y3RPcHRpb25CdG5zQXJyYXkpOyAgXG5cblxuLy8gRm9ybSBwcm9qZWN0aW5yaWNodGluZyBtdWx0aXN0ZXBcbmNvbnN0IGZvcm1Qcm9qZWN0aW5yaWNodGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53cGNmNy1mb3JtJyk7XG5jb25zdCBmb3JtU3RlcEJ0bk5leHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RlcF9fYnV0dG9uLW5leHQnKTtcbmNvbnN0IGZvcm1TdGVwT25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0ZXBfX29uZScpO1xuY29uc3QgZm9ybVN0ZXBUd28gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3RlcF9fdHdvJyk7XG5jb25zdCBmb3JtU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndwY2Y3LXN1Ym1pdCcpO1xuLy8gZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4vLyBvYnNlcnZlciBmb3Igd2FpdGluZyBjbGFzcyB0byBleGlzdFxuZnVuY3Rpb24gd2FpdEZvckVsbShzZWxlY3Rvcikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKG11dGF0aW9ucyA9PiB7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpKTtcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuLy8gc2hvdyAvIGhpZGUgbXVsdGlzdGVwIGZvcm1cbmlmKGZvcm1Qcm9qZWN0aW5yaWNodGluZyl7XG4gICAgZm9ybVN0ZXBCdG5OZXh0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGZvcm1TdGVwT25lLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICB9KTtcbiAgICBcbiAgICBmb3JtU3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cblxuICAgICAgICB3YWl0Rm9yRWxtKCcuaW52YWxpZCcpLnRoZW4oKGVsbSkgPT4ge1xuICAgICAgICAgICAgZm9ybVN0ZXBPbmUuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICAgIGZvcm1TdGVwVHdvLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgICAgICBmb3JtU3RlcEJ0bk5leHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG4gICAgICAgIH0pO1xuXG5cblxuICAgICAgICAvLyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vICAgICBjb25zdCBmb3JtSGFzQ2xhc3NJbnZhbGlkID0gZm9ybVByb2plY3RpbnJpY2h0aW5nLmNsYXNzTGlzdC5jb250YWlucygnaW52YWxpZCcpO1xuICAgICAgICAvLyAgICAgaWYoZm9ybUhhc0NsYXNzSW52YWxpZCkge1xuICAgICAgICAvLyAgICAgICAgIGZvcm1TdGVwT25lLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIC8vICAgICAgICAgZm9ybVN0ZXBUd28uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgLy8gICAgICAgICBmb3JtU3RlcEJ0bk5leHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG4gICAgICAgIC8vICAgICB9O1xuICAgICAgICAvLyB9LCAyNTAwKTtcbiAgICB9KTtcbn07XG5cblxuXG5cbi8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbi8vICAgICAvLyB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmFjZXR3cC1zdWJtaXQnKTtcbi8vICAgICB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyc19fcHJpY2UnKTtcbi8vICAgICB2YXIgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBcbi8vICAgICBlbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLCBlbCk7XG4vLyAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChlbCk7XG4vLyB9LCBmYWxzZSk7XG5cblxuLy8gY29uc3QgY29tcG9uZW50U2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tcG9uZW50X29wdGlvbl90aHVtYm5haWwnKTtcbi8vIGNvbnN0IGNvbXBvbmVudFNlbGVjdGVkQ2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcbi8vIGNvbnN0IGNvbXBvc2l0ZUFkZFRvQ2FydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21wb3NpdGVfYWRkX3RvX2NhcnRfYnV0dG9uJyk7XG4vLyAvLyBjb21wb3NpdGVBZGRUb0NhcnQuc2V0QXR0cmlidXRlKFwicG9pbnRlci1ldmVudHNcIiwgXCJub25lXCIpO1xuLy8gaWYoY29tcG9uZW50U2VsZWN0ZWQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbXBvbmVudFNlbGVjdGVkQ2xhc3MpICkge1xuLy8gICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG5cbi8vIH1cblxuXG5cbi8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCl7XG4gICAgLy8gbGV0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV4dEJ0bicpO1xuICAgIC8vIGxldCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZCdG4nKTtcbiAgICAvLyBsZXQgZWxlbWVudEluZGV4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVsZW1lbnRfaW5kZXgnKTtcbiAgICAvLyBpZihuZXh0QnRuKSB7XG4gICAgLy8gICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgLy8gICAgICAgICB2YXIgY29tcG9zaXRlUGFnaW5hdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbGVtZW50X2luZGV4Jyk7XG4gICAgLy8gICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgY29tcG9zaXRlUGFnaW5hdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbXBvc2l0ZVBhZ2luYXRpb24pO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9KTtcbiAgICAvLyB9XG5cblxuXG4vLyB9KTtcblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuXG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2LmNvbXBvbmVudF9pbm5lciA+IGRpdi5jb21wb25lbnRfc2VsZWN0aW9ucyA+IGRpdi5jb21wb25lbnRfY29udGVudCA+IC5jb21wb25lbnRfc3VtbWFyeSA+IC5wcm9kdWN0XCIpXG5cbiAgICB2YWxpZGF0ZU9wdG9ucygpO1xuICAgIC8vIGxpc3RlbmVyIGZvciBvbmNsaWNrIG9mXG5cbiAgICB2YXIgbG9hZE1vcmVCdXR0b25DID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29tcG9uZW50X29wdGlvbnNfbG9hZF9tb3JlJylcblxuICAgIGlmIChsb2FkTW9yZUJ1dHRvbkNbMF0pIHtcbiAgICAgICAgbG9hZE1vcmVCdXR0b25DWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZU9wdG9ucygpO1xuICAgICAgICAgICAgfSwgMjAwMClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB2YXIgcHJvZHVjdFN1bW1hcnkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcm9kdWN0X3N1bW1hcnknKVxuICAgIGlmIChwcm9kdWN0U3VtbWFyeVswXSkge1xuICAgICAgICBwcm9kdWN0U3VtbWFyeVswXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdmFsaWRhdGVPcHRvbnMoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cblxuXG5cbiAgICAvLyBibHVycnkgYmFja2dyb3VuZCBvbiBtZW51IGhvdmVyXG4gICAgLy8gdmFyIG1lbnVJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtZW51LXdlYnNob3AtMSA+IGxpJyk7XG4gICAgLy8gZm9yKGxldCBpID0gMDsgaSA9IG1lbnVJdGVtcy5sZW5ndGg7IGkrKykge1xuICAgIC8vICAgICBtZW51SXRlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGV2ZW50KSA9PiB7XG5cbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG4gICAgICAgIFxuXG4gICAgLy8gICAgIH0sIGZhbHNlKTtcbiAgICAvLyB9XG5cblxuXG5cbn0pXG5cblxuXG5cblxuLy8gLy8gb3ZlcmxheSBhY3RpdmUgb24gbW91c2UgaG92ZXIgbWVudSBpdGVtc1xuLy8gY29uc3QgbWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUgLm1lbnUtaXRlbScpO1xuLy8gbWVudUl0ZW1zLmZvckVhY2goZiA9PiBmLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBmdW5jdGlvbigpIHtcbi8vICAgICBtZW51SXRlbXMuZm9yRWFjaChlID0+IHtcbi8vICAgICAgICAgY29uc3Qgb3ZlcmxheUFjdGl2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlLW92ZXJsYXknKVxuLy8gICAgICAgICBvdmVybGF5QWN0aXZlLmNsYXNzTGlzdC5hZGQoJ3BhZ2Utb3ZlcmxheS0tYWN0aXZlJyk7XG4vLyAgICAgLy8gY29uc3QgYm9keUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuLy8gICAgIC8vIGJvZHlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCItLW1lbnUtaG92ZXJcIik7XG4vLyAgIH0pXG4vLyB9KSk7XG4vLyBtZW51SXRlbXMuZm9yRWFjaChmID0+IGYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBmdW5jdGlvbigpIHtcbi8vICAgICBtZW51SXRlbXMuZm9yRWFjaChlID0+IHtcbi8vICAgICAvLyBjb25zdCBib2R5RWxlbWVudCA9IGRvY3VtZW50LmJvZHk7XG4vLyAgICAgLy8gYm9keUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIi0tbWVudS1ob3ZlclwiKTtcbi8vICAgICBjb25zdCBvdmVybGF5QWN0aXZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2Utb3ZlcmxheScpXG4vLyAgICAgb3ZlcmxheUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdwYWdlLW92ZXJsYXktLWFjdGl2ZScpO1xuLy8gICB9KVxuLy8gfSkpO1xuXG5cblxuLy8gYXBwZW5kIGNsYXNzIHRvIHN1Yi1tZW51XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN1Yk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3ViLW1lbnUnKVxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzdWJNZW51Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdmFyIHN1Yk1lbnVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIHN1Yk1lbnVEaXYuY2xhc3NOYW1lID0gXCJzdWItbWVudV9fb3ZlcmxheVwiO1xuICAgICAgICBzdWJNZW51W2ldLmFwcGVuZENoaWxkKHN1Yk1lbnVEaXYpXG4gICAgfVxufSwgZmFsc2UpO1xuXG5cbmZ1bmN0aW9uIHZhbGlkYXRlT3B0b25zKCkge1xuXG4gICAgcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcInJlc291cmNlXCIpXG5cbiAgICBjb25zdCByZXNvdXJjZXMgPSBwZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwicmVzb3VyY2VcIik7XG5cbiAgICByZXNvdXJjZXMuZmlsdGVyKHJlc291cmNlID0+IHJlc291cmNlLm5hbWUgPT0gXCJSZWN0YW5nbGUtQ29weS0xNC5wbmdcIilcblxuICAgIHZhciBhYW50YWxTdWJPcHRpZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb21wb25lbnRfb3B0aW9uX3RodW1ibmFpbHMnKTtcblxuXG4gICAgY29uc3QgYWRkVG9DYXJ0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImRpdiA+IGRpdi5jb21wb3NpdGVfYnV0dG9uID4gLnNpbmdsZV9hZGRfdG9fY2FydF9idXR0b25cIilcblxuICAgIHZhciBvcHRpb25zQ291bnQgPSAwO1xuICAgIHZhciBhYW50YWxTZWxlY3RlZCA9IDA7XG5cbiAgICBmb3IgKGxldCBzaW5nbGUgb2YgYWFudGFsU3ViT3B0aWVzKSB7XG4gICAgICAgIGxldCBzdWJPcHRpZXNDaGlsZHMgPSBzaW5nbGUuY2hpbGRyZW47XG5cbiAgICAgICAgb3B0aW9uc0NvdW50ID0gb3B0aW9uc0NvdW50ICsgMTtcblxuICAgICAgICBmb3IgKGxldCBvcHRpb25PdXRlciBvZiBzdWJPcHRpZXNDaGlsZHMpIHtcbiAgICAgICAgICAgIGxldCBzaW5nbGVPcHRpb24gPSBvcHRpb25PdXRlci5jaGlsZHJlbjtcbiAgICAgICAgICAgIHZhciBnbG9iYWxDb3VudCA9IDA7XG4gICAgICAgICAgICB2YXIgYWN0aXZlQ2xhc3MgPSAwO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBvcHRpb25MaSBvZiBzaW5nbGVPcHRpb24pIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxDb3VudCA9IGdsb2JhbENvdW50ICsgMTtcblxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25MaS5jaGlsZHJlblswXS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlQ2xhc3MgPSBhY3RpdmVDbGFzcyArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdGl2ZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgYWFudGFsU2VsZWN0ZWQgPSBhYW50YWxTZWxlY3RlZCArIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBvbmx5IGNoYW5nZSBzdHlsaW5nIG9mIHRoZSBhZGQgdG8gY2FydCBidXR0b24gd2hlbiB0aGVyZSBhcmUgbXVjaCBzZWxlY3RlZCBib3hlcyBhcyByb3dzIG9mIG9wdGlvbnNcbiAgICBpZiAoYWRkVG9DYXJ0QnV0dG9uKSB7XG4gICAgICAgIGlmIChhYW50YWxTZWxlY3RlZCA9PT0gb3B0aW9uc0NvdW50KSB7XG4gICAgICAgICAgICBhZGRUb0NhcnRCdXR0b24uc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICBhZGRUb0NhcnRCdXR0b24uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiYWxsXCJcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFkZFRvQ2FydEJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gLjY7XG4gICAgICAgICAgICBhZGRUb0NhcnRCdXR0b24uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiXG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuXG5cblxuLy8gY29uc3Qgd2Vic2hvcE1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudS13ZWJzaG9wLWNvbnRhaW5lciA+IC5tZW51LWl0ZW0nKVxuLy8gY29uc3QgXG5cbi8vIGZvcihsZXQgaSA9IDA7IGkgPCB3ZWJzaG9wTWVudS5sZW5ndGg7IGkrKykge1xuLy8gICAgIHdlYnNob3BNZW51W2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIGZ1bmN0aW9uKCBldmVudCApIHsgICBcbi8vICAgICAgICAgZXZlbnQudGFyZ2V0LnN0eWxlLmNvbG9yID0gXCJwdXJwbGVcIjtcblxuLy8gICAgICAgfSwgZmFsc2UpO1xuLy8gfVxuXG5cblxuIiwidmFyIHRvcDEgPSBmYWxzZVxudmFyIGJvdHRvbSA9IGZhbHNlXG5cbmZ1bmN0aW9uIGRlc2NQcmVzcygpIHtcbiAgICB2YXIgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKTtcbiAgICB2YXIgYXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYl9pbmZvXCIpO1xuICAgIHRvcDEgPSAhdG9wMVxuXG4gICAgaWYgKHRvcDEpIHtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInNob3dEZXNjXCIpO1xuICAgICAgICBhcnJvdy5jbGFzc0xpc3QuYWRkKFwicm90YXRlQXJyb3dcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXJyb3cuY2xhc3NMaXN0LnJlbW92ZShcInJvdGF0ZUFycm93XCIpO1xuICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd0Rlc2NcIilcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGV4dHJhUHJlc3MoKSB7XG4gICAgdmFyIGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZGl0aW9uYWwnKTtcbiAgICB2YXIgYXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYl9pbmZvOm50aC1jaGlsZCgyKVwiKTtcbiAgICBib3R0b20gPSAhYm90dG9tO1xuXG4gICAgaWYgKGJvdHRvbSkge1xuICAgICAgICBhcnJvdy5jbGFzc0xpc3QuYWRkKFwicm90YXRlQXJyb3dcIik7XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJzaG93RGVzY1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBhcnJvdy5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlQXJyb3dcIik7XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93RGVzY1wiKTtcbiAgICB9XG59XG5cbi8vIE1pbnVzIGFuZCBQbHVzIGJ1dHRvbnMgcXVhbnRpdHlcblxualF1ZXJ5KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigkKXtcblxuICAgICQoJ2Zvcm0uY2FydCcpLm9uKCAnY2xpY2snLCAnYnV0dG9uLnBsdXMsIGJ1dHRvbi5taW51cycsIGZ1bmN0aW9uKCkge1xuXG4gICAgLy8gR2V0IGN1cnJlbnQgcXVhbnRpdHkgdmFsdWVzXG4gICAgdmFyIHF0eSA9ICQoIHRoaXMgKS5jbG9zZXN0KCAnZm9ybS5jYXJ0JyApLmZpbmQoICcucXR5JyApO1xuICAgIHZhciB2YWwgICA9IHBhcnNlRmxvYXQocXR5LnZhbCgpKTtcbiAgICB2YXIgbWF4ID0gcGFyc2VGbG9hdChxdHkuYXR0ciggJ21heCcgKSk7XG4gICAgdmFyIG1pbiA9IHBhcnNlRmxvYXQocXR5LmF0dHIoICdtaW4nICkpO1xuICAgIHZhciBzdGVwID0gcGFyc2VGbG9hdChxdHkuYXR0ciggJ3N0ZXAnICkpO1xuXG4gICAgLy8gQ2hhbmdlIHRoZSB2YWx1ZSBpZiBwbHVzIG9yIG1pbnVzXG4gICAgaWYgKCAkKCB0aGlzICkuaXMoICcucGx1cycgKSApIHtcbiAgICAgICBpZiAoIG1heCAmJiAoIG1heCA8PSB2YWwgKSApIHtcbiAgICAgICAgICBxdHkudmFsKCBtYXggKTtcbiAgICAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgcXR5LnZhbCggdmFsICsgc3RlcCApO1xuICAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICBpZiAoIG1pbiAmJiAoIG1pbiA+PSB2YWwgKSApIHtcbiAgICAgICAgICBxdHkudmFsKCBtaW4gKTtcbiAgICAgICB9XG4gICAgICAgZWxzZSBpZiAoIHZhbCA+IDEgKSB7XG4gICAgICAgICAgcXR5LnZhbCggdmFsIC0gc3RlcCApO1xuICAgICAgIH1cbiAgICB9XG5cbiB9KTtcblxufSk7XG5cblxuLy8gQWpheCBxdWFudGl0eSBhZGRcblxudmFyIHRpbWVvdXQ7XG5cbmpRdWVyeSggZnVuY3Rpb24oICQgKSB7XG5cdCQoJy53b29jb21tZXJjZScpLm9uKCdjaGFuZ2UnLCAnaW5wdXQucXR5JywgZnVuY3Rpb24oKXtcblxuXHRcdGlmICggdGltZW91dCAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KCB0aW1lb3V0ICk7XG5cdFx0fVxuXG5cdFx0dGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQkKFwiW25hbWU9J3VwZGF0ZV9jYXJ0J11cIikudHJpZ2dlcihcImNsaWNrXCIpO1xuXHRcdH0sIDUwMCApOyAvLyAwLjUgc2Vjb25kIGRlbGF5XG5cblx0fSApO1xufSApO1xuXG5cbi8vIGdldHRpbmcgYWxsIGlucHV0IGZpZWxkcyAmIHByb2dyZXNzIGxpbmVcbmNvbnN0IHZvb3JuYWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfZmlyc3RfbmFtZScpXG5jb25zdCBzaGlwVm9vcm5hYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfZmlyc3RfbmFtZScpXG5jb25zdCBhY2h0ZXJuYWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfbGFzdF9uYW1lJylcbmNvbnN0IHNoaXBBY2h0ZXJuYWFtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXBwaW5nX2xhc3RfbmFtZScpXG5jb25zdCBzdHJhYXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19hZGRyZXNzXzEnKVxuY29uc3Qgc2hpcFN0cmFhdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlwcGluZ19hZGRyZXNzXzEnKVxuY29uc3QgcG9zdGNvZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19wb3N0Y29kZScpXG5jb25zdCBzaGlwUG9zdGNvZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpcHBpbmdfcG9zdGNvZGUnKVxuY29uc3QgcGxhYXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JpbGxpbmdfY2l0eScpXG5jb25zdCBzaGlwUGxhYXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXBwaW5nX2NpdHknKVxuY29uc3QgZW1haWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmlsbGluZ19lbWFpbCcpXG5jb25zdCBwaG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWxsaW5nX3Bob25lJylcbmNvbnN0IGxpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHVzc2VuMS0yJyk7XG5jb25zdCBlcnJvck1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybVZhbGlkYXRpb24nKTtcbmNvbnN0IGRpZmZyZW50QWRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaXAtdG8tZGlmZmVyZW50LWFkZHJlc3MtY2hlY2tib3gnKTtcblxuXG5cbnZhciBwcm9ncmVzcyA9IDEyLjU7XG5pZiAobGluZSkge1xuICAgIGxpbmUuc3R5bGUud2lkdGggPSBwcm9ncmVzcyArIFwiJVwiO1xufVxuXG4vLyBwdXR0aW5nIHRoZSBpbnB1dHMgaW4gYW4gYXJyYXlcbmFsbElucHV0cyA9IFt2b29ybmFhbSwgYWNodGVybmFhbSwgc3RyYWF0LCBwb3N0Y29kZSwgcGxhYXRzLCBlbWFpbCwgcGhvbmVdXG5cbmFsbElucHV0cy5mb3JFYWNoKGNoZWNrSW5wdXQpO1xudmFyIHByb2NlZWQgPSBmYWxzZTtcblxuXG5mdW5jdGlvbiBjaGVja0lucHV0KHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZS52YWx1ZSkge1xuICAgICAgICAgICAgcHJvZ3Jlc3MgPSBwcm9ncmVzcyArIDEyLjU7XG4gICAgICAgICAgICBsaW5lLnN0eWxlLndpZHRoID0gcHJvZ3Jlc3MgKyBcIiVcIjtcbiAgICAgICAgICAgIHZhbHVlLnByb2NlZWQgPSB0cnVlO1xuICAgICAgICB9XG5cblxuICAgICAgICB2YWx1ZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZXZlbnQpID0+IHtcblxuICAgICAgICAgICAgaWYgKHZhbHVlLnZhbHVlICYmICF2YWx1ZS5wcm9jZWVkKSB7XG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSBwcm9ncmVzcyArIDEyLjU7XG4gICAgICAgICAgICAgICAgbGluZS5zdHlsZS53aWR0aCA9IHByb2dyZXNzICsgXCIlXCI7XG4gICAgICAgICAgICAgICAgdmFsdWUucHJvY2VlZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYodmFsdWUudmFsdWUgJiYgdmFsdWUucHJvY2VlZCkge1xuICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSBwcm9ncmVzcyAtMTIuNTtcbiAgICAgICAgICAgICAgICBsaW5lLnN0eWxlLndpZHRoID0gcHJvZ3Jlc3MgKyBcIiVcIjtcbiAgICAgICAgICAgICAgICB2YWx1ZS5wcm9jZWVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbnZhciBzaGlwVmVyZGVyID0gZmFsc2U7XG5pZiAoZGlmZnJlbnRBZHJlc3MpIHtcbiAgICBkaWZmcmVudEFkcmVzcy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2hpcFZlcmRlciA9ICFzaGlwVmVyZGVyO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIG5leHRTdGVwQ2hlY2tvdXQoKSB7XG4gICAgdmFyIHZlcmRlciA9IHRydWU7XG4gICAgaWYgKHNoaXBWZXJkZXIpIHtcbiAgICAgICAgaWYgKCFzaGlwVm9vcm5hYW0udmFsdWUgfHwgIXNoaXBBY2h0ZXJuYWFtLnZhbHVlIHx8ICFzaGlwU3RyYWF0LnZhbHVlIHx8ICFzaGlwUG9zdGNvZGUudmFsdWUgfHwgIXNoaXBQbGFhdHMudmFsdWUpIHtcbiAgICAgICAgICAgIHZlcmRlciA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICghdm9vcm5hYW0udmFsdWUgfHwgIWFjaHRlcm5hYW0udmFsdWUgfHwgIXN0cmFhdC52YWx1ZSB8fCAhcG9zdGNvZGUudmFsdWUgfHwgIXBsYWF0cy52YWx1ZSB8fCAhZW1haWwudmFsdWUgfHwgIXBob25lLnZhbHVlKSB7XG4gICAgICAgIHZlcmRlciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmICh2ZXJkZXIpIHtcbiAgICAgICAgdmFyIHN0ZXAxX2NvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNoZWNrb3V0X3N0ZXAxXCIpO1xuICAgICAgICB2YXIgc3RlcDJfY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hlY2tvdXRfc3RlcDJcIik7XG5cbiAgICAgICAgdmFyIGFmZ2Vyb25kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGFwMVwiKTtcbiAgICAgICAgdmFyIG1lZUJlemlnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGFwMlwiKTtcblxuICAgICAgICB2YXIgbGlqbjFfMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHVzc2VuMS0yXCIpO1xuXG4gICAgICAgIGxpam4xXzIuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcbiAgICAgICAgaWYgKG1lZUJlemlnIHx8IGFmZ2Vyb25kKSB7XG4gICAgICAgICAgICBtZWVCZXppZy5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlLWNsYXNzXCIpO1xuICAgICAgICAgICAgYWZnZXJvbmQuY2xhc3NMaXN0LmFkZChcImRvbmUtY2xhc3NcIik7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCA1MCk7XG5cbiAgICAgICAgc3RlcDFfY29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIHN0ZXAyX2NvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUuaGVpZ2h0ID0gXCJmaXQtY29udGVudFwiO1xuICAgICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgIGVycm9yTWVzc2FnZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjQwcHhcIjtcbiAgICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLnBhZGRpbmcgPSBcIjVweCAyNXB4XCI7XG4gICAgfVxufVxuXG5cblxuXG4vLyBPcGVuIHByb2R1Y3QgbW9kYWxcbmZ1bmN0aW9uIHByb2R1Y3RNb2RhbChwcm9kdWN0VGl0bGUsIHByb2R1Y3RMaW5rLCBwcm9kdWN0SW1nVXJsKSB7XG4gICAgLy8gZ2V0cyBpbm5lciBhbmQgb3V0ZXIgbW9kYWxzXG4gICAgdmFyIHRoZU1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9kdWN0TW9kYWxcIik7XG4gICAgdmFyIHRoZU1vZGFsSW5uZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3RNb2RhbElubmVyXCIpO1xuXG4gICAgLy8gY2hhbmdlcyB0aGUgaHRtbCB3aXRoIHRoZSBuZXcgcGFyYW1ldGVyIGRhdGEgaW5zaWRlIG9mIGl0XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltZ1dyYXBwZXInKS5pbm5lckhUTUwgPSAnPGEgaHJlZj1cIicgKyBwcm9kdWN0TGluayArICdcIj48aW1nIGNsYXNzPVwibW9kYWxQcm9kdWN0SW1hZ2VcIiBzcmM9XCInICsgcHJvZHVjdEltZ1VybCArICdcIi8+PC9hPic7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9kdWN0VGl0bGVcIikuaW5uZXJIVE1MID0gcHJvZHVjdFRpdGxlO1xuXG4gICAgLy8gYWRkcyB0aGUgYWN0aXZlIGNsYXNzIHRvIHRoZSBtb2RhbFxuICAgIHRoZU1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsX19jYXJ0LS1hY3RpdmUnKTtcbiAgICAvLyB0aGVNb2RhbElubmVyLmNsYXNzTGlzdC5hZGQoJ3Byb2R1Y3RfbW9kYWwtYW5pbWF0aW9uJyk7XG5cbiAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwicGFnZS1vdmVybGF5XCIpO1xuICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC5hZGQoXCJwYWdlLW92ZXJsYXktLWFjdGl2ZVwiKTtcbn1cblxuLy8gQ2xvc2UgcHJvZHVjdCBtb2RhbFxuZnVuY3Rpb24gY2xvc2VQcm9kdWN0TW9kYWwoKSB7XG4gICAgLy8gZ3JhYnMgbW9kYWwgYnkgdGhlIGlkIGFuZCB0aGVuIHJlbW92ZSB0aGUgYWN0aXZlIGNsYXNzXG4gICAgdmFyIHRoZU1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9kdWN0TW9kYWxcIik7XG4gICAgdGhlTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfX2NhcnQtLWFjdGl2ZScpO1xuXG4gICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShcInBhZ2Utb3ZlcmxheS0tYWN0aXZlXCIpO1xuICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC5hZGQoXCJwYWdlLW92ZXJsYXlcIik7XG59XG5cblxuLy8gQWRkIGluY1ZBVCBwcmljZSB0aGF0IGNoYW5nZXMgd2l0aCB0aGUgY29tcG9zaXRlIHByaWNlXG5cbi8vIEJFR0lOIGxpc3RlbmVycyB0byBwcmljZVxuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHByb2R1Y3RQcmljZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmljZVdhdGNoJylcbiAgICBpZiAocHJvZHVjdFByaWNlKSB7XG4gICAgICAgIHZhciBwcm9kdWN0U2VsZWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpXG4gICAgICAgIGlmIChwcm9kdWN0U2VsZWN0aW9ucykge1xuICAgICAgICAgICAgcHJvZHVjdFNlbGVjdGlvbnMuZm9yRWFjaChzZWxlY3Rpb24gPT4ge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoaW5jVkFULCA1MDApO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoaW5jVkFULCA1MDApO1xuICAgICAgICB9KVxuICAgIH1cbn0sIDYwMCk7XG5cbi8vIFNob3cgaW5jVkFUIHByaWNlIGZvciBwcm9kdWN0XG5mdW5jdGlvbiBpbmNWQVQoKSB7XG4gICAgdmFyIGlucHV0MSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcG9zaXRlX2RhdGEgPiBkaXYgPiBkaXYuY29tcG9zaXRlcHJpY2Vfd3JhcHBlciA+IGRpdi5jb21wb3NpdGVfcHJpY2UgPiBwIHNwYW5cIik7XG5cbiAgICBpZiAoaW5wdXQxKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBpbnB1dDEuaW5uZXJUZXh0O1xuICAgICAgICB2YXIgcmVzdWx0Zml4ID0gcmVzdWx0LnJlcGxhY2UoLywvZywgJy4nKTtcbiAgICAgICAgdmFyIHJlc3VsdGNhbGMgPSAocmVzdWx0Zml4ICogMS4yMSkudG9GaXhlZCgyKTtcbiAgICAgICAgdmFyIGZpbmFsUmVzdWx0ID0gcmVzdWx0Y2FsYy5yZXBsYWNlKCcuJywgJywnKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNWQVRwcmljZVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHdhdGNoU2VsZWN0aW9ucygpIHtcbiAgICB2YXIgZHJvcGRvd25TZWxlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnZhcmlhdGlvbnMgc2VsZWN0LCAucXVhbnRpdHkgaW5wdXQnKVxuICAgIGlmIChkcm9wZG93blNlbGVjdGlvbnMpIHtcbiAgICAgICAgZHJvcGRvd25TZWxlY3Rpb25zLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpbmNWQVQoKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHByb2R1Y3RUb3RhbCwgNjAwKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbi8vIFNob3cgdG90YWwgcHJpY2UgZm9yIGFjY2Vzc29pcmVzXG5mdW5jdGlvbiBwcm9kdWN0VG90YWwoKSB7XG4gICAgdmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVwcmljZV93cmFwcGVyID4gZGl2LmNvbXBvc2l0ZV9wcmljZSA+IHAgc3BhblwiKTtcbiAgICB2YXIgcHJvZHVjdFRvdGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZHVjdFRvdGFsc1wiKTtcbiAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0LmlubmVyVGV4dDtcbiAgICB9XG4gICAgaWYgKHByb2R1Y3RUb3RhbHMpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9kdWN0VG90YWxzXCIpLmlubmVySFRNTCA9IHJlc3VsdDtcbiAgICB9XG59XG5cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoZXZlbnQpID0+IHtcbiAgICBzZXRUaW1lb3V0KHByb2R1Y3RUb3RhbCwgMTAwKTtcbiAgICBzZXRUaW1lb3V0KGluY1ZBVCwgNjAwKTtcblxuICAgIHZhciByYWRpb0J1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmFkaW9fYnV0dG9uJyk7XG5cbiAgICBpZiAocmFkaW9CdXR0b25zKSB7XG4gICAgICAgIHJhZGlvQnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaW5jVkFUKCk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RUb3RhbCgpXG4gICAgICAgICAgICAgICAgICAgIHdhdGNoU2VsZWN0aW9ucygpXG4gICAgICAgICAgICAgICAgfSwgMTMwMClcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBvbmNlOiBmYWxzZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG59KTtcblxuXG4vLyBhZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuLy8gICAgIHZhciBwcmljZU9mZmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53b29jb21tZXJjZS1QcmljZS1hbW91bnRcIik7XG4vLyAgICAgaWYocHJpY2VPZmZlcikge1xuLy8gICAgICAgICB2YXIgcmVzdWx0ID0gcHJpY2VPZmZlci5pbm5lclRleHQ7XG4vLyAgICAgICAgIHZhciByZXN1bHRmaXggPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLicpO1xuLy8gICAgICAgICB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuLy8gICAgICAgICB2YXIgZmluYWxSZXN1bHQgPSByZXN1bHRjYWxjLnJlcGxhY2UoJy4nLCAnLCcpO1xuLy8gICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNhbGUtYW1vdW50X19yZWd1bGFyLXByaWNlIGJkaVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdCArIFwiIFwiO1xuLy8gICAgIH1cbi8vIH0pO1xuXG5cblxuXG4vLyBhZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuLy8gICAgIGxldCBjb21wb25lbnRUaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbXBvbmVudF9vcHRpb25fdGh1bWJuYWlsJyk7XG4vLyAgICAgY29uc29sZS5sb2coJ2xvYWRlZCcpO1xuLy8gICAgIGZvcihsZXQgaSA9IDA7IGkgPCBjb21wb25lbnRUaWxlLmxlbmd0aDsgaSsrKXtcblxuXG4vLyAgICAgICAgIGNvbXBvbmVudFRpbGVbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkJyk7XG4vLyAgICAgICAgIH0pO1xuXG5cblxuLy8gICAgICAgICAgICAgLy8gbGV0IHByaWNlSW5jbFZhdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53b29jb21tZXJjZS1QcmljZS1hbW91bnQnKS5pbm5lclRleHQ7XG4vLyAgICAgICAgICAgICAvLyBsZXQgcHJpY2VFeGNsVmF0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luY1ZBVHByaWNlJykuaW5uZXJUZXh0O1xuLy8gICAgICAgICAgICAgLy8gcHJpY2VJbmNsVmF0V2l0aFBvaW50ID0gcHJpY2VJbmNsVmF0LnJlcGxhY2UoLywvZywgJy4nKTtcbi8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByaWNlSW5jbFZhdFdpdGhQb2ludCk7XG5cblxuLy8gICAgICAgICAgICAgLy8gdmFyIHJlc3VsdGZpeCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcuJyk7XG4vLyAgICAgICAgICAgICAvLyB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuLy8gICAgICAgICAgICAgLy8gdmFyIGZpbmFsUmVzdWx0ID0gcmVzdWx0Y2FsYy5yZXBsYWNlKCcuJywgJywnKTtcbi8vICAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5jVkFUcHJpY2VcIikuaW5uZXJIVE1MID0gZmluYWxSZXN1bHQ7XG5cblxuLy8gICAgICAgICAgICAgLy8gdmFyIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wb3NpdGVfZGF0YSA+IGRpdiA+IGRpdi5jb21wb3NpdGVwcmljZV93cmFwcGVyID4gZGl2LmNvbXBvc2l0ZV9wcmljZSA+IHAgc3BhblwiKTtcbi8vICAgICAgICAgICAgIC8vIGlmKGlucHV0KSB7XG4vLyAgICAgICAgICAgICAvLyAgICAgdmFyIHJlc3VsdCA9IGlucHV0LmlubmVyVGV4dDtcbi8vICAgICAgICAgICAgIC8vICAgICB2YXIgcmVzdWx0Zml4ID0gcmVzdWx0LnJlcGxhY2UoLywvZywgJy4nKTtcbi8vICAgICAgICAgICAgIC8vICAgICB2YXIgcmVzdWx0Y2FsYyA9IChyZXN1bHRmaXggKiAxLjIxKS50b0ZpeGVkKDIpO1xuLy8gICAgICAgICAgICAgLy8gICAgIHZhciBmaW5hbFJlc3VsdCA9IHJlc3VsdGNhbGMucmVwbGFjZSgnLicsICcsJyk7XG4vLyAgICAgICAgICAgICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNWQVRwcmljZVwiKS5pbm5lckhUTUwgPSBmaW5hbFJlc3VsdDtcbi8vICAgICAgICAgICAgIC8vIH1cblxuXG5cbi8vICAgICB9O1xuXG5cbi8vIH0pO1xuXG4vL1RpbWVkIG91dCBmdW5jdGlvbiBmb3IgVkFUIFByaWNlIGZvciBBY2Nlc3NvaXJlc1xuZnVuY3Rpb24gaW5jVkFUdGltZSgpIHtcbiAgICBzZXRUaW1lb3V0KGluY1ZBVCwgNTAwKTtcbn0iXX0=
